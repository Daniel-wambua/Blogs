<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/ctf/glacierctf/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content="GlacierCTF Writeup"><meta property="og:description" content="A series of questions i happened to solve in  this ctf ,enjoy"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2025-11-28T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content="GlacierCTF Writeup"><meta name=twitter:description content="A series of questions i happened to solve in  this ctf ,enjoy"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="ctf,writeups,Glacier"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/ctf/glacierctf/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/ctf/glacierctf/"><meta property="og:title" content="GlacierCTF Writeup"><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-11-28T00:00:00Z"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="article:author" content="Richie-Havoc"><meta property="article:tag" content="ctf"><meta property="article:tag" content="writeups"><meta property="article:tag" content="Glacier"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/ctf/glacierctf/"><meta name=twitter:title content="GlacierCTF Writeup"><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="ctf"><meta name=article:subtitle content="GlacierCTF 2025  its fourth edition, a 24-hour jeopardy CTF organized by LosFuzzys."><meta name=article:summary content="A series of questions i happened to solve in  this ctf ,enjoy"><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content="GlacierCTF Writeup"><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Ctf","item":"https:\/\/havocsec.me\/ctf/"},{"@type":"ListItem","position":3,"name":"GlacierCTF Writeup","item":"https:\/\/havocsec.me\/ctf\/glacierctf\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">GlacierCTF Writeup</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">GlacierCTF 2025 its fourth edition, a 24-hour jeopardy CTF organized by LosFuzzys.</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">Nov 28, 2025 - 10 minute read</div><div class="flex flex-col"><img class="mt-4 h-full w-full object-cover" src=/glacier_hue0bf2833095156db7253dd2c3eef9f75_41855_filter_11492400015018413633.webp alt="feature image" height=355 width=736>
<span class="mb-4 mt-1 text-center text-sm text-slate-700 dark:text-slate-200">GlacierCTF</span></div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><p><img src=webq.png alt></p><h2 id=1-overview>1. Overview</h2><p>The challenge involved a simple PHP-based management board application. The goal was to gain administrative access to retrieve the flag. The core vulnerability was identified as <strong>Insecure Direct Object Reference (IDOR)</strong> combined with a <strong>predictable session ID generation</strong> mechanism, which allowed for trivial session impersonation of the administrator user.</p><h2 id=2-initial-code-analysis>2. Initial Code Analysis</h2><p>The provided source code revealed the application&rsquo;s logic, primarily within <code>index.php</code> and <code>users.json</code>.</p><h3 id=indexphp-analysis><code>index.php</code> Analysis</h3><p>The session management functions were the key area of interest:</p><table><thead><tr><th>Function</th><th>Description</th><th>Vulnerability</th></tr></thead><tbody><tr><td><code>generateSessionID($seed)</code></td><td>Generates the session ID as <code>md5($seed)</code>.</td><td><strong>Predictable:</strong> The seed is the user&rsquo;s index, which is a small, predictable integer.</td></tr><tr><td><code>storeSession($sessionID, $value)</code></td><td>Stores session data in <code>/tmp/$sessionID</code>.</td><td><strong>IDOR Potential:</strong> Session data is stored in a predictable location based on the predictable ID.</td></tr><tr><td><code>handleLogin()</code></td><td>Authenticates the user and, upon success, sets the session ID.</td><td>The <code>$seed</code> passed to <code>generateSessionID</code> is the <code>$idx</code> (index) of the user in the <code>users.json</code> array.</td></tr></tbody></table><p>The flag is displayed only if the logged-in user has the <code>moderator</code> attribute set to <code>true</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// index.php (lines 63-65)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> <span style=color:#66d9ef>if</span>($sessionData<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>moderator</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>true</span>) { <span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>&lt;p&gt;Oh, you are moderator! Here you go: &lt;?= file_get_contents(&#34;/flag.txt&#34;); ?&gt;&lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>&lt;?php } ?&gt;
</span></span></span></code></pre></div><h3 id=usersjson-analysis><code>users.json</code> Analysis</h3><p>The <code>users.json</code> file provided the list of users and their attributes, including the critical <code>moderator</code> flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;username&#34;</span>: <span style=color:#e6db74>&#34;test&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;test&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;moderator&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  }, <span style=color:#75715e>// Index 0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;username&#34;</span>: <span style=color:#e6db74>&#34;alice&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;WpYcHA1li7@*$Z%mp&amp;W#3ZYIYPw1iVkj&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;moderator&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  }, <span style=color:#75715e>// Index 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  { 
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;username&#34;</span>: <span style=color:#e6db74>&#34;admin&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;!UCA3P4*Dg@nam4L!oodQK4@TjmC9cnh&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;moderator&#34;</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  } <span style=color:#75715e>// Index 2 - TARGET
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>]
</span></span></code></pre></div><p>The <strong>admin</strong> user, who possesses the <code>moderator: true</code> attribute, is located at <strong>index 2</strong> in the array.</p><h2 id=3-exploit-strategy>3. Exploit Strategy</h2><p>The vulnerability allows us to calculate the session ID for any user, including the administrator, without needing their password.</p><ol><li><p><strong>Identify Target Index:</strong> The admin user is at index <code>2</code>.</p></li><li><p><strong>Calculate Admin Session ID:</strong> The session ID is <code>md5(index)</code>.</p><ul><li>Admin Session ID = <code>md5("2")</code></li><li><code>md5("2")</code> = <code>c81e728d9d4c2f636f067f89cc14862c</code></li></ul></li><li><p><strong>Impersonate Session:</strong> Set the browser&rsquo;s <code>sess</code> cookie to the calculated admin session ID.</p></li><li><p><strong>Retrieve Flag:</strong> Reload the page, and the application will load the admin&rsquo;s session data, granting access to the flag.</p></li></ol><h2 id=4-execution-and-flag-retrieval>4. Execution and Flag Retrieval</h2><h3 id=step-1-initial-login-verification>Step 1: Initial Login (Verification)</h3><p>A test login with the known credentials (<code>test</code>/<code>test</code>) was performed to observe the session ID generation.</p><ul><li><strong>Login:</strong> <code>username=test</code>, <code>password=test</code></li><li><strong>User Index:</strong> <code>0</code></li><li><strong>Expected Session ID:</strong> <code>md5("0")</code> = <code>cfcd208495d565ef66e7dff9f98764da</code></li><li><strong>Observed Session ID:</strong> <code>cfcd208495d565ef66e7dff9f98764da</code> (Confirmed the mechanism)</li></ul><h3 id=step-2-session-impersonation>Step 2: Session Impersonation</h3><p>The browser&rsquo;s <code>sess</code> cookie was manually set to the pre-calculated admin session ID:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>document.<span style=color:#a6e22e>cookie</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sess=c81e728d9d4c2f636f067f89cc14862c; path=/&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>reload</span>();
</span></span></code></pre></div><h3 id=step-3-flag-retrieval>Step 3: Flag Retrieval</h3><p><img src=web.png alt></p><p>Upon page reload, the application recognized the session as belonging to the administrator, and the flag was displayed on the dashboard.</p><p><strong>Flag:</strong> <code>gctf{1837FA7S_aLwAyS_R4nd0m!z3_Y0uR_C00k!3S!!!_8AJ483H14}</code></p><h2 id=5-remediation>5. Remediation</h2><p>To fix this vulnerability, the session ID generation must be cryptographically secure and unpredictable.</p><ul><li><strong>Use Secure Session Generation:</strong> Replace the predictable <code>md5($idx)</code> with a function that generates a cryptographically secure random string, such as PHP&rsquo;s <code>session_id()</code> or a custom function using <code>random_bytes()</code> and <code>bin2hex()</code>.</li><li><strong>Avoid IDOR:</strong> The session data should not be directly linked to a sequential or easily guessable identifier like the user&rsquo;s array index. The session token should be the only link to the session data, which should be stored securely (e.g., in a database or a secure session store, not in <code>/tmp</code> with a predictable filename).</li><li><strong>Use a Secure Session Handler:</strong> Utilize PHP&rsquo;s built-in session handling mechanisms, which are designed to manage session data securely and prevent such IDOR and session fixation attacks.</li></ul><hr><p><strong>To the next challenge;</strong></p><pre><code>**Noisy Neighbour**
</code></pre><p><img src=noisyn.png alt></p><h2 id=challenge-description>Challenge Description</h2><p>The challenge provided an RSA setup with a twist. The public exponent $e$ was intentionally made very large, seemingly to thwart standard Coppersmith attacks on small exponents. The problem statement hints at this:</p><blockquote><p>&ldquo;I heard Coppersmith attacks small public exponents. I masked mine with a massive random value just to be safe. Bigger is always better, right?&rdquo;</p></blockquote><p>The provided files were <code>chall.py</code> (the source code) and <code>output.txt</code> (the public parameters and ciphertext). The goal was to recover the 128-bit <code>ticket</code> used as the AES key to decrypt the flag.</p><h2 id=analysis-of-challpy>Analysis of <code>chall.py</code></h2><p><em><strong><code>chall.py</code></strong></em></p><pre tabindex=0><code>import random
from Crypto.Util.number import getPrime, long_to_bytes
from Crypto.Cipher import AES

ticket = random.getrandbits(128)
FLAG = &#34;&#34;
with open(&#39;flag.txt&#39;, &#39;r&#39;) as flag:
    FLAG = flag.read()

p = getPrime(1024)
q = getPrime(1024)
N = p * q
phi = (p - 1) * (q - 1)

e = getPrime(16) + (random.getrandbits(128) * phi)
enc_ticket = pow(ticket, e, N)

print(f&#34;{N=}&#34;)
print(f&#34;{e=}&#34;)
print(f&#34;{enc_ticket=}&#34;)

cipher = AES.new(long_to_bytes(ticket), AES.MODE_CTR)
nonce = cipher.nonce
enc_flag = cipher.encrypt(FLAG.encode())

print(f&#34;{enc_flag, nonce=}&#34;)
</code></pre><p><em><strong>output.txt</strong></em></p><pre tabindex=0><code>N=10347242542600406308094534195263088635791365996714020803160250407603636995099715433829129670160192589093770515128152510439089971458386641765448309859819378023880272965050178277879093516918807566027042642100169240017844173793930784667163759562215010481356537422986546632994001754291723194969521748076910835396937977810627980887157551885113202531423733595088875369751631232226097581969479909313254958049277471499732135617616297332871531530596176518111563310557213028740425533103112982126293232786326119238512934754974514742881890899165547139605333761970683944591937361699420431036603767467012489183290578309164784178633
e=3311986667073495779819661492647781665180928338729865042826968893121477288104028672415705332665972755867861711304085148957997662937288947383110908043717598599426017484422084809208910486092822909662298925085867663251659781025068175951771651187222278814345138470007111789992552003468482347964267103806504197977364231330649526292875722283219443425291497285240653190201781346512871589039622122806771109809220085787813190940121150761761463256791250036396820146924876913040030532187290384737376868592733044732294197676117676820815598675412056870600146382869883717018539905436358459822165326225070894181935206514146099686162267119751019096873609300804816456005907
enc_ticket=3946420937017846250393019311609396457338463614723557172414418971956390767261563151514428488890805225021688212721862533753952638354812535035364278722859438604041154655180097577414599710778354857775161040850623041785446044819204867397065653667589062151439260152909905577160138599029484856249429267771263679704326352858922042179435551285375575126876142413991900659195467217772357193174598528534725223102658732326697336473387891654610296170800740197748092566321210843941286260968460061251471684295914144882122101706465054524774059725005866235986370176677629767819073609117398726398647883974883695216900279944685266429904
enc_flag, nonce=(b&#39;`\x8d\x9e\x1e\xd4!\xf5\xe3\xf8,\xfb\x16UV\xcc\xae\xe6G\x91F\x06\x157)\x99|;\xb0\xf5\x87\xa2R\xa8\xd4H\xd16\xa6\xd6\xd1r\xe7 C\xd6i\x83\xb9\xf9\xf7f=\xab\x16&#39;, b&#39;\xf1\xdbF)\x91\xc5\xb4$&#39;)
</code></pre><p>The source code reveals the construction of the RSA parameters:</p><ol><li><strong>Modulus $N$</strong>: $N = p \cdot q$, where $p$ and $q$ are 1024-bit primes, making $N$ a 2048-bit modulus.</li><li><strong>Euler&rsquo;s Totient $\phi(N)$</strong>: $\phi = (p-1)(q-1)$.</li><li><strong>Public Exponent $e$</strong>:
$$e = \text{getPrime}(16) + (\text{random.getrandbits}(128) \cdot \phi)$$
This is the core vulnerability. The exponent $e$ is constructed as:
$$e = e*{\text{small}} + R \cdot \phi$$
where $e*{\text{small}}$ is a small 16-bit prime, and $R$ is a 128-bit random integer.</li><li><strong>Encryption</strong>: The 128-bit <code>ticket</code> is encrypted using standard RSA:
$$\text{enc_ticket} = \text{ticket}^e \pmod{N}$$</li><li><strong>Flag Encryption</strong>: The <code>ticket</code> is used as the AES key (after converting to bytes) to encrypt the flag using AES in CTR mode.</li></ol><h2 id=cryptographic-vulnerability-noisy-rsa>Cryptographic Vulnerability: Noisy RSA</h2><p>The construction of $e$ is a classic example of <strong>Noisy RSA</strong> or a variation of the <strong>Coppersmith attack on small $\phi(N)$ error</strong>.</p><p>The relationship between $N$ and $\phi$ is:
$$\phi = N - (p+q) + 1$$
Since $p$ and $q$ are 1024-bit primes, $p+q$ is approximately $2 \cdot 2^{1023} \approx 2^{1024}$, which is a value much smaller than $N$ (2048 bits). This means $\phi$ is very close to $N$.</p><p>Substituting $\phi$ into the equation for $e$:
$$e = e*{\text{small}} + R \cdot (N - (p+q) + 1)$$
$$e = R \cdot N + (e*{\text{small}} + R - R \cdot (p+q))$$</p><p>Let $K = e - R \cdot N$. Since $e$ and $N$ are known, and $R$ is a small integer, $K$ is a known value.
$$K = e_{\text{small}} + R - R \cdot (p+q)$$</p><p>The values are:</p><ul><li>$N \approx 2^{2048}$</li><li>$e \approx 2^{2048}$</li><li>$R \approx 2^{128}$ (but since $e$ and $N$ are the same bit length, $R$ must be a very small integer, as $e$ is only slightly larger than $R \cdot \phi \approx R \cdot N$).</li><li>$e_{\text{small}} &lt; 2^{16}$</li><li>$p+q \approx 2^{1024}$</li></ul><p>The key insight is that $R$ must be a small integer. We can approximate $R$ by calculating the integer division of $e$ by $N$:
$$R \approx \lfloor e / N \rfloor$$</p><p>From the provided <code>output.txt</code>:</p><ul><li>$N \approx 1.0347 \times 10^{616}$</li><li>$e \approx 3.3119 \times 10^{616}$</li><li>$R_{\text{approx}} = \lfloor e / N \rfloor = 3$</li></ul><p>With $R=3$, we can rearrange the equation for $K$ to solve for $S = p+q$:
$$R \cdot (p+q) = e*{\text{small}} + R - K$$
$$p+q = S = \frac{e*{\text{small}} + R - K}{R}$$</p><p>Since $S$ must be an integer, $e*{\text{small}} + R - K$ must be divisible by $R$. We can iterate over all possible small prime values for $e*{\text{small}}$ (up to $2^{16}$) and check this divisibility condition.</p><h2 id=factoring-n-and-decryption>Factoring $N$ and Decryption</h2><p>Once we find the correct $e_{\text{small}}$ and thus $S = p+q$, we can factor $N$ using the property that $p$ and $q$ are the roots of the quadratic equation:
$$x^2 - S \cdot x + N = 0$$</p><p>The roots are given by the quadratic formula:
$$p, q = \frac{S \pm \sqrt{S^2 - 4N}}{2}$$</p><p>The steps to solve the challenge are:</p><ol><li><strong>Determine $R$</strong>: Calculate $R_{\text{approx}} = \lfloor e / N \rfloor$. We found $R=3$.</li><li><strong>Iterate for $e_{\text{small}}$</strong>: Iterate through all primes $e_{\text{small}} \in [2, 2^{16}]$.</li><li><strong>Check Divisibility</strong>: For each $e*{\text{small}}$, check if $(e*{\text{small}} + R - K)$ is divisible by $R$.</li><li><strong>Calculate $S$</strong>: If divisible, calculate $S = p+q$.</li><li><strong>Check Discriminant</strong>: Check if the discriminant $\Delta = S^2 - 4N$ is a perfect square.</li><li><strong>Factor $N$</strong>: If $\Delta$ is a perfect square, calculate $p$ and $q$.</li><li><strong>Decrypt</strong>: Calculate $\phi = (p-1)(q-1)$, the private exponent $d = e^{-1} \pmod{\phi}$, and the <code>ticket</code> by decrypting $\text{enc_ticket}$.</li><li><strong>Recover Flag</strong>: Use the <code>ticket</code> as the AES key to decrypt the flag ciphertext.</li></ol><p>The Python solver script implemented this logic:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># ... (imports and public parameters)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>solve</span>():
</span></span><span style=display:flex><span>    <span style=color:#75715e># R is the integer part of e / N.</span>
</span></span><span style=display:flex><span>    R_approx <span style=color:#f92672>=</span> e <span style=color:#f92672>//</span> N
</span></span><span style=display:flex><span>    R_candidates <span style=color:#f92672>=</span> [R_approx <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, R_approx, R_approx <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> R <span style=color:#f92672>in</span> R_candidates:
</span></span><span style=display:flex><span>        K <span style=color:#f92672>=</span> e <span style=color:#f92672>-</span> R <span style=color:#f92672>*</span> N
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> e_small_candidate <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span><span style=color:#f92672>**</span><span style=color:#ae81ff>16</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> is_prime(e_small_candidate):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (e_small_candidate <span style=color:#f92672>-</span> K) <span style=color:#f92672>%</span> R <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>                    S <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> (e_small_candidate <span style=color:#f92672>-</span> K) <span style=color:#f92672>//</span> R
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                    Delta <span style=color:#f92672>=</span> S<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> N
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> Delta <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> is_square(Delta):
</span></span><span style=display:flex><span>                        sqrt_Delta <span style=color:#f92672>=</span> math<span style=color:#f92672>.</span>isqrt(Delta)
</span></span><span style=display:flex><span>                        p <span style=color:#f92672>=</span> (S <span style=color:#f92672>+</span> sqrt_Delta) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>                        q <span style=color:#f92672>=</span> (S <span style=color:#f92672>-</span> sqrt_Delta) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>                        
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> p <span style=color:#f92672>*</span> q <span style=color:#f92672>==</span> N:
</span></span><span style=display:flex><span>                            <span style=color:#75715e># Found the factors!</span>
</span></span><span style=display:flex><span>                            phi <span style=color:#f92672>=</span> (p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (q <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                            d <span style=color:#f92672>=</span> inverse(e, phi)
</span></span><span style=display:flex><span>                            ticket <span style=color:#f92672>=</span> pow(enc_ticket, d, N)
</span></span><span style=display:flex><span>                            
</span></span><span style=display:flex><span>                            <span style=color:#75715e># Decrypt the flag</span>
</span></span><span style=display:flex><span>                            key <span style=color:#f92672>=</span> long_to_bytes(ticket)
</span></span><span style=display:flex><span>                            cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(key, AES<span style=color:#f92672>.</span>MODE_CTR, nonce<span style=color:#f92672>=</span>nonce)
</span></span><span style=display:flex><span>                            dec_flag <span style=color:#f92672>=</span> cipher<span style=color:#f92672>.</span>decrypt(enc_flag)
</span></span><span style=display:flex><span>                            
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>return</span> dec_flag<span style=color:#f92672>.</span>decode()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;Attack failed.&#34;</span>
</span></span></code></pre></div><h2 id=flag>Flag</h2><p>Executing the solver script successfully recovered the flag:</p><p><strong>gctf{c0pp3rsm17h_ste4ling_y0ur_sm4ll_r00ts_2025-2079}</strong></p><p><strong>THE NEXT CHALLENGE;</strong></p><h2 id=gitresethard>gitresethard</h2><p><img src=gitreset.png alt></p><p><strong>Overview</strong></p><p>The challenge simulates a scenario where a developer (“Kevin”) nukes a repository using:</p><blockquote><p>git reset &ndash;hard</p><p>git push &ndash;force</p></blockquote><p>The working tree is gone, the commits are “lost,” and you’re given only a compressed disk image containing a bare .git directory.</p><p>Your job is to recover the “lost” commit, extract the malicious file hidden inside it, and decrypt the final flag.</p><p>The challenge is about understanding:</p><blockquote><p>Git object storage</p><p>Dangling commits</p><p>Using git fsck to recover unreachable data</p><p>Extracting file versions directly from Git objects</p></blockquote><p><em><strong>Basic AES decryption</strong></em></p><p><strong>Step 1 — Understanding the Provided Files</strong></p><p>After unpacking the challenge bundle, you end up with:</p><blockquote><p>repo/ # This is actually the .git directory</p><p>repo.tar.gz # Archive containing the same repo directory</p></blockquote><p>Important: repo/ is not a full project. It is the .git folder itself.</p><p>There is no working tree, and Git will not operate normally unless you specify one.</p><p><strong>Step 2 — Creating a Work-Tree</strong></p><p>Git requires a working directory even if all you have is .git.</p><p>So you create one:</p><blockquote><p>mkdir -p ~/Downloads/ctf/glacier/work</p></blockquote><p><strong>Step 3 — Running git fsck to Recover Lost Commits</strong></p><p>Because the repo was hard-reset and force-pushed, the commit you want is now unreachable.</p><p>We point Git to the correct locations:</p><blockquote><p>GITDIR=$HOME/Downloads/ctf/glacier/gitresethard/repo</p><p>WORK=$HOME/Downloads/ctf/glacier/work</p></blockquote><p>Then run:</p><blockquote><p>git &ndash;git-dir="$GITDIR" &ndash;work-tree="$WORK" fsck &ndash;no-reflogs &ndash;lost-found</p></blockquote><p>Git scans all objects in the object database and prints out anything that’s valid but not referenced.</p><p>You get:</p><blockquote><p>dangling commit 6a81c76ebba614823433d7caf0ea7e523a998fcb</p></blockquote><p>This unreachable commit is the challenge’s core.</p><p><img src=git.png alt></p><p><strong>Step 4 — Inspecting the Dangling Commit</strong></p><p>Show it:</p><p><strong>git &ndash;git-dir="$GITDIR" &ndash;work-tree="$WORK" show 6a81c76eb&mldr;</strong></p><p>You see that the commit modifies:</p><blockquote><p>carpet/shit</p></blockquote><p>This is the file you need to extract.</p><p><img src=gitshow2.png alt></p><p><strong>Step 5 — Extracting the File From the Commit</strong></p><p>Directly pull the blob from the Git object:</p><blockquote><p>git &ndash;git-dir="$GITDIR" &ndash;work-tree="$WORK" \</p><p>\ show 6a81c76eb&mldr;:carpet/shit \</p><p>> &ldquo;$WORK/shit.sh&rdquo;</p></blockquote><p>When you view the file:</p><blockquote><p>cat $WORK/shit.sh</p></blockquote><p>you find:</p><p>A large base64-encoded blob</p><p>An AES-256-CBC decrypt command</p><p>A passphrase hardcoded inside the script</p><p>Example (simplified):</p><blockquote><p>echo &ldquo;U2FsdGVkX1&mldr;&rdquo; | base64 -d | openssl enc -d -aes-256-cbc -pbkdf2 -pass pass:tJnAQZQF2bKx4</p></blockquote><p><img src=base64.png alt></p><blockquote><p><img src alt=GlacierCTF></p></blockquote><p><strong>Step 6 — Decrypting the Embedded Payload</strong></p><p>Copy the base64 payload and the password, then run:</p><blockquote><p>echo &ldquo;<base64>&rdquo; | base64 -d \</p><p>| openssl enc -d -aes-256-cbc -pbkdf2 -pass pass:<password></p></blockquote><p>This reveals the final flag.In this challenge:</p><p><img src=gitflag.png alt></p><p><strong>gctf{0113_wh0_g1t_r3s3t3d_th3_c4t_4789</strong></p><h1 id=lessons-learned><strong>Lessons Learned</strong></h1><h3 id=1-git-reset--force-push-doesnt-erase-history><strong>1. Git reset + force push doesn’t erase history</strong></h3><p>If you have the <code>.git</code> directory, you can recover far more than people think.</p><h3 id=2-the-working-tree-is-irrelevant><strong>2. The working tree is irrelevant</strong></h3><p>Git’s real data lives in:</p><blockquote></blockquote><h3 id=3-fsck-is-your-best-friend-for-forensics><strong>3. <code>fsck</code> is your best friend for forensics</strong></h3><p>It lists unreachable:</p><blockquote><ul><li>commits</li><li>blobs</li><li>trees</li></ul></blockquote><h3 id=4-git-is-a-forensic-goldmine><strong>4. Git is a forensic goldmine</strong></h3><p>Unless objects have been <strong>GC’d (<code>git gc</code>),</strong> recovery is trivial.</p><h1 id=final-thoughts><strong>Final Thoughts</strong></h1><p>This challenge was straight-forward but exposes a huge blind spot developers have:</p><p>***They think Git “deletes” things. It doesn’t.</p><p>It leaves a trail for anyone competent to follow.***</p><p><strong>The next challenge;</strong></p><p><img src=r5ev.png alt></p><h2 id=1-overview-1><strong>1. Overview</strong></h2><p>This was the introductory reversing challenge.</p><p>The binary didn’t hide behind obfuscation, packing, or VM tricks — it simply embedded the flag in a lightly transformed way.</p><p>The goal:</p><p><strong>Figure out how the program validates input and extract the flag logic directly.</strong>
<strong>here we go buddies;</strong></p><p><strong>2. Initial Recon</strong></p><p>Running <code>file</code> on the binary showed it was a standard ELF:</p><blockquote><p>ELF 64-bit LSB executable, x86-64</p></blockquote><p>Running <code>strings</code> immediately exposed suspicious fragments: but nothing important</p><p>so we go to <strong>binaryninja</strong> and dissasemple the binary</p><p>to the main we got this</p><p><img src=rev1.png alt></p><blockquote><p>by keeping in mind what main gave us we are in the clear. on the</p><p><strong>char*var_508</strong></p><p>we got it</p></blockquote><p><img src=revanswer.png alt></p><p>the flag is</p><pre tabindex=0><code>gctf{bd88c4d4_w3lc0m3_t0_r3v_574dc8aa}
</code></pre><p>so year we got this easy peasy</p><hr><p>happy hacking!!!!</p></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>