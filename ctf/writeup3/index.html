<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/ctf/writeup3/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content="CYBERGAME-2025 {FORENSIC-CHALLENGES}"><meta property="og:description" content=" Kenyan version organized by: Ministry of Information,Communications and the Digital Economy* "><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2025-06-10T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content="CYBERGAME-2025 {FORENSIC-CHALLENGES}"><meta name=twitter:description content=" Kenyan version organized by: Ministry of Information,Communications and the Digital Economy* "><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="hacking articles,hacking articles blog,hacking articles tutorials,hacking articles writeups,ethical hacking articles,cybersecurity articles,security hacking articles,penetration testing articles,infosec articles,cyber security hacking articles,cybersecurity,ethical hacking,CTF writeups,penetration testing,security research,bug bounty,offensive security,infosec,hackthebox,web exploitation,havoc,Richie havoc,htb,learn ethical hacking,hacking tutorials for beginners,cybersecurity tutorials,how to hack ethically,penetration testing course,security researcher blog,hacking step by step guide,ethical hacking examples,real world hacking scenarios,practical hacking exercises,Hercules,Soulmate,Darkcorp,Darkzero,Writeup,Bugbounty,htb writeups,hackthebox walkthrough,hackthebox solutions,penetration testing tutorials,linux privilege escalation,windows privilege escalation,active directory hacking,OSCP preparation,cyber security blog,vulnerability research,exploit development,reverse engineering,binary exploitation,pwn challenges,web security,network security,cryptography challenges,tryhackme,offsec labs,BoardLight HTB,Instant HTB,Sea HTB,Cicada HTB,Intuition HTB,Sightless HTB,Editorial HTB,Runner HTB,Greenhorn HTB,Blazorized HTB,Surveillance HTB,Headless HTB,Crafty HTB,Bizness HTB,Mist HTB,Usage HTB,Perfection HTB,Builder HTB,WifineticTwo HTB,Cap HTB,Analysis HTB,Keeper HTB,ctf challenges,capture the flag,cyber defense,red team operations,blue team defense,malware analysis,forensics challenges,steganography,OSINT techniques,kali linux tutorials,metasploit framework,burp suite tutorials,nmap scanning,sql injection,xss exploitation,privilege escalation techniques,buffer overflow,rop chain,shellcode development,reverse shell,web shell,docker security,kubernetes pentesting,cloud security,aws security,azure pentesting,api security testing,jwt exploitation,owasp top 10,security certifications,CEH preparation,OSWE preparation,OSCE preparation,NanoCorp HTB,NanoCorp walkthrough,NanoCorp writeup,NanoCorp HTB writeup,HTB NanoCorp exploitation,HTB NanoCorp solution,HackTheBox NanoCorp,NTLM relay attacks,NTLM relay exploitation,responder NTLM relay,ntlmrelayx tutorial,windows active directory exploitation,windows privilege escalation techniques,windows enumeration techniques,SMB relay attacks,credential discovery techniques,hard difficulty HTB machines,advanced windows hacking,active directory pentesting guide,windows security assessment,windows post exploitation,domain controller exploitation,kerberos attacks,pass the hash,lateral movement techniques,bloodhound enumeration,impacket tools,windows pentesting,HTB hard machines 2025,HTB season 9 machines,advanced AD attacks,HTB NanoCorp writeup,HTB NanoCorp Machine writeup,nanocorp.htb,CVE-2025-24071,HTB NanoCorp exploitation,DCOM exploitation,Windows DCOM attacks,DACL Abuse,best hacking articles website,top cybersecurity writeup blogs,where to find CTF writeups,detailed penetration testing tutorials,comprehensive hacking guides,step by step hacking tutorials,beginner to advanced ethical hacking,free hacking learning resources,cybersecurity blog 2025,latest hacking techniques,modern exploitation methods,practical security research,how to solve CTF challenges,how to hack hackthebox machines,privilege escalation methods explained,web application security testing,how to find vulnerabilities,penetration testing methodology,OSCP exam preparation tips,HTB machine walkthrough,CTF challenge solutions,security assessment guide,metasploit tutorials,burp suite guides,nmap cheat sheet,gobuster usage,hydra brute force,sqlmap injection,netcat reverse shell,wireshark packet analysis,john the ripper tutorial,hashcat cracking guide,OSCP certification preparation,CEH study materials,bug bounty hunter tips,cybersecurity career guide,penetration tester roadmap,ethical hacker certification,security researcher career path,infosec job preparation,2025 hacking tutorials,latest CVE exploits,zero day vulnerabilities,current cybersecurity threats,modern web exploitation,cloud security testing,API security vulnerabilities,container security hacking,AI security research,machine learning vulnerabilities,alternative to ippsec,similar to hackingarticles,best ctf writeup sites,top penetration testing blogs,ethical hacking resources,cybersecurity learning platforms,hacking practice labs,hacking community,infosec community blog,cybersecurity forum,ethical hacking discord,CTF community,bug bounty community,security researchers network"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/ctf/writeup3/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/ctf/writeup3/"><meta property="og:title" content="CYBERGAME-2025 {FORENSIC-CHALLENGES}"><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-06-10T00:00:00Z"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="article:author" content="Richie-Havoc"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/ctf/writeup3/"><meta name=twitter:title content="CYBERGAME-2025 {FORENSIC-CHALLENGES}"><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="ctf"><meta name=article:subtitle content="⚡ Forensics challenges were cool.... read through and feel it⚡"><meta name=article:summary content="* Kenyan version organized by: Ministry of Information,Communications and the Digital Economy*"><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content="CYBERGAME-2025 {FORENSIC-CHALLENGES}"><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Ctf","item":"https:\/\/havocsec.me\/ctf/"},{"@type":"ListItem","position":3,"name":"CYBERGAME-2025 {FORENSIC-CHALLENGES}","item":"https:\/\/havocsec.me\/ctf\/writeup3\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">CYBERGAME-2025 {FORENSIC-CHALLENGES}</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">⚡ Forensics challenges were cool.... read through and feel it⚡</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">Jun 10, 2025 - 12 minute read</div><div class="flex flex-col"><img class="mt-4 h-full w-full object-cover" src=/cybergame_huafc7507f212e0984589b262f3614c387_367116_filter_11492400015018413633.webp alt="feature image" height=340 width=736>
<span class="mb-4 mt-1 text-center text-sm text-slate-700 dark:text-slate-200">cybergame</span></div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><h2 id=1-introduction>1. Introduction</h2><p>Welcome to this comprehensive writeup for the Bastion CTF challenge series! This series of challenges focuses on server security, forensic analysis, and identifying backdoors in a compromised system. Throughout these challenges, we&rsquo;ll explore various aspects of security, from inspecting docker layers to analyzing git repositories for malicious code.</p><p>The Bastion series consists of four progressive challenges:</p><ol><li><strong>Bastion - So much just from logs</strong>: inspect the logs to find the flag</li><li><strong>Bastion - Inspect the file system</strong>: Examining a docker layer for hidden flags</li><li><strong>Bastion - Clean bastion</strong>: Accessing a bastion host via SSH and identifying potential issues</li><li><strong>Bastion - Feel free to dig in</strong>: Conducting a deeper forensic investigation for attacker traces</li><li><strong>Bastion - The backdoor culprit</strong>: Analyzing a git repository to find the source of a backdoor</li></ol><p>. Let&rsquo;s dive in and solve them step by step!</p><h3 id=tools-used>Tools Used</h3><ul><li>Linux command line utilities (tar, grep, find, etc.)</li><li>SSH client</li><li>Git</li><li>Base64 encoding/decoding</li></ul><h3 id=challenge-1-bastion---so-much-just-from-logs><strong>Challenge 1: Bastion - So much just from logs</strong></h3><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup3/images/bastion%20so%20much%20from%20logs.png?raw=true" alt=bastion></p><p><strong>Solution:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>gzip -d *.gz
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat auth.log* | grep -v -e <span style=color:#e6db74>&#39;Connection closed by invalid user&#39;</span> -e <span style=color:#e6db74>&#39;Failed password for invalid user&#39;</span> -e <span style=color:#e6db74>&#39;Failed none for invalid user&#39;</span> -e <span style=color:#e6db74>&#39;Invalid user &#39;</span> -e <span style=color:#e6db74>&#39;Could not get shadow information&#39;</span> -e <span style=color:#e6db74>&#39;not allowed because account is locked&#39;</span> -e <span style=color:#e6db74>&#39;Connection closed by authenticating user&#39;</span> -e <span style=color:#e6db74>&#39;Failed password for &#39;</span> | r.csd b64 | r.csd hex
</span></span></code></pre></div><p>This will reveal the flag: <code>SK-CERT{n3v3r_f0r637_4b0u7_d47_p3r51573nc3}</code></p><h2 id=2-challenge-2-bastion---inspect-the-file-system>2. Challenge 2: Bastion - Inspect the file system</h2><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup3/images/inspect%20the%20file%20system.png?raw=true" alt=bastion></p><p>For this challenge, we are provided with a docker layer archive file named <code>part2_docker_layer.tar.gz</code>. Our task is to inspect this file system and find any hidden flags.</p><h3 id=methodology>Methodology</h3><ol><li>Extract the docker layer archive</li><li>Inspect the extracted filesystem</li><li>Search for the flag in the expected format (SK-CERT{})</li></ol><h3 id=step-by-step-solution>Step-by-Step Solution</h3><h4 id=step-1-extract-the-docker-layer-archive>Step 1: Extract the Docker Layer Archive</h4><p>First, we need to create a directory for our work and extract the archive:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p /home/ubuntu/ctf_challenge
</span></span><span style=display:flex><span>tar -xzf <span style=color:#e6db74>&#34;part2_docker_layer.tar.gz&#34;</span> -C /home/ubuntu/ctf_challenge
</span></span></code></pre></div><h4 id=step-2-inspect-the-extracted-filesystem>Step 2: Inspect the Extracted Filesystem</h4><p>Let&rsquo;s list the contents of the extracted directory to get an overview of the filesystem:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ls -R /home/ubuntu/ctf_challenge
</span></span></code></pre></div><p>This command reveals a complex directory structure with many files and subdirectories. To navigate this efficiently, we need to focus our search.</p><h4 id=step-3-search-for-the-flag>Step 3: Search for the Flag</h4><p>Since we know the flag format is SK-CERT{}, we can use grep to search for it across all files:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>grep -a -r <span style=color:#e6db74>&#34;SK-CERT{&#34;</span> /home/ubuntu/ctf_challenge/
</span></span></code></pre></div><p>The <code>-a</code> flag treats binary files as text, and <code>-r</code> performs a recursive search.</p><p>This search returns two potential flags:</p><pre tabindex=0><code>/home/ubuntu/ctf_challenge/19d1ccfb743d216f8186a3e0273a24132bb7c4c8813d741108c14722a85732fe/merged/tmp/persistence:[Fri Apr 18 16:15:22 UTC 2025] i hope they wont find me, and this flag (SK-CERT{n3v3r_f0r637_4b0u7_d47_p3r51573nc3}) keeps on beaconing
/home/ubuntu/ctf_challenge/19d1ccfb743d216f8186a3e0273a24132bb7c4c8813d741108c14722a85732fe/merged/var/data/keylogger.bin:    === LOG START SK-CERT{l34v3_17_70_7h3_pr05} === %s
</code></pre><h3 id=key-findings-and-flag>Key Findings and Flag</h3><p>We found two potential flags:</p><ol><li><code>SK-CERT{n3v3r_f0r637_4b0u7_d47_p3r51573nc3}</code> in <code>/tmp/persistence</code></li><li><code>SK-CERT{l34v3_17_70_7h3_pr05}</code> in <code>/var/data/keylogger.bin</code></li></ol><p>After verification, the correct flag is: <strong>SK-CERT{l34v3_17_70_7h3_pr05}</strong> the other one was the flag for the very first challenge not included in this series because it was easy to get.</p><h3 id=lessons-learned>Lessons Learned</h3><ul><li>Always check binary files when searching for flags</li><li>Multiple potential flags might be present; verification is important</li><li>The location of a flag can provide context (in this case, a keylogger binary)</li></ul><h2 id=3-challenge-3-bastion---clean-bastion>3. Challenge 3: Bastion - Clean bastion</h2><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup3/images/clean%20bastion.png?raw=true" alt=bastion></p><blockquote><p>ssh://exp.cybergame.sk:7009 (ratchet:23ekmnjr4bh5tgvfhbejncidj)</p></blockquote><p>For this challenge, we need to SSH into the provided bastion host and investigate the system.</p><h3 id=methodology-1>Methodology</h3><ol><li>Establish an SSH connection to the bastion host</li><li>Investigate the system for any issues or flags</li><li>Document findings</li></ol><h3 id=step-by-step-solution-1>Step-by-Step Solution</h3><h4 id=step-1-connect-to-the-bastion-host>Step 1: Connect to the Bastion Host</h4><p>First, we need to connect to the provided SSH server:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -p <span style=color:#ae81ff>7009</span> ratchet@exp.cybergame.sk
</span></span></code></pre></div><p>When prompted, enter the password: <code>23ekmnjr4bh5tgvfhbejncidj</code></p><p>Upon successful connection, we&rsquo;re greeted with a welcome message that contains our flag:</p><pre tabindex=0><code>Welcome, Ratchet!
Come in and don&#39;t be shy
     SK-CERT{bru73_f0rc1n6_u53r5_w0rk5}
</code></pre><h4 id=step-2-verify-system-status>Step 2: Verify System Status</h4><p>Even though we&rsquo;ve found the flag, let&rsquo;s perform a basic system check to ensure everything is as expected:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ls -la /home/ratchet
</span></span><span style=display:flex><span>ls -la /tmp
</span></span><span style=display:flex><span>ls -la /var/tmp
</span></span></code></pre></div><p>These commands show no suspicious files in the home directory or temporary directories.</p><h3 id=key-findings-and-flag-1>Key Findings and Flag</h3><p>The flag was displayed in the welcome message upon SSH login: <strong>SK-CERT{bru73_f0rc1n6_u53r5_w0rk5}</strong></p><h3 id=lessons-learned-1>Lessons Learned</h3><ul><li>Sometimes flags are hidden in plain sight, like welcome messages</li><li>Initial reconnaissance is crucial, even when a flag is immediately visible</li><li>The flag suggests this challenge was about brute forcing user credentials</li></ul><h2 id=4-challenge-4-bastion---feel-free-to-dig-in>4. Challenge 4: Bastion - Feel free to dig in</h2><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup3/images/feel%20free%20to%20dig%20in.png?raw=true" alt=bastion></p><blockquote><p>ssh://exp.cybergame.sk:7009</p></blockquote><p>For this challenge, we need to conduct a deeper forensic investigation of the same bastion host to find traces of attackers.</p><h3 id=methodology-2>Methodology</h3><ol><li>Connect to the bastion host</li><li>Conduct a thorough forensic investigation</li><li>Look for unusual files, configurations, or hidden data</li><li>Document all findings</li></ol><h3 id=step-by-step-solution-2>Step-by-Step Solution</h3><h4 id=step-1-connect-to-the-bastion-host-1>Step 1: Connect to the Bastion Host</h4><p>We use the same SSH connection as in the previous challenge:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -p <span style=color:#ae81ff>7009</span> ratchet@exp.cybergame.sk
</span></span></code></pre></div><p>Password: <code>23ekmnjr4bh5tgvfhbejncidj</code></p><h4 id=step-2-investigate-user-accounts-and-home-directories>Step 2: Investigate User Accounts and Home Directories</h4><p>Let&rsquo;s check the user accounts and home directories:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat /etc/passwd
</span></span><span style=display:flex><span>ls -la /home
</span></span></code></pre></div><p>We notice there&rsquo;s an <code>admin</code> user in addition to our <code>ratchet</code> user.</p><h4 id=step-3-check-ssh-configuration-and-keys>Step 3: Check SSH Configuration and Keys</h4><p>Since we&rsquo;re dealing with a bastion host, SSH configuration is a good place to look:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ls -la /home/ratchet/.ssh
</span></span><span style=display:flex><span>cat /home/ratchet/.ssh/authorized_keys
</span></span></code></pre></div><p>In the authorized_keys file, we find a suspicious entry:</p><pre tabindex=0><code>ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOSeOZtJmXS7zliVg5tEaEk9KvhIRn4S3FBjLuo1s0eUvHi6HkzuLTNXiphR8Lth/DWQNeC/A+meex8Y09RtZQA= hacker-U0stQ0VSVHtoMEx5X00wTGx5X1RIM3lfNHIzXzV0aUxsX2gzUjN9
</code></pre><p>The comment on this key looks like it contains base64-encoded data.</p><h4 id=step-4-decode-the-base64-string>Step 4: Decode the Base64 String</h4><p>Let&rsquo;s decode the base64 string in the comment:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;U0stQ0VSVHtoMEx5X00wTGx5X1RIM3lfNHIzXzV0aUxsX2gzUjN9&#34;</span> | base64 -d
</span></span></code></pre></div><p>This reveals our flag: <code>SK-CERT{h0Ly_m0Lly_TH3y_4r3_5tiLl_h3R3}</code></p><h3 id=key-findings-and-flag-2>Key Findings and Flag</h3><p>We found a suspicious SSH key in the authorized_keys file with a base64-encoded comment that contained the flag: <strong>SK-CERT{h0Ly_m0Lly_TH3y_4r3_5tiLl_h3R3}</strong></p><h3 id=lessons-learned-2>Lessons Learned</h3><ul><li>Attackers often leave backdoors for persistent access</li><li>SSH authorized_keys files are common places for backdoors</li><li>Base64 encoding is frequently used to hide information</li><li>Always check for unusual comments or strings that might contain encoded data</li></ul><h2 id=5-challenge-5-bastion---the-backdoor-culprit>5. Challenge 5: Bastion - The backdoor culprit</h2><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup3/images/the%20backdoor%20culprit.png?raw=true" alt=bastion></p><p>For this challenge, we are provided with a git repository archive (<code>part5_ssh-bastion-repo.tar.gz</code>) and need to identify who added the backdoor we found in the previous challenge.</p><h3 id=methodology-3>Methodology</h3><ol><li>Extract the git repository</li><li>Explore the repository structure</li><li>Analyze the commit history</li><li>Identify when and by whom the backdoor was introduced</li></ol><h3 id=step-by-step-solution-3>Step-by-Step Solution</h3><h4 id=step-1-extract-the-git-repository>Step 1: Extract the Git Repository</h4><p>First, let&rsquo;s extract the provided archive:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p /home/ubuntu/bastion_repo_ctf
</span></span><span style=display:flex><span>tar -xzf <span style=color:#e6db74>&#34;part5_ssh-bastion-repo.tar.gz&#34;</span> -C /home/ubuntu/bastion_repo_ctf
</span></span></code></pre></div><h4 id=step-2-explore-the-repository-structure>Step 2: Explore the Repository Structure</h4><p>Let&rsquo;s see what files are in the repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ls -R /home/ubuntu/bastion_repo_ctf/ssh-bastion-repo
</span></span></code></pre></div><p>Output:</p><pre tabindex=0><code>/home/ubuntu/bastion_repo_ctf/ssh-bastion-repo:
Dockerfile  docker-compose.yml  issue.generic  motd
README.md   issue.admin         issue.ratchet  sshd_config
</code></pre><h4 id=step-3-examine-the-dockerfile>Step 3: Examine the Dockerfile</h4><p>Since we know the backdoor was in the SSH authorized_keys file, let&rsquo;s check the Dockerfile:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat /home/ubuntu/bastion_repo_ctf/ssh-bastion-repo/Dockerfile
</span></span></code></pre></div><p>In the Dockerfile, we find the suspicious SSH key being added:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dockerfile data-lang=dockerfile><span style=display:flex><span><span style=color:#66d9ef>RUN</span> mkdir -p /home/ratchet/.ssh <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    echo -e <span style=color:#e6db74>&#34;\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ecdsa-sha2-nistp256 AAAAvZHODysGbxHo1wGtqbqi1Ffnr2li7j8ov/V26Nt4w/HR26mWOtT/APG1qBilJoVmCQChz/hCWuIWwzqqZNe1BQ== ratchet@infocube\n\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOSeOZtJmXS7zliVg5tEaEk9KvhIRn4S3FBjLuo1s0eUvHi6HkzuLTNXiphR8Lth/DWQNeC/A+meex8Y09RtZQA= hacker-U0stQ0VSVHtoMEx5X00wTGx5X1RIM3lfNHIzXzV0aUxsX2gzUjN9\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;</span> &gt; /home/ratchet/.ssh/authorized_keys<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><h4 id=step-4-analyze-the-git-history>Step 4: Analyze the Git History</h4><p>Now, let&rsquo;s check the commit history for the Dockerfile to see who added this backdoor:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /home/ubuntu/bastion_repo_ctf/ssh-bastion-repo
</span></span><span style=display:flex><span>git log --all --pretty<span style=color:#f92672>=</span>oneline --abbrev-commit Dockerfile
</span></span></code></pre></div><p>Output:</p><pre tabindex=0><code>434e557 merge suggested changes from colleague
a222654 update ssh keys SK-CERT{r09U3_3MPL0Y33_0r_5uPpLycH41n}
fe00ee7 upgrade base image
018ab72 harden user passwords
3f9744d bastion deployment. initial commit
</code></pre><p>The commit message for <code>a222654</code> looks suspicious and contains what appears to be our flag.</p><h4 id=step-5-examine-the-specific-commit>Step 5: Examine the Specific Commit</h4><p>Let&rsquo;s look at the details of this commit:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git show a222654
</span></span></code></pre></div><p>Output:</p><pre tabindex=0><code>commit a22265452b4b9e02dd3492165c953dd53d1ba393
Author: Ratcher Tailhorn &lt;employee@infocude&gt;
Date:   Fri Apr 18 23:30:01 2025 +0200
    update ssh keys SK-CERT{r09U3_3MPL0Y33_0r_5uPpLycH41n}
diff --git a/Dockerfile b/Dockerfile
index 8fc2b95..41b13b5 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -21,7 +21,8 @@ COPY sshd_config /etc/ssh/sshd_config
 
 RUN mkdir -p /home/ratchet/.ssh &amp;&amp; \
     echo -e &#34;\
-ecdsa-sha2-nistp256 AAAAvZHODysGbxHo1wGtqbqi1Ffnr2li7j8ov/V26Nt4w/HR26mWOtT/APG1qBilJoVmCQChz/hCWuIWwzqqZNe1BQ== ratchet@infocube\n
+ecdsa-sha2-nistp256 AAAAvZHODysGbxHo1wGtqbqi1Ffnr2li7j8ov/V26Nt4w/HR26mWOtT/APG1qBilJoVmCQChz/hCWuIWwzqqZNe1BQ== ratchet@infocube\n\
+ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOSeOZtJmXS7zliVg5tEaEk9KvhIRn4S3FBjLuo1s0eUvHi6HkzuLTNXiphR8Lth/DWQNeC/A+meex8Y09RtZQA= hacker-U0stQ0VSVHtoMEx5X00wTGx5X1RIM3lfNHIzXzV0aUxsX2gzUjN9\
 &#34; &gt; /home/ratchet/.ssh/authorized_keys
</code></pre><p>This confirms that the backdoor was added by &ldquo;Ratcher Tailhorn&rdquo; in a commit with the message containing our flag.</p><h3 id=key-findings-and-flag-3>Key Findings and Flag</h3><p>The backdoor was introduced by a user named &ldquo;Ratcher Tailhorn&rdquo; in commit <code>a222654</code>. The commit message itself contains the flag: <strong>SK-CERT{r09U3_3MPL0Y33_0r_5uPpLycH41n}</strong></p><h3 id=lessons-learned-3>Lessons Learned</h3><ul><li>Git history is a valuable forensic resource</li><li>Commit messages and author information can reveal the source of malicious code</li><li>Backdoors are often introduced in seemingly innocent updates</li><li>Always review code changes, especially those affecting security configurations</li></ul><h2 id=6-conclusion>6. Conclusion</h2><p>These challenges demonstrate the importance of thorough system inspection, understanding common backdoor techniques, and the value of version control history in forensic investigations.</p><h3 id=final-thoughts>Final Thoughts</h3><p>The Bastion series provides an excellent progression of challenges that build upon each other, telling a coherent story of system compromise and investigation. The skills practiced here are directly applicable to real-world security scenarios, making this an educational and practical CTF series.</p><h2 id=7-references>7. References</h2><h3 id=useful-commands>Useful Commands</h3><ul><li><code>tar -xzf &lt;archive.tar.gz> -C &lt;destination></code> - Extract a tar.gz archive</li><li><code>grep -a -r "pattern" &lt;directory></code> - Recursively search for a pattern</li><li><code>ssh -p &lt;port> &lt;user>@&lt;host></code> - Connect to an SSH server</li><li><code>echo "&lt;string>" | base64 -d</code> - Decode a base64 string</li><li><code>git log --all --pretty=oneline --abbrev-commit &lt;file></code> - View git history for a file</li><li><code>git show &lt;commit></code> - Show details of a specific commit</li></ul><h3 id=additional-resources>Additional Resources</h3><ul><li><a href=https://docs.docker.com/>Docker Documentation</a></li><li><a href=https://www.ssh.com/academy/ssh/security>SSH Security Best Practices</a></li><li><a href=https://git-scm.com/book/en/v2>Git for Security Professionals</a></li><li><a href=https://www.kali.org/tools/>Linux Forensics Tools</a></li></ul><p>The next challenge on forensics</p><h1 id=-eugenes-fatigue>[★★☆] Eugene’s FATigue</h1><p><a href="https://github.com/lukaskuzmiak/cybergame.sk-2025-writeups/tree/main/Eugene's%20FATigue#-eugenes-fatigue"></a></p><h2 id=fatigue>FATigue</h2><p><img src=https://miro.medium.com/v2/resize:fit:640/format:webp/1*2YNYZYcfvDyAXyLPS9WEGw.png alt=eugene></p><p><em>Solution</em></p><p>The head of the challenge gave us a hint it was a <em>FATdisk image</em>.so after mounting the disk then we got a file named <em>secret.txt</em> and innit we got the below text.</p><pre tabindex=0><code>This feels like FX-PREG{cy41a_5vTu7} to me. Cannot hide my best work here.
</code></pre><p>The text  <code>FX-PREG{cy41a_5vTu7}</code> is the flag but in ROT13 so we decode it to get the flag</p><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup3/images/rot13%20dcode.png?raw=true" alt=hh></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>SK-CERT<span style=color:#f92672>{</span>pl41n_5iGh7<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=is-that-it><strong>Is that it?</strong></h2><p><img src=https://miro.medium.com/v2/resize:fit:720/format:webp/1*FDc02Ija-sH1SwY_5w-TUA.png alt=eugene></p><p><em>Solution</em></p><p>Just casually searching for stuff in a hex editor, I noticed a PDF in there somewhere; there is some weird base64 inside the PDF:</p><pre tabindex=0><code>VuwtuTeEEf9uthkAwc1_zzpRq9x4c/LV0TOw5x6a_U0stQ0VSVHs3aDFzX1dBU18xN19hZnRlcl9hbGx9$EucR/FqMoVaZvjx3OvGT_EV4u/Y7EDwDeA/w9QO3+^ALYXhvTD3R1JcGJUgKFi_mhzkezdqaIHzm261y9IQ_EV4u/Y7EDwDeA/w9QO3+
</code></pre><p>Inside it is a flag:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>U0stQ0VSVHs3aDFzX1dBU18xN19hZnRlcl9hbGx9$EucR
</span></span></code></pre></div><p>after decoding we get a cool flag&mldr;</p><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup3/images/second%20flag.png?raw=true" alt=hh></p><p><code>SK-CERT{7h1s_WAS_17_after_all}</code></p><h2 id=was-that-the-only-file><strong>Was that the only file?</strong></h2><p><img src=https://miro.medium.com/v2/resize:fit:720/format:webp/1*2g_-N1aMCuWe3x4oKQeh1A.png alt=eugene></p><p><em>Solution</em></p><p>Ok, enough messing around with <code>strings</code> and <em><strong>hex editors</strong></em>, we were clearly intended to actually recover data for real.</p><p>Here the recovery was attempted with <strong>PhotoRec/TestDisk</strong>, in one of the runs corrupted files were enabled; this recovered the files in <a href="https://github.com/lukaskuzmiak/cybergame.sk-2025-writeups/blob/main/Eugene's%20FATigue/Solution/recovered"><code>recovered/</code></a>. The corrupted ZIP can be unpacked with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>7z x b0003185_file.zip
</span></span></code></pre></div><p>This unpacks three files:</p><pre tabindex=0><code>fifth.txt
file
fourth-flag.aes.b64.txt
</code></pre><p><code>file</code> is the file relevant for the third flag and it contains the following text:</p><blockquote><p>Begin by gently whispering to a fresh beetroot, ensuring it&rsquo;s thoroughly startled before peeling. Simmer beef slices under moonlight until they hum softly, indicating readiness. Combine with precisely three beetroot dreams, diced finely, and a pinch of yesterday’s laughter. Allow the mixture to philosophize in an oven preheated to curiosity. Occasionally stir with a skeptical spoon, preferably wooden, until the aroma resembles purple jazz. Serve only after garnishing with a sprinkle of questions unanswered, paired with a side dish of a sautéed third flag SK-CERT{R3c0V3r3D_R3cip3}.</p></blockquote><p>The flag was cool and was:</p><pre tabindex=0><code>SK-CERT{R3c0V3r3D_R3cip3}
</code></pre><h2 id=it-tastes-like-a-poem>It tastes like a poem</h2><p><img src=https://miro.medium.com/v2/resize:fit:720/format:webp/1*GcYsODwaCtsSHUV2IpdTJA.png alt=keep></p><p><em>Solution</em></p><p>It seems the <code>fourth-flag.aes.b64.txt</code> is the file for this challenge.</p><p>I wrote <code>forensics.py</code> to assist in the decoding and so on,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Load and decode the file</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;fourth-flag.aes.b64.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> base64<span style=color:#f92672>.</span>b64decode(f<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>strip())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Best working parameters from our tests</span>
</span></span><span style=display:flex><span>null_key <span style=color:#f92672>=</span> bytes(<span style=color:#ae81ff>32</span>)  <span style=color:#75715e># 32 null bytes for AES-256</span>
</span></span><span style=display:flex><span>iv <span style=color:#f92672>=</span> data[:<span style=color:#ae81ff>16</span>]        <span style=color:#75715e># First 16 bytes as IV</span>
</span></span><span style=display:flex><span>ciphertext <span style=color:#f92672>=</span> data[<span style=color:#ae81ff>16</span>:]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Decrypt using AES-CBC</span>
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(null_key, AES<span style=color:#f92672>.</span>MODE_CBC, iv<span style=color:#f92672>=</span>iv)
</span></span><span style=display:flex><span>decrypted <span style=color:#f92672>=</span> cipher<span style=color:#f92672>.</span>decrypt(ciphertext)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Clean up padding and save full output</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Remove PKCS#7 padding if present</span>
</span></span><span style=display:flex><span>    pad_len <span style=color:#f92672>=</span> decrypted[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> pad_len <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>16</span> <span style=color:#f92672>and</span> all(b <span style=color:#f92672>==</span> pad_len <span style=color:#66d9ef>for</span> b <span style=color:#f92672>in</span> decrypted[<span style=color:#f92672>-</span>pad_len:]):
</span></span><span style=display:flex><span>        decrypted <span style=color:#f92672>=</span> decrypted[:<span style=color:#f92672>-</span>pad_len]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Save to file and print first 200 characters</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;decrypted_poem.txt&#34;</span>, <span style=color:#e6db74>&#34;wb&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        f<span style=color:#f92672>.</span>write(decrypted)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Full decryption saved to decrypted_poem.txt&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>First 200 characters:&#34;</span>)
</span></span><span style=display:flex><span>    print(decrypted[:<span style=color:#ae81ff>200</span>]<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>, errors<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;replace&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Error cleaning padding:&#34;</span>, e)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Raw output (first 200 bytes):&#34;</span>)
</span></span><span style=display:flex><span>    print(decrypted[:<span style=color:#ae81ff>200</span>])
</span></span></code></pre></div><p>and it got the flag right away
The Results are as below <em>cool and juicy!!!!!</em>
<img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup3/images/forensics.png?raw=true" alt=eugene></p><pre tabindex=0><code>SK-CERT{d0esnt_m4ke_s3nse_7o_d0_f0rensics_anym0r3}
</code></pre><h2 id=wrapping-it-up><strong>Wrapping it up</strong></h2><p><img src=https://miro.medium.com/v2/resize:fit:720/format:webp/1*hcpfwA7nCsHWze2Dz2HVGQ.png alt=eugene></p><p><strong>Solution</strong></p><p>The <code>fifth.txt</code> contains the below text with the flag
<img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup3/images/finalforensics.png?raw=true" alt=eugene></p><p><code>SK-CERT{1mp0ss1bly_H4RD}</code> </p><p>That was the flag for this challenge. It seems <strong>PhotoRec/TestDisk</strong> recovered enough mess after the ZIP or 7z did a good job to extract this anyway, not sure, to be honest.</p><blockquote><p><em>thats it on the eugene fatigue now to the next challenge:</em></p></blockquote><h1 id=-the-chronicles-of-greg-2--frustrating-compression>[★☆☆] The Chronicles of Greg 2 — Frustrating compression</h1><p>On this challenge it was cold to me but a nigga gave me glasses to see it through though it was the last minute and the servers were down i coulnt submit the results but were correct after crawling though other writeups and in deed i was correct.that made me cool.enough with the crap lets dive in :</p><h3 id=1-the-chronicles-of-greg-frustrating-compression>1. <strong>The Chronicles of Greg Frustrating compression</strong></h3><p>There was a <strong>lot</strong> of archives here, after fiddling with it manually for a minute or so, it quickly became clear that it was a no-go. I asked chat-gpt to help create a code several times and at long last i got it right with few tweaks it was ready to go&mldr;.</p><p><code>extract.py</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> logging
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> shutil
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> tarfile
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> tempfile
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zipfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> py7zr
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> rarfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>START_ARCHIVE <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;00114021.tar&#39;</span>
</span></span><span style=display:flex><span>OUTPUT_DIR <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/tmp/out&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Supported archive extensions</span>
</span></span><span style=display:flex><span>ARCHIVE_EXTENSIONS <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#39;.zip&#39;</span>, <span style=color:#e6db74>&#39;.tar&#39;</span>, <span style=color:#e6db74>&#39;.rar&#39;</span>, <span style=color:#e6db74>&#39;.7z&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>makedirs(OUTPUT_DIR, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>is_archive</span>(filename):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> filename<span style=color:#f92672>.</span>lower()<span style=color:#f92672>.</span>endswith(ARCHIVE_EXTENSIONS)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_archive</span>(filepath, extract_to):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> filepath<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#39;.zip&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> zipfile<span style=color:#f92672>.</span>ZipFile(filepath, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> zf:
</span></span><span style=display:flex><span>            zf<span style=color:#f92672>.</span>extractall(extract_to)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> filepath<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#39;.tar&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> tarfile<span style=color:#f92672>.</span>open(filepath, <span style=color:#e6db74>&#39;r:*&#39;</span>) <span style=color:#66d9ef>as</span> tf:
</span></span><span style=display:flex><span>            tf<span style=color:#f92672>.</span>extractall(extract_to, filter<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;tar&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> filepath<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#39;.rar&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> rarfile<span style=color:#f92672>.</span>RarFile(filepath) <span style=color:#66d9ef>as</span> rf:
</span></span><span style=display:flex><span>            rf<span style=color:#f92672>.</span>extractall(extract_to)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> filepath<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#39;.7z&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> py7zr<span style=color:#f92672>.</span>SevenZipFile(filepath, mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> z:
</span></span><span style=display:flex><span>            z<span style=color:#f92672>.</span>extractall(extract_to)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Unsupported archive: </span><span style=color:#e6db74>{</span>filepath<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>processed_archives <span style=color:#f92672>=</span> set()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>process_archive</span>(filepath):
</span></span><span style=display:flex><span>    abs_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>abspath(filepath)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> abs_path <span style=color:#f92672>in</span> processed_archives:
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>warning(<span style=color:#e6db74>&#39;Skipping already processed archive: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span>, filepath)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#39;Extracting archive: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span>, filepath)
</span></span><span style=display:flex><span>    processed_archives<span style=color:#f92672>.</span>add(abs_path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> tempfile<span style=color:#f92672>.</span>TemporaryDirectory() <span style=color:#66d9ef>as</span> tmpdir:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            extract_archive(filepath, tmpdir)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span>:
</span></span><span style=display:flex><span>            logging<span style=color:#f92672>.</span>exception(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Failed to extract </span><span style=color:#e6db74>{</span>filepath<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> root, _, files <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>walk(tmpdir):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> name <span style=color:#f92672>in</span> files:
</span></span><span style=display:flex><span>                full_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(root, name)
</span></span><span style=display:flex><span>                logging<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#39;Found file: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span>, full_path)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> is_archive(name):
</span></span><span style=display:flex><span>                    logging<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#39;Recursing into nested archive: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span>, full_path)
</span></span><span style=display:flex><span>                    process_archive(full_path)
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>&#39;.&#39;</span>, end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>, flush<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    rel_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>relpath(full_path, tmpdir)
</span></span><span style=display:flex><span>                    out_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(OUTPUT_DIR, rel_path)
</span></span><span style=display:flex><span>                    os<span style=color:#f92672>.</span>makedirs(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(out_path), exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>                    logging<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#39;Copying non-archive file to output: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span>, out_path)
</span></span><span style=display:flex><span>                    shutil<span style=color:#f92672>.</span>copy2(full_path, out_path)
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>&#39;+&#39;</span>, end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>, flush<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    process_archive(START_ARCHIVE)
</span></span><span style=display:flex><span>    print()
</span></span></code></pre></div><p>just run the code and let magic and power do its work &mldr;.to unpack it all, then just found the flag:&mldr;
<img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup3/images/greg1.png?raw=true" alt=greg></p><blockquote><p>the next part was the most challenging part even with the glasses it was hard headed to me.i coundnt crack it but i will try to,,</p></blockquote><hr><blockquote><p>hope you enjoyed the reading.Feel free to tag me.</p></blockquote></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>