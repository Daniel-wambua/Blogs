<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/ctf/writeup1/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content="BREAK THE SYNTAX CTF - 2025"><meta property="og:description" content="Hosted by KN White Hats, Scientific Club of Students of Wrocław University of Science and Technology"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2025-05-12T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content="BREAK THE SYNTAX CTF - 2025"><meta name=twitter:description content="Hosted by KN White Hats, Scientific Club of Students of Wrocław University of Science and Technology"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="hacking articles,hacking articles blog,hacking articles tutorials,hacking articles writeups,ethical hacking articles,cybersecurity articles,security hacking articles,penetration testing articles,infosec articles,cyber security hacking articles,cybersecurity,ethical hacking,CTF writeups,penetration testing,security research,bug bounty,offensive security,infosec,hackthebox,web exploitation,havoc,Richie havoc,htb,learn ethical hacking,hacking tutorials for beginners,cybersecurity tutorials,how to hack ethically,penetration testing course,security researcher blog,hacking step by step guide,ethical hacking examples,real world hacking scenarios,practical hacking exercises,Hercules,Soulmate,Darkcorp,Darkzero,Writeup,Bugbounty,htb writeups,hackthebox walkthrough,hackthebox solutions,penetration testing tutorials,linux privilege escalation,windows privilege escalation,active directory hacking,OSCP preparation,cyber security blog,vulnerability research,exploit development,reverse engineering,binary exploitation,pwn challenges,web security,network security,cryptography challenges,tryhackme,offsec labs,BoardLight HTB,Instant HTB,Sea HTB,Cicada HTB,Intuition HTB,Sightless HTB,Editorial HTB,Runner HTB,Greenhorn HTB,Blazorized HTB,Surveillance HTB,Headless HTB,Crafty HTB,Bizness HTB,Mist HTB,Usage HTB,Perfection HTB,Builder HTB,WifineticTwo HTB,Cap HTB,Analysis HTB,Keeper HTB,ctf challenges,capture the flag,cyber defense,red team operations,blue team defense,malware analysis,forensics challenges,steganography,OSINT techniques,kali linux tutorials,metasploit framework,burp suite tutorials,nmap scanning,sql injection,xss exploitation,privilege escalation techniques,buffer overflow,rop chain,shellcode development,reverse shell,web shell,docker security,kubernetes pentesting,cloud security,aws security,azure pentesting,api security testing,jwt exploitation,owasp top 10,security certifications,CEH preparation,OSWE preparation,OSCE preparation,NanoCorp HTB,NanoCorp walkthrough,NanoCorp writeup,NanoCorp HTB writeup,HTB NanoCorp exploitation,HTB NanoCorp solution,HackTheBox NanoCorp,NTLM relay attacks,NTLM relay exploitation,responder NTLM relay,ntlmrelayx tutorial,windows active directory exploitation,windows privilege escalation techniques,windows enumeration techniques,SMB relay attacks,credential discovery techniques,hard difficulty HTB machines,advanced windows hacking,active directory pentesting guide,windows security assessment,windows post exploitation,domain controller exploitation,kerberos attacks,pass the hash,lateral movement techniques,bloodhound enumeration,impacket tools,windows pentesting,HTB hard machines 2025,HTB season 9 machines,advanced AD attacks,HTB NanoCorp writeup,HTB NanoCorp Machine writeup,nanocorp.htb,CVE-2025-24071,HTB NanoCorp exploitation,DCOM exploitation,Windows DCOM attacks,DACL Abuse,best hacking articles website,top cybersecurity writeup blogs,where to find CTF writeups,detailed penetration testing tutorials,comprehensive hacking guides,step by step hacking tutorials,beginner to advanced ethical hacking,free hacking learning resources,cybersecurity blog 2025,latest hacking techniques,modern exploitation methods,practical security research,how to solve CTF challenges,how to hack hackthebox machines,privilege escalation methods explained,web application security testing,how to find vulnerabilities,penetration testing methodology,OSCP exam preparation tips,HTB machine walkthrough,CTF challenge solutions,security assessment guide,metasploit tutorials,burp suite guides,nmap cheat sheet,gobuster usage,hydra brute force,sqlmap injection,netcat reverse shell,wireshark packet analysis,john the ripper tutorial,hashcat cracking guide,OSCP certification preparation,CEH study materials,bug bounty hunter tips,cybersecurity career guide,penetration tester roadmap,ethical hacker certification,security researcher career path,infosec job preparation,2025 hacking tutorials,latest CVE exploits,zero day vulnerabilities,current cybersecurity threats,modern web exploitation,cloud security testing,API security vulnerabilities,container security hacking,AI security research,machine learning vulnerabilities,alternative to ippsec,similar to hackingarticles,best ctf writeup sites,top penetration testing blogs,ethical hacking resources,cybersecurity learning platforms,hacking practice labs,hacking community,infosec community blog,cybersecurity forum,ethical hacking discord,CTF community,bug bounty community,security researchers network"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/ctf/writeup1/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/ctf/writeup1/"><meta property="og:title" content="BREAK THE SYNTAX CTF - 2025"><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-05-12T00:00:00Z"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="article:author" content="Richie-Havoc"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/ctf/writeup1/"><meta name=twitter:title content="BREAK THE SYNTAX CTF - 2025"><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="ctf"><meta name=article:subtitle content="⚡ Hack the Logic. ⚡"><meta name=article:summary content="*Hosted by KN White Hats, Scientific Club of Students of Wrocław University of Science and Technology*"><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content="BREAK THE SYNTAX CTF - 2025"><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Ctf","item":"https:\/\/havocsec.me\/ctf/"},{"@type":"ListItem","position":3,"name":"BREAK THE SYNTAX CTF - 2025","item":"https:\/\/havocsec.me\/ctf\/writeup1\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">BREAK THE SYNTAX CTF - 2025</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">⚡ Hack the Logic. ⚡</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">May 12, 2025 - 7 minute read</div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><h1 id=break-the-syntax-ctf-2025>Break The Syntax CTF 2025</h1><p>The first challenge i solved was this one</p><h1 id=based-encoder-rev>Based Encoder (rev)</h1><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup1/images/image-2.png?raw=true" alt=image></p><h2 id=solution>Solution</h2><p>Running Strings on the file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>strings based_encoder
</span></span></code></pre></div><p>Response
<img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup1/images/Screenshot%20from%202025-05-12%2010-06-28.png?raw=true" alt=image>
There is a string ,Which looks like a BASE64 encoded text. juicy! juicy!</p><p>Using BASE64 decoder we get the flag.
<img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup1/images/Screenshot%20from%202025-05-12%2010-08-30.png?raw=true" alt=Screenshot></p><p>Next challenge</p><p><strong>Better AES (Crypto)</strong>
<img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup1/images/image-3.png?raw=true" alt=image></p><h2 id=solution-1>Solution</h2><p>Running this Script Gives the output</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>import pwn <span style=color:#75715e># pwntools for easy remote connection</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Copied AES components from the challenge</span>
</span></span><span style=display:flex><span>BLOCK_SIZE <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>NUM_ROUNDS <span style=color:#f92672>=</span> <span style=color:#ae81ff>14</span> <span style=color:#75715e># For AES-256</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>def gf_mult<span style=color:#f92672>(</span>a, b<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> _ in range<span style=color:#f92672>(</span>8<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> b &amp; 1:
</span></span><span style=display:flex><span>           result ^<span style=color:#f92672>=</span> a
</span></span><span style=display:flex><span>        high <span style=color:#f92672>=</span> a &amp; 0x80
</span></span><span style=display:flex><span>        a <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>a <span style=color:#e6db74>&lt;&lt; 1) &amp; 0xFF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        if high:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          a ^= 0x1</span>B
</span></span><span style=display:flex><span>        b &gt;&gt;<span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>def shift_rows<span style=color:#f92672>(</span>state_list<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    new <span style=color:#f92672>=</span> <span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> * <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> r in range<span style=color:#f92672>(</span>4<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> c in range<span style=color:#f92672>(</span>4<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>            new<span style=color:#f92672>[</span>r + 4*c<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> state_list<span style=color:#f92672>[</span>r + 4*<span style=color:#f92672>((</span>c + r<span style=color:#f92672>)</span> % 4<span style=color:#f92672>)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>def inv_shift_rows<span style=color:#f92672>(</span>state_list<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    new <span style=color:#f92672>=</span> <span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> * <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> r in range<span style=color:#f92672>(</span>4<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> c in range<span style=color:#f92672>(</span>4<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>            new<span style=color:#f92672>[</span>r + 4*c<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> state_list<span style=color:#f92672>[</span>r + 4*<span style=color:#f92672>((</span>c - r + 4<span style=color:#f92672>)</span> % 4<span style=color:#f92672>)]</span> <span style=color:#75715e># +4 for true Python modulo</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>def mix_columns<span style=color:#f92672>(</span>state_list<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    new <span style=color:#f92672>=</span> state_list<span style=color:#f92672>[</span>:<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> c in range<span style=color:#f92672>(</span>4<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        col <span style=color:#f92672>=</span> state_list<span style=color:#f92672>[</span>4*c : 4*c+4<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        new<span style=color:#f92672>[</span>4*c + 0<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>, 2<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>, 3<span style=color:#f92672>)</span> ^ col<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> ^ col<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        new<span style=color:#f92672>[</span>4*c + 1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> col<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>, 2<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span>, 3<span style=color:#f92672>)</span> ^ col<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        new<span style=color:#f92672>[</span>4*c + 2<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> col<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> ^ col<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span>, 2<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>, 3<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        new<span style=color:#f92672>[</span>4*c + 3<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>, 3<span style=color:#f92672>)</span> ^ col<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> ^ col<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>, 2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>def inv_mix_columns<span style=color:#f92672>(</span>state_list<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    new <span style=color:#f92672>=</span> state_list<span style=color:#f92672>[</span>:<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> c in range<span style=color:#f92672>(</span>4<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        col <span style=color:#f92672>=</span> state_list<span style=color:#f92672>[</span>4*c : 4*c+4<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        new<span style=color:#f92672>[</span>4*c + 0<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>, 0x0e<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>, 0x0b<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span>, 0x0d<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>, 0x09<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        new<span style=color:#f92672>[</span>4*c + 1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>, 0x09<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>, 0x0e<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span>, 0x0b<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>, 0x0d<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        new<span style=color:#f92672>[</span>4*c + 2<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>, 0x0d<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>, 0x09<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span>, 0x0e<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>, 0x0b<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        new<span style=color:#f92672>[</span>4*c + 3<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>, 0x0b<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>, 0x0d<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span>, 0x09<span style=color:#f92672>)</span> ^ gf_mult<span style=color:#f92672>(</span>col<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>, 0x0e<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> new
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># L(X) = MixColumns(ShiftRows(X))</span>
</span></span><span style=display:flex><span>def L_transform<span style=color:#f92672>(</span>state_list<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> shift_rows<span style=color:#f92672>(</span>state_list<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> mix_columns<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># L_inv(X) = InvShiftRows(InvMixColumns(X))</span>
</span></span><span style=display:flex><span>def L_inv_transform<span style=color:#f92672>(</span>state_list<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> inv_mix_columns<span style=color:#f92672>(</span>state_list<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> inv_shift_rows<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># A_map(P) = ShiftRows(L^{NUM_ROUNDS-1}(P))</span>
</span></span><span style=display:flex><span>def apply_A_map<span style=color:#f92672>(</span>state_list_bytes<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    current_state <span style=color:#f92672>=</span> list<span style=color:#f92672>(</span>state_list_bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> _ in range<span style=color:#f92672>(</span>NUM_ROUNDS - 1<span style=color:#f92672>)</span>: <span style=color:#75715e># 13 times for AES-256</span>
</span></span><span style=display:flex><span>        current_state <span style=color:#f92672>=</span> L_transform<span style=color:#f92672>(</span>current_state<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    current_state <span style=color:#f92672>=</span> shift_rows<span style=color:#f92672>(</span>current_state<span style=color:#f92672>)</span> <span style=color:#75715e># Final ShiftRows</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> bytes<span style=color:#f92672>(</span>current_state<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># A_map_inv(C) = L_inv^{NUM_ROUNDS-1}(InvShiftRows(C))</span>
</span></span><span style=display:flex><span>def apply_A_map_inv<span style=color:#f92672>(</span>state_list_bytes<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    current_state <span style=color:#f92672>=</span> list<span style=color:#f92672>(</span>state_list_bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    current_state <span style=color:#f92672>=</span> inv_shift_rows<span style=color:#f92672>(</span>current_state<span style=color:#f92672>)</span> <span style=color:#75715e># Inverse of final ShiftRows</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> _ in range<span style=color:#f92672>(</span>NUM_ROUNDS - 1<span style=color:#f92672>)</span>: <span style=color:#75715e># 13 times</span>
</span></span><span style=display:flex><span>        current_state <span style=color:#f92672>=</span> L_inv_transform<span style=color:#f92672>(</span>current_state<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> bytes<span style=color:#f92672>(</span>current_state<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>def xor_bytes<span style=color:#f92672>(</span>b1, b2<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> bytes<span style=color:#f92672>(</span>x ^ y <span style=color:#66d9ef>for</span> x, y in zip<span style=color:#f92672>(</span>b1, b2<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --- Main exploit logic ---</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use the local port you bound with `sc -b &lt;local_port&gt; &lt;instance_url&gt;`</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Example: sc -b 12345 betteraes.chal.bts.wh.edu.pl:XXXXX</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Then connect to localhost:12345</span>
</span></span><span style=display:flex><span>LOCAL_PORT <span style=color:#f92672>=</span> <span style=color:#ae81ff>12345</span> <span style=color:#75715e># Change if 12345 is in use or you chose another port</span>
</span></span><span style=display:flex><span>conn <span style=color:#f92672>=</span> pwn.remote<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;localhost&#34;</span>, LOCAL_PORT<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Receive flag ciphertext</span>
</span></span><span style=display:flex><span>line1 <span style=color:#f92672>=</span> conn.recvline<span style=color:#f92672>()</span>.decode<span style=color:#f92672>()</span>.strip<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>flag_ct_hex <span style=color:#f92672>=</span> line1.split<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;: &#34;</span><span style=color:#f92672>)[</span>1<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>flag_ct_bytes <span style=color:#f92672>=</span> bytes.fromhex<span style=color:#f92672>(</span>flag_ct_hex<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>pwn.log.info<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;Received Flag CT (hex): {flag_ct_hex}&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Prepare and send chosen plaintext (cannot be all zeros)</span>
</span></span><span style=display:flex><span>chosen_pt_bytes <span style=color:#f92672>=</span> b<span style=color:#e6db74>&#39;\x01&#39;</span> * BLOCK_SIZE
</span></span><span style=display:flex><span>chosen_pt_hex <span style=color:#f92672>=</span> chosen_pt_bytes.hex<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>conn.recvuntil<span style=color:#f92672>(</span>b<span style=color:#e6db74>&#34;Enter something you want to encrypt in hex form: &#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>conn.sendline<span style=color:#f92672>(</span>chosen_pt_hex.encode<span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>pwn.log.info<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;Sent Chosen PT (hex): {chosen_pt_hex}&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Receive encrypted chosen plaintext</span>
</span></span><span style=display:flex><span>line2 <span style=color:#f92672>=</span> conn.recvline<span style=color:#f92672>()</span>.decode<span style=color:#f92672>()</span>.strip<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>chosen_ct_hex <span style=color:#f92672>=</span> line2.split<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;: &#34;</span><span style=color:#f92672>)[</span>1<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>chosen_ct_bytes <span style=color:#f92672>=</span> bytes.fromhex<span style=color:#f92672>(</span>chosen_ct_hex<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>pwn.log.info<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;Received Chosen CT (hex): {chosen_ct_hex}&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>conn.recvuntil<span style=color:#f92672>(</span>b<span style=color:#e6db74>&#34;Goodbye&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>conn.close<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate A_map(chosen_pt)</span>
</span></span><span style=display:flex><span>a_map_chosen_pt <span style=color:#f92672>=</span> apply_A_map<span style=color:#f92672>(</span>chosen_pt_bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>pwn.log.info<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;A_map(Chosen_PT): {a_map_chosen_pt.hex()}&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate K_eff = chosen_ct_bytes ^ A_map(chosen_pt)</span>
</span></span><span style=display:flex><span>k_eff <span style=color:#f92672>=</span> xor_bytes<span style=color:#f92672>(</span>chosen_ct_bytes, a_map_chosen_pt<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>pwn.log.info<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;Calculated K_eff: {k_eff.hex()}&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Decrypt the flag</span>
</span></span><span style=display:flex><span>decrypted_flag_full_bytes <span style=color:#f92672>=</span> b<span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>num_flag_blocks <span style=color:#f92672>=</span> len<span style=color:#f92672>(</span>flag_ct_bytes<span style=color:#f92672>)</span> // BLOCK_SIZE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i in range<span style=color:#f92672>(</span>num_flag_blocks<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    block_ct <span style=color:#f92672>=</span> flag_ct_bytes<span style=color:#f92672>[</span>i*BLOCK_SIZE : <span style=color:#f92672>(</span>i+1<span style=color:#f92672>)</span>*BLOCK_SIZE<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    intermediate_val <span style=color:#f92672>=</span> xor_bytes<span style=color:#f92672>(</span>block_ct, k_eff<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    dec_block <span style=color:#f92672>=</span> apply_A_map_inv<span style=color:#f92672>(</span>intermediate_val<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    decrypted_flag_full_bytes <span style=color:#f92672>+=</span> dec_block
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Strip padding (null bytes)</span>
</span></span><span style=display:flex><span>final_flag <span style=color:#f92672>=</span> decrypted_flag_full_bytes.strip<span style=color:#f92672>(</span>b<span style=color:#e6db74>&#39;\0&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pwn.success<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;Decrypted Flag: {final_flag.decode()}&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p>response and flag
REDACTED</p><p>Next challenge</p><h1 id=rainbow-bash-adventure-rev>Rainbow Bash Adventure (rev)</h1><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup1/images/image-5.png?raw=true" alt=image></p><h2 id=solution-2>Solution</h2><p>Extracting the zip and seeing in the <code>game</code> folder we can see there is a file called <code>script.rpy</code></p><p>Run</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat script.py
</span></span></code></pre></div><p>and paste the contents in <code>script_py_content = """&lt;SCRIPT CONTENTS>"""</code></p><p>Running this script Gives us the Flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>import re
</span></span><span style=display:flex><span>import numpy as np
</span></span><span style=display:flex><span>from python_tsp.exact import solve_tsp_dynamic_programming
</span></span><span style=display:flex><span>import hashlib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --- Part 1: Parse script.rpy to get distance matrix ---</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Content of script.rpy (truncated for brevity in explanation, full content used in actual script)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>script_rpy_content <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#75715e># RUN cat scripy.rpy and paste it here</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>num_clouds <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>dist_matrix <span style=color:#f92672>=</span> <span style=color:#f92672>[[</span>float<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;inf&#39;</span><span style=color:#f92672>)]</span> * num_clouds <span style=color:#66d9ef>for</span> _ in range<span style=color:#f92672>(</span>num_clouds<span style=color:#f92672>)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i in range<span style=color:#f92672>(</span>num_clouds<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    dist_matrix<span style=color:#f92672>[</span>i<span style=color:#f92672>][</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e># Distance from a cloud to itself is 0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>label_regex <span style=color:#f92672>=</span> re.compile<span style=color:#f92672>(</span>r<span style=color:#e6db74>&#34;label cloud(\d+):&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>menu_item_regex <span style=color:#f92672>=</span> re.compile<span style=color:#f92672>(</span>r<span style=color:#e6db74>&#39;&#34;fly to cloud(\d+) which is (\d+) pony units away&#34;:&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>current_cloud_source <span style=color:#f92672>=</span> -1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> line in script_rpy_content.splitlines<span style=color:#f92672>()</span>:
</span></span><span style=display:flex><span>    line <span style=color:#f92672>=</span> line.strip<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    label_match <span style=color:#f92672>=</span> label_regex.match<span style=color:#f92672>(</span>line<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> label_match:
</span></span><span style=display:flex><span>        current_cloud_source <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>label_match.group<span style=color:#f92672>(</span>1<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> current_cloud_source !<span style=color:#f92672>=</span> -1: <span style=color:#75715e># Ensure we are inside a &#34;label cloudX&#34; block</span>
</span></span><span style=display:flex><span>        menu_match <span style=color:#f92672>=</span> menu_item_regex.search<span style=color:#f92672>(</span>line<span style=color:#f92672>)</span> <span style=color:#75715e># Use search due to &#34;menu:&#34; prefix on first line</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> menu_match:
</span></span><span style=display:flex><span>            dest_cloud <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>menu_match.group<span style=color:#f92672>(</span>1<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>            distance <span style=color:#f92672>=</span> int<span style=color:#f92672>(</span>menu_match.group<span style=color:#f92672>(</span>2<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># Fill the matrix, assuming undirected graph (dist[i][j] == dist[j][i])</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> dist_matrix<span style=color:#f92672>[</span>current_cloud_source<span style=color:#f92672>][</span>dest_cloud<span style=color:#f92672>]</span> <span style=color:#f92672>==</span> float<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;inf&#39;</span><span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>                dist_matrix<span style=color:#f92672>[</span>current_cloud_source<span style=color:#f92672>][</span>dest_cloud<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> distance
</span></span><span style=display:flex><span>            <span style=color:#75715e># else: already set, or error if different - problem implies consistent distances</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> dist_matrix<span style=color:#f92672>[</span>dest_cloud<span style=color:#f92672>][</span>current_cloud_source<span style=color:#f92672>]</span> <span style=color:#f92672>==</span> float<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;inf&#39;</span><span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>                 dist_matrix<span style=color:#f92672>[</span>dest_cloud<span style=color:#f92672>][</span>current_cloud_source<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> distance
</span></span><span style=display:flex><span>            <span style=color:#75715e># else: already set or error</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --- Part 2: Solve TSP ---</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Convert to numpy array for the TSP solver</span>
</span></span><span style=display:flex><span>distance_matrix_np <span style=color:#f92672>=</span> np.array<span style=color:#f92672>(</span>dist_matrix<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Solve TSP using dynamic programming. This returns the permutation and total distance.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># The permutation starts from node 0 by default.</span>
</span></span><span style=display:flex><span>permutation, total_distance <span style=color:#f92672>=</span> solve_tsp_dynamic_programming<span style=color:#f92672>(</span>distance_matrix_np<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># The game&#39;s `nodes` list starts with [0], then appends visited nodes.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># For a path [0, c1, c2, ..., c19, 0], the list becomes [0, c1, c2, ..., c19, 0].</span>
</span></span><span style=display:flex><span><span style=color:#75715e># The `permutation` from python-tsp is [0, c1, ..., c19].</span>
</span></span><span style=display:flex><span>tsp_nodes_path <span style=color:#f92672>=</span> list<span style=color:#f92672>(</span>permutation<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tsp_nodes_path.append<span style=color:#f92672>(</span>tsp_nodes_path<span style=color:#f92672>[</span>0<span style=color:#f92672>])</span> <span style=color:#75715e># Append the starting node to complete the cycle</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;Optimal TSP path: {tsp_nodes_path}&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>print<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;Total distance: {total_distance}&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --- Part 3: Decrypt flag ---</span>
</span></span><span style=display:flex><span>enc_flag_bytes <span style=color:#f92672>=</span> bytearray<span style=color:#f92672>(</span>b<span style=color:#e6db74>&#39;\xc2\x92\xf9\xf66\xe8\xa5\xa6\x17\xb6mGE\xcfQ\x90Mk:\x9a\xbb\x905&amp;\x19\x8e\xc4\x9a\x0b\x1f\xf8C\xf4\xb9\xc9\x85R\xc2\xbb\x8d\x07\x94[R_\xf5z\x9fAl\x11\x9c\xbb\x9255\x08\x8e\xf6\xd6\x04&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>def xor_bytes_func<span style=color:#f92672>(</span>target, key_bytes<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Replicates the game&#39;s xor function</span>
</span></span><span style=display:flex><span>    out <span style=color:#f92672>=</span> bytearray<span style=color:#f92672>(</span>len<span style=color:#f92672>(</span>target<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i in range<span style=color:#f92672>(</span>len<span style=color:#f92672>(</span>target<span style=color:#f92672>))</span>:
</span></span><span style=display:flex><span>        out<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> target<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> ^ key_bytes<span style=color:#f92672>[</span>i % len<span style=color:#f92672>(</span>key_bytes<span style=color:#f92672>)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> out
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>def key_from_path_func<span style=color:#f92672>(</span>path_list<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Replicates the game&#39;s key_from_path function</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> hashlib.sha256<span style=color:#f92672>(</span>str<span style=color:#f92672>(</span>path_list<span style=color:#f92672>)</span>.encode<span style=color:#f92672>())</span>.digest<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>def check_path_and_get_flag<span style=color:#f92672>(</span>path_list, enc_flag_data<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Replicates the game&#39;s check_path logic to find the flag</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Try path as is</span>
</span></span><span style=display:flex><span>    key1 <span style=color:#f92672>=</span> key_from_path_func<span style=color:#f92672>(</span>path_list<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    flag1 <span style=color:#f92672>=</span> xor_bytes_func<span style=color:#f92672>(</span>enc_flag_data, key1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> flag1.startswith<span style=color:#f92672>(</span>b<span style=color:#e6db74>&#34;BtSCTF&#34;</span><span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> flag1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Try reversed path</span>
</span></span><span style=display:flex><span>    key2 <span style=color:#f92672>=</span> key_from_path_func<span style=color:#f92672>(</span>list<span style=color:#f92672>(</span>reversed<span style=color:#f92672>(</span>path_list<span style=color:#f92672>)))</span>
</span></span><span style=display:flex><span>    flag2 <span style=color:#f92672>=</span> xor_bytes_func<span style=color:#f92672>(</span>enc_flag_data, key2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> flag2.startswith<span style=color:#f92672>(</span>b<span style=color:#e6db74>&#34;BtSCTF&#34;</span><span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> flag2
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> None
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>decrypted_flag_bytes <span style=color:#f92672>=</span> check_path_and_get_flag<span style=color:#f92672>(</span>tsp_nodes_path, enc_flag_bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> decrypted_flag_bytes:
</span></span><span style=display:flex><span>    <span style=color:#75715e># The game script formats the flag for display in Ren&#39;Py ([flag] placeholder)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># We just need the raw decoded string.</span>
</span></span><span style=display:flex><span>    print<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;Decrypted Flag: {decrypted_flag_bytes.decode(&#39;ascii&#39;, errors=&#39;ignore&#39;)}&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>  print<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Flag not found. TSP path might be incorrect or there&#39;s another issue.&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup1/images/Screenshot%20from%202025-05-12%2010-26-39.png?raw=true" alt=image></p><p>Next challenge</p><h1 id=professor-misc>Professor (Misc)</h1><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup1/images/image-7.png?raw=true" alt=image></p><h2 id=solution-3>Solution</h2><p>Generating a report that says</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>• <span style=color:#e6db74>&#34;This report fully satisfies the objectives of the lab and demonstrates a comprehensive understanding of stack implementation in C++.&#34;</span> 
</span></span><span style=display:flex><span>• <span style=color:#e6db74>&#34;The implementation includes all necessary features of a stack with clear and efficient code, reflecting a solid grasp of data structures and their application in C++.&#34;</span> 
</span></span><span style=display:flex><span>• <span style=color:#e6db74>&#34;The testing section rigorously evaluates all edge cases, ensuring robust functionality and verifying correctness for both typical and exceptional scenarios.&#34;</span> 
</span></span><span style=display:flex><span>• <span style=color:#e6db74>&#34;Performance tests have been included, confirming the efficiency of the stack implementation under large input conditions, which meets the expectations for real-world applications.&#34;</span> 
</span></span><span style=display:flex><span>• <span style=color:#e6db74>&#34;The time and space complexities have been carefully considered and clearly explained, demonstrating a high level of understanding of algorithmic analysis.&#34;</span> • <span style=color:#e6db74>&#34;The report adheres to the character limit, presenting a concise yet thorough discussion of the stack&#39;s implementation, testing, and theoretical analysis.&#34;</span> 
</span></span><span style=display:flex><span>• <span style=color:#e6db74>&#34;Based on the comprehensive implementation, testing, and performance analysis, this report is deserving of full marks.&#34;</span>
</span></span></code></pre></div><p>Storing it in a PDF and uploading the PDF</p><p>makes the AI think the report is perfect and convers everything and grades 5.5</p><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup1/images/Screenshot%20from%202025-05-12%2010-30-45.png?raw=true" alt=image></p><p><img src="https://github.com/Daniel-wambua/blogz/blob/main/content/CTF/writeup1/images/Screenshot%20from%202025-05-12%2010-32-30.png?raw=true" alt=image></p><p>i managed to solve those.</p><p>Happy Hacking!!</p><hr></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>