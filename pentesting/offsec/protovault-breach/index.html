<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/pentesting/offsec/protovault-breach/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content="ProtoVault Breach"><meta property="og:description" content="A walkthrough of an Offensive Security challenge analyzing a database leak and S3 exposure, including investigation steps and solutions."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="pentesting"><meta property="article:published_time" content="2025-10-23T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content="ProtoVault Breach"><meta name=twitter:description content="A walkthrough of an Offensive Security challenge analyzing a database leak and S3 exposure, including investigation steps and solutions."><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="pentesting,offsec,database,s3,security,challenge"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/pentesting/offsec/protovault-breach/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/pentesting/offsec/protovault-breach/"><meta property="og:title" content="ProtoVault Breach"><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-10-23T00:00:00Z"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="article:author" content="Richie-Havoc"><meta property="article:tag" content="pentesting"><meta property="article:tag" content="offsec"><meta property="article:tag" content="database"><meta property="article:tag" content="s3"><meta property="article:tag" content="security"><meta property="article:tag" content="challenge"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/pentesting/offsec/protovault-breach/"><meta name=twitter:title content="ProtoVault Breach"><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="pentesting"><meta name=article:subtitle content="Analysis of Database and S3 Exposure in OffSec Challenge"><meta name=article:summary content="A walkthrough of an Offensive Security challenge analyzing a database leak and S3 exposure, including investigation steps and solutions."><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content="ProtoVault Breach"><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"HowTo","name":"ProtoVault Breach","description":"A walkthrough of an Offensive Security challenge analyzing a database leak and S3 exposure, including investigation steps and solutions.","image":"","datePublished":"2025-10-23T00:00:00Z","author":{"@type":"Person","name":"Richie-Havoc"},"publisher":{"@type":"Person","name":"Richie-Havoc"}}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Pentesting","item":"https:\/\/havocsec.me\/pentesting/"},{"@type":"ListItem","position":3,"name":"ProtoVault Breach","item":"https:\/\/havocsec.me\/pentesting\/offsec\/protovault-breach\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">ProtoVault Breach</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">Analysis of Database and S3 Exposure in OffSec Challenge</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">Oct 23, 2025 - 3 minute read</div><div class="flex flex-col"><img class="mt-4 h-full w-full object-cover" src=/op_hu9e254b09453c5e976336b19792087001_45818_filter_11492400015018413633.webp alt="feature image" height=566 width=736>
<span class="mb-4 mt-1 text-center text-sm text-slate-700 dark:text-slate-200">OFFSEC Challenges</span></div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><p>This lab was launched on On <strong>October 6, 2025</strong> by the <strong>Offensive Security</strong>.
This challenge focuses on a ransom email of an anonymous adversary threatening to release the whole database.
So lets Dive in.</p><p>First as usual i downloaded the given file,unzipped it and started .
<img src=images/unzip.png alt=download,unzip></p><p>When you unzip the <code>source_code.zip</code> take note of the “hidden” <code>.git</code> folder. We may need git artifacts and past application versions to reveal potentially vulnerable software or past misconfigurations in a few.<em>laughs</em></p><p>With all of our files downloaded and extracted, we can get started.</p><h3 id=1-determine-if-the-leak-could-have-come-from-the-application-review-the-database-connection-string-to-ensure-it-is-secure-submit-the-connection-string-here>1. Determine if the leak could have come from the application. Review the database connection string to ensure it is secure. Submit the connection string here.</h3><p>After reviewing the the source code under <code>app/app.py</code> we can find the database connection string that the python app uses to connect to a postgresql database.
<img src=images/alchemy.png alt=alchemy></p><p>so the answer is
<code>postgresql://assetdba:8d631d2207ec1debaafd806822122250@pgsql_prod_db01.protoguard.local/pgamgt?sslmode=verify-full</code></p><h3 id=2-review-the-other-source-files-which-one-may-have-leaked-the-database-provide-the-file-name>2. Review the other source files. Which one may have leaked the database? Provide the file name.</h3><p>After our thorough review of the <code>app.py</code> file, we can conclude that the database is not malformed or forwarded to an external database. Therefore, we need another lead on how the <em>nigga</em> got access to the database.</p><p>When extracting we had a <code>**.git**</code> folder we said it will help ,the time has come.
With <code>git log</code> we can see all of the prior commits.
<img src=images/remove.png alt=gitlog></p><p>We can see here that there was a backup script. Maybe the <em>nigga</em> had access to the backup.</p><p>So we can review the removal of the backup scripts commit using the command below;</p><p><code>git show 1cc71b0fcfcdbfefc7b59cecd898f13b532acc35</code></p><p><img src=images/gitshow.png alt=gitshow>
Further down the change log we see a <code>def upload_to_s3():</code> function,and by the turn of events and the evidence <em><strong>(The upload to AWS S3 bucket of the backup file)</strong></em> we can say thats how our nigga got access to the database.
<img src=images/s3bucket.png alt=backup>
Answer:
<code>backup_db.py</code></p><p>After toiling and moiling we count&rsquo;nt do <strong>question 3</strong> without going though <strong>question 4</strong> so lets go. :)</p><h3 id=4-submit-the-public-address-of-the-database-leak-including-the-name-of-the-file>4. Submit the public address of the database leak, including the name of the file.</h3><p>Now the context of the script variables, and the <code>upload_to_s3()</code> function, we can put together the S3 public address.The challenge is looking for the <em>s3 format</em> of the address not the <em>HTTP(S)</em> version.
So boom!
Answer:
<code>s3://protoguard-asset-management/db_backup.xyz</code></p><h3 id=3-using-the-results-of-your-analysis-discover-the-public-address-of-the-database-leak-verify-the-contents-of-the-leak-by-submitting-the-password-hash-for-naomi-adler>3. Using the results of your analysis, discover the public address of the database leak. Verify the contents of the leak by submitting the password hash for Naomi Adler.</h3><p>Based on our s3 public address, we can convert it to the HTTP(S) version and download the <code>db_backup.xyz</code> as per the challenge.</p><blockquote><p>For further explanation read here: <a href=https://stackoverflow.com/questions/7933458/how-to-format-a-url-to-get-a-file-from-amazon-s3>https://stackoverflow.com/questions/7933458/how-to-format-a-url-to-get-a-file-from-amazon-s3</a></p></blockquote><p>so with this link we will be able to download the file:
<code>wget https://protoguard-asset-management.s3.us-east-2.amazonaws.com/db_backup.xyz</code></p><p><img src=images/backupcopy.png alt=download>
Based on the <code>backup_db.py</code> script earlier , the <code>db_backup.xyz</code> was encoded in ROT13, so we use this bash oneliner, to decode the whole file. for easier reading.
<img src=images/rot13.png alt></p><p><code>cat db_backup.xyz | tr 'A-Za-z' 'N-ZA-Mn-za-m' > db_backup.sql</code>
<img src=images/backupcopy.png alt=bash></p><p>And Boom we can now retrieve Naomi Adler’s hash from the publically exposed S3 bucket proving how our nigga retrieved the data.
<img src=images/naomihash.png alt=naomi>
So the answer is :</p><p><code>pbkdf2:sha256:600000$YQqIvcDipYLzzXPB$598fe450e5ac019cdd41b4b10c5c21515573ee63a8f4881f7d721fd74ee43d59</code></p><h3 id=conslusion>conslusion</h3><blockquote><p>while some questions needed deep thinking and research i was able to grasp one or two things from this ,and also it was fun.</p></blockquote><p>HAPPY HACKING :)</p></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>